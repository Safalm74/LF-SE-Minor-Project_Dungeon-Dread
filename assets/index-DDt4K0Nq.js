var ct=Object.defineProperty;var mt=(i,n,e)=>n in i?ct(i,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[n]=e;var p=(i,n,e)=>mt(i,typeof n!="symbol"?n+"":n,e);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))s(h);new MutationObserver(h=>{for(const l of h)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function e(h){const l={};return h.integrity&&(l.integrity=h.integrity),h.referrerPolicy&&(l.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?l.credentials="include":h.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(h){if(h.ep)return;h.ep=!0;const l=e(h);fetch(h.href,l)}})();class t{constructor(n,e){p(this,"x");p(this,"y");this.x=n,this.y=e}distanceBetween(n){return Math.sqrt((this.x-n.x)**2+(this.y-n.y)**2)}angle(n){const e=this.x-n.x,s=this.y-n.y;return Math.atan(s/e)}add(n){return new t(this.x+n.x,this.y+n.y)}pointDifference(n){return new t(this.x-n.x,this.y-n.y)}}const F={width:35,height:44,positionRight:[new t(6,6),new t(6,71),new t(6,124),new t(6,172),new t(6,124),new t(6,71)],positionLeft:[new t(64,6),new t(67,71),new t(64,124),new t(67,172),new t(64,124),new t(67,71)]},yt="/LF-SE-Minor-Project_Dungeon-Dread/assets/amaterasu-BhcJas4O.mp3",d={ingame:!1,aboutScreenFlag:!1,controlScreenFlag:!1,homeScreenFlag:!1,btnPressed:{},wave:5,buyScreenFlag:!1,ismute:!1,firstPageFlag:!1,assetsLoaded:0,loadingScreen:!1};function f(){d.assetsLoaded++}const Ji=new Audio(yt);Ji.onload=f;const S={heroTotalHealth:200,width:F.width*window.innerHeight/600,height:F.height*window.innerHeight/600,velocity:new t(5,5),abilityDamage:.1,abilityRate:10,abilityDurability:10*1e3,maxEssence:50,amaterasuSound:Ji};let ft=[];const Si=50,ut=Math.floor(window.innerWidth*10/Si),St=Math.floor(window.innerHeight*10/Si),Pt="#radial-gradient(#a9c0a6,#000)",w={tileSize:Si,mapWidth:ut,mapHeight:St,mapColor:Pt,mapTileArray:ft,displayPosition:new t(0,0),mapSizeMultiplier:5},vt="/LF-SE-Minor-Project_Dungeon-Dread/assets/homeMusic-CTRQ4BfC.mp3",It="/LF-SE-Minor-Project_Dungeon-Dread/assets/wind-1mG3RRHB.mp3",xt="/LF-SE-Minor-Project_Dungeon-Dread/assets/coinCollect-D0EQSH2R.wav",Qi=new Audio(vt),Pi=new Audio(It),vi=new Audio(xt);Qi.onload=f;Pi.onload=f;vi.onload=f;Pi.volume=.5;vi.volume=.2;const o={collideableObjs:[],heroTotalHealth:120,waveIntervalTime:90*1e3,maxEnemies:100*w.mapSizeMultiplier,mapPosition:new t(0,0),dropdownInterval:null,weaponArray:[null,null,null,null,null,null],homeSound:Qi,windSound:Pi,gemSound:vi},W="/LF-SE-Minor-Project_Dungeon-Dread/assets/background-fPH3rH_v.webp";function B(i,n,e,s="3rem Eater",h="white"){return e||console.log("no position"),i.fillStyle=h,i.font=s,i.fillText(n,e.x,e.y),i.measureText(n)}function kt(i,n,e,s,h="1rem Arial",l="white"){i.font=h,i.fillStyle=l;const c=i.measureText("sample"),y=c.actualBoundingBoxAscent+c.actualBoundingBoxDescent,T=n.split(" ").filter(O=>!(O===`
`||O==="	"||O===" "));let b="",H=s.y+y;const z=s.x+y;for(let O=0;O<T.length;O++){const Q=b+T[O]+" ";i.measureText(Q).width<=e?b=Q:(i.fillText(b,z,H),H+=y,b="")}i.fillText(b,z,H)}const bt="/LF-SE-Minor-Project_Dungeon-Dread/assets/type_3_4_-0Cq7KuU3.png",Tt="/LF-SE-Minor-Project_Dungeon-Dread/assets/type1-CCCx1Bt1.png",Et="/LF-SE-Minor-Project_Dungeon-Dread/assets/type2-BH0ylXV7.png",ni={width:24,height:34,positionLeft:[new t(10,3),new t(118,3),new t(226,3),new t(335,3),new t(443,3),new t(6,114),new t(443,3),new t(335,3),new t(226,3),new t(118,3)],positionRight:[new t(479,2),new t(587,2),new t(696,3),new t(804,5),new t(914,5),new t(482,112),new t(914,5),new t(804,5),new t(696,3),new t(587,2)]},q={width:34,height:30,positionRight:[new t(84,542),new t(121,541),new t(158,542),new t(195,541)],positionLeft:[new t(343,541),new t(308,542),new t(269,541),new t(232,542)]},Ii=new Image,V=new Image,xi=new Image;Ii.src=Tt;V.src=bt;xi.src=Et;Ii.onload=f;V.onload=f;xi.onload=f;const g={type1:{healthPoint:10,width:ni.width*window.innerHeight/700,height:ni.height*window.innerHeight/700,image:Ii,attackRate:.8,damage:2,velocity:new t(1,1)},type2:{healthPoint:20,width:window.innerHeight/1500,height:window.innerHeight/1500,image:xi,attackRate:.01,damage:2,velocity:new t(1,1)},type3:{healthPoint:15,width:q.width*window.innerHeight/700,height:q.height*window.innerHeight/700,image:V,attackRate:3,damage:6,velocity:new t(3,3)},type4:{healthPoint:28,width:window.innerHeight/500,height:window.innerHeight/500,image:V,attackRate:1,damage:3,velocity:new t(1,1)},boss:{healthPoint:1800,width:window.innerHeight/500,height:window.innerHeight/500,image:V,attackRate:1,damage:30,velocity:new t(1,1),velocityFast:new t(4,4)}},C={1:[{width:5,height:5,position:new t(106,614)},{width:5,height:16,position:new t(114,614)},{width:10,height:30,position:new t(122,614)},{width:5,height:32,position:new t(135,614)},{width:10,height:30,position:new t(143,614)},{width:15,height:3,position:new t(160,614)},{width:19,height:5,position:new t(183,614)},{width:21,height:7,position:new t(207,614)},{width:22,height:9,position:new t(232,614)},{width:23,height:11,position:new t(256,614)},{width:24,height:13,position:new t(281,614)},{width:24,height:15,position:new t(306,614)},{width:24,height:16,position:new t(331,614)}]},Dt="/LF-SE-Minor-Project_Dungeon-Dread/assets/Controls-B4QXboM1.png",ki=new Image;ki.src=Dt;ki.onload=f;const bi=new Image;bi.src=W;bi.onload=f;let oi,Ki;function Ot(i,n,e){const s=e.width,h=e.actualBoundingBoxAscent+e.actualBoundingBoxDescent;return i.x>n.x&&i.x<n.x+s&&i.y>n.y-h&&i.y<n.y}function At(i,n){Ot(i,oi,Ki)&&(d.aboutScreenFlag=!1,Bi(n))}function Rt(i){i.drawImage(bi,0,0,a.width,a.height),i.fillStyle="rgba(40,40,40,0.8)",i.drawImage(ki,a.width*.1,a.height*.2,a.width*.5,a.height*.5),i.fillStyle="white",i.font="2rem ShadowOfTheDeadOver",i.fillText("Controls",a.width*.1,a.height*.1),oi=new t(a.width*.1,a.height*.8),Ki=B(i,"<-- return Home",oi,"1rem ShadowOfTheDeadOver")}function Zi(i){i.clearRect(0,0,a.width,a.height),Rt(i),requestAnimationFrame(()=>{Zi(i)})}function Mt(i){d.controlScreenFlag=!0,console.log("in control"),i.translate(-o.mapPosition.x,-o.mapPosition.y),o.mapPosition=new t(0,0),Zi(i)}const Z={width:115,height:62,position:new t(27,18)},Ft="/LF-SE-Minor-Project_Dungeon-Dread/assets/bush-fjx7lCik.png",E={drum:{width:738,height:226,position:new t(590,2280)},stone:{width:1663,height:1487,position:new t(577,773)}},Lt="/LF-SE-Minor-Project_Dungeon-Dread/assets/stoneandDrum-BzVPJaqp.svg",Ti=new Image;Ti.src=Ft;Ti.onload=f;const ii=new Image;ii.src=Lt;ii.onload=f;class j{constructor(n,e,s,h){p(this,"position");p(this,"tileType");p(this,"isObstacle");p(this,"tileSize");this.position=n,this.tileType=e,this.isObstacle=s,this.tileSize=h}draw(n){switch(this.tileType){case"bush":n.drawImage(Ti,Z.position.x,Z.position.y,Z.width,Z.height,this.position.x,this.position.y,this.tileSize,this.tileSize);break;case"empty":break;case"stone":n.drawImage(ii,E.stone.position.x,E.stone.position.y,E.stone.width,E.stone.height,this.position.x,this.position.y,E.stone.width/30,E.stone.height/30);break;case"drum":n.drawImage(ii,E.drum.position.x,E.drum.position.y,E.drum.width,E.drum.height,this.position.x,this.position.y,this.tileSize,this.tileSize);break}}}function I(i,n){const e=Math.ceil(i),s=Math.floor(n);return Math.floor(Math.random()*(s-e+1)+e)}class Ht{constructor(n){p(this,"tileSize");p(this,"mapHeight");p(this,"mapWidth");this.tileSize=n,this.mapHeight=Math.floor(window.innerHeight*w.mapSizeMultiplier/n),this.mapWidth=Math.floor(window.innerWidth*w.mapSizeMultiplier/n),this.initialize(),this.collectCollideableobj()}collectCollideableobj(){w.mapTileArray.forEach(n=>{n.forEach(e=>{e.isObstacle&&o.collideableObjs.push(e)})})}initialize(){for(let n=0;n<this.mapHeight;n++){w.mapTileArray[n]=[];for(let e=0;e<this.mapWidth;e++)if(e===0||n===0||n===this.mapHeight-1||e===this.mapWidth-1)w.mapTileArray[n][e]=new j(new t(e*this.tileSize,n*this.tileSize),"bush",!0,this.tileSize);else{const s=I(1,100);s%2==0&&s<10?s>5?w.mapTileArray[n][e]=new j(new t(e*this.tileSize,n*this.tileSize),"drum",!0,this.tileSize):w.mapTileArray[n][e]=new j(new t(e*this.tileSize,n*this.tileSize),"stone",!0,this.tileSize):w.mapTileArray[n][e]=new j(new t(e*this.tileSize,n*this.tileSize),"empty",!1,this.tileSize)}}}draw(n){w.mapTileArray.forEach(e=>{e.forEach(s=>{s.draw(n)})})}}class J{constructor(n,e,s,h,l,c,y=0,T=0,b=new Image,H=0,z=new t(5,5)){p(this,"position");p(this,"team");p(this,"lookingLeft");p(this,"healthpoint");p(this,"width");p(this,"height");p(this,"spritePosition",0);p(this,"velocity");p(this,"damage");p(this,"attackRate");p(this,"gruntImage");p(this,"gruntType");this.position=n,this.team=e,this.lookingLeft=s,this.healthpoint=h,this.width=l,this.height=c,this.damage=y,this.attackRate=T,this.gruntImage=b,this.gruntType=H,this.velocity=z}}const Ct="/LF-SE-Minor-Project_Dungeon-Dread/assets/hero-CXBE-ivq.png",zt="/LF-SE-Minor-Project_Dungeon-Dread/assets/amaterasu-Bq5RU4UD.png",N={width:339,height:404,position:[new t(6,13),new t(345,13),new t(684,13),new t(1024,13),new t(1365,13),new t(1706,13),new t(2047,13),new t(2388,13)]},ji=new Image;ji.src=zt;const si=new Image;si.src=Ct;class Bt extends J{constructor(){super(...arguments);p(this,"isMoving",!1);p(this,"speedLimit",3);p(this,"weaponOffset",10);p(this,"abilityInterval",null);p(this,"abilityDamage",S.abilityDamage);p(this,"abilityDurability",S.abilityDurability);p(this,"abilityRate",S.abilityRate);p(this,"abilityInUse",!1);p(this,"inRangeEnemies",[]);p(this,"abilityTime",new Date);p(this,"gemCount",0);p(this,"essenceCount",0);p(this,"weaponPositions",[new t(this.position.x+this.weaponOffset+this.width,this.position.y),new t(this.position.x-this.weaponOffset,this.position.y),new t(this.position.x+this.weaponOffset+this.width,this.position.y+this.height/2),new t(this.position.x-this.weaponOffset,this.position.y+this.height/2),new t(this.position.x+this.weaponOffset+this.width,this.position.y),new t(this.position.x+this.weaponOffset+this.width,this.position.y)])}ability(){!this.abilityInUse&&new Date().getTime()-this.abilityTime.getTime()>15*1e3&&this.essenceCount&&(this.abilityTime=new Date,this.abilityInUse=!0,S.amaterasuSound.currentTime=2,S.amaterasuSound.play(),this.inRangeEnemies=v.filter(e=>{if(e.position.x>-o.mapPosition.x&&e.position.x<-o.mapPosition.x+a.width&&e.position.y>-o.mapPosition.y&&e.position.y<-o.mapPosition.y+a.height)return!0}),P&&this.inRangeEnemies.push(P),setTimeout(()=>{this.inRangeEnemies=[],this.abilityInUse=!1},this.abilityDurability*(this.essenceCount/S.maxEssence)),this.essenceCount=0)}reheal(){setInterval(()=>{this.healthpoint<50&&(this.healthpoint+=3)},5e3)}checkCollision(){let e=!1,s=o.collideableObjs[0];return o.collideableObjs.forEach(h=>{h.position.y+h.tileSize>=this.position.y&&h.position.y<=this.position.y+this.height&&h.position.x+h.tileSize>=this.position.x&&h.position.x+h.tileSize<=this.position.x+h.tileSize+this.width&&(e=!0,s=h)}),{collided:e,collidedObj:s}}updateWeaponPosition(){this.weaponPositions=[new t(this.position.x+this.weaponOffset+this.width,this.position.y),new t(this.position.x-this.weaponOffset,this.position.y),new t(this.position.x+this.weaponOffset+this.width,this.position.y+this.height/2),new t(this.position.x-this.weaponOffset,this.position.y+this.height/2),new t(this.position.x+this.weaponOffset+this.width,this.position.y+this.height),new t(this.position.x-this.weaponOffset,this.position.y+this.height)]}moveLeft(e,s){const h=e?this.velocity.x:-1*this.velocity.x;this.lookingLeft=e;const l=this.checkCollision();if(!l.collided)o.mapPosition.x+=h,s.translate(h,0);else{const c=l.collidedObj.position.y<this.position.y?-1:1,y=l.collidedObj.position.x<this.position.x?-1:1;o.mapPosition.x+=y,o.mapPosition.y+=c,s.translate(y,c)}this.updateWeaponPosition()}moveUp(e,s){const h=e?this.velocity.y:-1*this.velocity.y,l=this.checkCollision();if(!l.collided)o.mapPosition.y+=h,s.translate(0,h);else{const c=l.collidedObj.position.y<this.position.y?-1:1,y=l.collidedObj.position.x<this.position.x?-1:1;o.mapPosition.x+=y,o.mapPosition.y+=c,s.translate(y,c)}this.updateWeaponPosition()}draw(e){this.position.x=a.width/2-o.mapPosition.x,this.position.y=a.height/2-o.mapPosition.y,this.inRangeEnemies.forEach(h=>{let l=Math.floor(this.spritePosition/5)%N.position.length;e.drawImage(ji,N.position[l].x,N.position[l].y,N.width,N.height,h.position.x,h.position.y,h.width,h.height),h.healthpoint-=this.abilityDamage});const s=this.lookingLeft?F.positionLeft:F.positionRight;if(this.isMoving){let l=Math.floor(this.spritePosition/5)%s.length;e.drawImage(si,s[l].x,s[l].y,F.width,F.height,this.position.x,this.position.y,this.width,this.height)}else e.drawImage(si,s[0].x,s[0].y,F.width,F.height,this.position.x,this.position.y,this.width,this.height);this.healthpoint<0,this.spritePosition++}}const Ei="/LF-SE-Minor-Project_Dungeon-Dread/assets/spwan-6_Ug9n4C.png",k={width:31,height:17,position:[new t(76,17),new t(224,17),new t(410,17),new t(576,17),new t(742,17),new t(76,118),new t(224,118),new t(410,118),new t(576,118),new t(742,118),new t(48,217)]},Di=new Image;Di.src=Ei;Di.onload=f;class Ni extends J{constructor(){super(...arguments);p(this,"isSpwaned",!1);p(this,"attackInterval",null)}checkCollision(){let e=!1,s=!1,h=o.collideableObjs[0];return o.collideableObjs.forEach(l=>{l.position.y+l.tileSize>=this.position.y&&l.position.y<=this.position.y+this.height&&l.position.x+l.tileSize>=this.position.x&&l.position.x+l.tileSize<=this.position.x+l.tileSize+this.width&&(e=!0,h=l)}),r.position.y+r.height/2>=this.position.y&&r.position.y<=this.position.y+this.height&&r.position.x+r.width>=this.position.x&&r.position.x+r.width<=this.position.x+r.width+this.width?(s=!0,h=r,this.attackInterval||(this.attackInterval=setInterval(()=>{r.healthpoint>0&&(r.healthpoint-=this.damage)},1e3/this.attackRate))):(clearInterval(this.attackInterval),this.attackInterval=null),{collided:e,collidedObj:h,collidedHero:s}}update(){const e=this.checkCollision();this.lookingLeft=this.position.x>r.position.x;const s=Math.sqrt((this.position.x-r.position.x)**2+(this.position.y-r.position.y)**2);s>50&&(clearInterval(this.attackInterval),this.attackInterval=null);const h=new t((this.position.x-r.position.x)/s,(this.position.y-r.position.y)/s),l=Math.sqrt(this.velocity.x*this.velocity.x+this.velocity.y*this.velocity.y),c=new t(-h.x*l,-h.y*l);if(!e.collidedHero&&!e.collided&&(this.position.x+=c.x,this.position.y+=c.y),e.collided){const y=e.collidedObj.position.x<this.position.x?1:-1,T=e.collidedObj.position.y<this.position.y?1:-1;this.position.x+=y,this.position.y+=T}}draw(e){let s;switch(this.gruntType){case 1:s=ni;break;case 3:s=q;break}const h=this.lookingLeft?s.positionLeft:s.positionRight;this.update();let c=Math.floor(this.spritePosition/5)%s.positionLeft.length;e.drawImage(this.gruntImage,h[c].x,h[c].y,q.width,q.height,this.position.x,this.position.y,this.width,this.height),this.spritePosition++}spwan(e){let h=Math.floor(this.spritePosition/10)%10;e.drawImage(Di,k.position[h].x,k.position[h].y,k.width,k.height,this.position.x,this.position.y,this.width,this.height),this.spritePosition++,h>=9&&(this.isSpwaned=!0,this.spritePosition=0)}}const $t="/LF-SE-Minor-Project_Dungeon-Dread/assets/map-BCq2fiXg.png";function U(i,n,e,s,h,l,c=""){i.font="2rem ShadowOfTheDead",i.fillStyle="#4caf50",i.fillText(c,n.x,n.y-l/5);const y=Math.floor(e/s*h);i.strokeRect(n.x,n.y,h,l),i.fillStyle="rgba(200,200,200,0.5)",i.fillRect(n.x,n.y,h,l),i.fillStyle="rgba(76, 175, 80,0.5)",i.fillRect(n.x,n.y,y,l)}function _(i,n,e=new t(-(i.measureText(n).width/2+o.mapPosition.x),a.height/2-o.mapPosition.y),s="5rem ShadowOfTheDeadOver",h="#4caf50"){i.font=s,i.fillStyle=h,i.translate(e.x,e.y),i.fillText(n,a.width/2,0),i.translate(-e.x,-e.y)}class Gt{constructor(n,e,s,h,l,c=1,y=500,T,b){p(this,"position");p(this,"lookingLeft");p(this,"damage");p(this,"width");p(this,"height");p(this,"spritePosition",0);p(this,"fireRate");p(this,"cost");p(this,"gunImage");p(this,"guntype");this.position=n,this.lookingLeft=e,this.damage=s,this.width=h,this.height=l,this.gunImage=T,this.fireRate=c,this.cost=y,this.guntype=b}}const x={width:66,height:38,positionRight:[new t(5,31),new t(67,40),new t(19,46)],positionLeft:[new t(90,31),new t(94,40),new t(143,46)]},L={bulletSize:2,bulletVelocity:20,pestol:300,pestolFireRate:1,pestolDamage:5};class Nt{constructor(n,e,s,h,l){p(this,"startPoint");p(this,"endPoint");p(this,"damage");p(this,"isHit",!1);p(this,"velocity");p(this,"gunPosition");this.startPoint=n,this.endPoint=e,this.damage=s,this.velocity=h,this.gunPosition=l}checkOnhit(n,e=null){n.forEach(s=>{this.endPoint.x>s.position.x&&this.endPoint.x<s.position.x+s.width&&this.endPoint.y>s.position.y&&this.endPoint.y<s.position.y+s.height&&(this.isHit=!0,s.healthpoint-=this.damage)}),e&&this.endPoint.x>e.position.x&&this.endPoint.x<e.position.x+e.width&&this.endPoint.y>e.position.y&&this.endPoint.y<e.position.y+e.height&&(this.isHit=!0,e.healthpoint-=this.damage)}draw(n){this.startPoint=this.startPoint.add(this.velocity),this.endPoint=this.endPoint.add(this.velocity),n.beginPath(),n.strokeStyle="gold",n.moveTo(this.startPoint.x,this.startPoint.y),n.lineTo(this.endPoint.x,this.endPoint.y),n.lineWidth=2,n.stroke()}}const $={width:66,height:38,positionLeft:[new t(5,31),new t(67,40),new t(19,46)],positionRight:[new t(90,31),new t(94,40),new t(143,46)]},it="/LF-SE-Minor-Project_Dungeon-Dread/assets/gun-CYm9DPhZ.mp3";class ai extends Gt{constructor(){super(...arguments);p(this,"detectedEnemy",!1);p(this,"trackingEnemyObj",null);p(this,"lookingAngle",0);p(this,"shootingPoint",x.positionRight[1]);p(this,"fireInterval",null);p(this,"level",1);p(this,"sound",new Audio(it))}playSound(){d.ismute||(this.sound.volume=.2,this.sound&&(this.sound.pause(),this.sound.currentTime=0),this.sound.play())}detectEnemy(e){const s=this.position;s.distanceBetween(e.position)<L.pestol&&!this.detectedEnemy&&(this.detectedEnemy=!0,this.trackingEnemyObj=e),this.detectedEnemy&&this.trackingEnemyObj&&(this.lookingAngle=s.angle(new t(this.trackingEnemyObj.position.x,this.trackingEnemyObj.position.y)),this.shoot(),this.position.distanceBetween(this.trackingEnemyObj.position)>L.pestol&&(this.detectedEnemy=!1,clearInterval(this.fireInterval),this.fireInterval=null)),this.trackingEnemyObj&&this.trackingEnemyObj.healthpoint<0&&(this.detectedEnemy=!1,clearInterval(this.fireInterval),this.fireInterval=null)}shoot(){this.lookingLeft?this.shootingPoint=new t(this.position.x,this.position.y+this.height/4):this.shootingPoint=new t(this.position.x+this.width,this.position.y+this.height/4),this.trackingEnemyObj&&this.position.x>this.trackingEnemyObj.position.x&&(this.shootingPoint.x=this.position.x),this.shootingPoint.x=this.position.x+(this.shootingPoint.x-this.position.x)*Math.cos(this.lookingAngle)-(this.shootingPoint.y-this.position.y)*Math.sin(this.lookingAngle),this.shootingPoint.y=this.position.y+(this.shootingPoint.x-this.position.x)*Math.sin(this.lookingAngle)+(this.shootingPoint.y-this.position.y)*Math.cos(this.lookingAngle),this.fireInterval||(this.fireInterval=setInterval(()=>{if(this.trackingEnemyObj){const e=new t(this.trackingEnemyObj.position.x+this.trackingEnemyObj.width/2,this.trackingEnemyObj.position.y+this.trackingEnemyObj.height/2),s=this.shootingPoint.pointDifference(e),h=this.shootingPoint.distanceBetween(e),l=new t(s.x/h,s.y/h),c=new t(this.shootingPoint.x+l.x*10,this.shootingPoint.y+l.y*10),y=new Nt(this.shootingPoint,c,this.damage,new t(-l.x*L.bulletVelocity,-l.y*L.bulletVelocity),this.position);X.push(y),this.playSound()}},1e3/this.fireRate))}draw(e){let s;switch(this.guntype){case"pistol":s=x;break;case"smg":s=$;break}e.translate(this.position.x,this.position.y),e.rotate(this.lookingAngle);let h;this.lookingLeft?(h=s.positionLeft[0],this.shootingPoint=new t(0,this.height/4)):(h=s.positionRight[0],this.shootingPoint=new t(this.width,this.height/4)),this.trackingEnemyObj&&this.position.x>this.trackingEnemyObj.position.x&&(h=h===x.positionLeft[0]?x.positionRight[0]:x.positionLeft[0],this.shootingPoint.x=0),e.fillStyle="red",e.drawImage(this.gunImage,h.x,h.y,x.width,x.height,0,0,this.width,this.height),e.rotate(-this.lookingAngle),e.translate(-this.position.x,-this.position.y)}}function _t(i){i.strokeStyle="white",i.fillStyle="rgba(40,200,40,0.1)",i.fillRect(-o.mapPosition.x+a.width*.2,-o.mapPosition.y+a.height*.8,a.width*.6,a.width*.08),i.strokeRect(-o.mapPosition.x+a.width*.2,-o.mapPosition.y+a.height*.8,a.width*.6,a.width*.08),i.fillStyle="rgba(200,200,200,0.8)";for(let e=0;e<6;e++)if(i.fillRect(-o.mapPosition.x+a.width*(.2+.1*e+.025),-o.mapPosition.y+a.height*(.8+.03),a.width*.05,a.width*.05),o.weaponArray[e]){switch(o.weaponArray[e].level){case 1:i.fillStyle="rgba(200,200,200,0.8)";break;case 2:i.fillStyle="rgba(15,10,222,0.8)";break;case 3:i.fillStyle="rgba(255,215,0,0.8)";break}i.drawImage(o.weaponArray[e].gunImage,-o.mapPosition.x+a.width*(.2+.1*e+.025),-o.mapPosition.y+a.height*(.8+.03),a.width*.05,a.width*.05)}}const qt="/LF-SE-Minor-Project_Dungeon-Dread/assets/pestol-2UG2JAP-.svg",Vt="/LF-SE-Minor-Project_Dungeon-Dread/assets/smg-9gzp5Pqq.svg",Oi=new Audio(it),Ai=new Image;Ai.src=qt;const Ri=new Image;Ri.src=Vt;Oi.onload=()=>{d.assetsLoaded++};Ai.onload=f;Ri.onload=f;Oi.onload=f;const m={pistol:{damage:3,width:x.width*S.width*.01,height:x.height*S.width*.01,image:Ai,fireRate:2,cost:500},smg:{damage:1,width:$.width*S.width*.01,height:$.height*S.width*.01,image:Ri,fireRate:4,cost:1500},sound:Oi};let tt;const _i=5*1e3;let u=0;function qi(){return new Date().getTime()-tt.getTime()}function Vi(i,n,e){const s=e.x,h=e.y;return i=new t(i.x-o.mapPosition.x,i.y-o.mapPosition.y),i.x>n.x&&i.x<n.x+s&&i.y>n.y&&i.y<n.y+h}let Ut=i=>{for(let h=0;h<6;h++)if(Vi(i,new t(-o.mapPosition.x+a.width*(.2+.1*h+.025),-o.mapPosition.y+a.height*.8300000000000001),new t(a.width*.05,a.width*.05))){u=h;break}const n=a.width*.8-o.mapPosition.x,e=a.height*.5-o.mapPosition.y,s=new t(a.width*.1-o.mapPosition.x,a.height*.1-o.mapPosition.y);for(let h=0;h<4;h++)if(Vi(i,new t(s.x+n*h/4,s.y),new t(n/4,e))){switch(h){case 0:r.gemCount>=m.pistol.cost&&(o.weaponArray[u]=new ai(r.weaponPositions[u],!1,m.pistol.damage,m.pistol.width,m.pistol.height,m.pistol.fireRate,m.pistol.cost,m.pistol.image,"pistol"),r.gemCount-=m.pistol.cost);break;case 1:r.gemCount>=m.smg.cost&&(o.weaponArray[u]=new ai(r.weaponPositions[u],!1,m.smg.damage,m.smg.width,m.smg.height,m.smg.fireRate,m.smg.cost,m.smg.image,"smg"),r.gemCount-=m.smg.cost);break}for(let c=0;c<o.weaponArray.length&&(u=c,!!o.weaponArray[c]);c++);break}};function Xt(){o.weaponArray[u]&&o.weaponArray[u].level<3&&r.gemCount>=o.weaponArray[u].cost*1.1&&(o.weaponArray[u].damage+=o.weaponArray[u].damage*.1,o.weaponArray[u].fireRate+=o.weaponArray[u].fireRate*.1,o.weaponArray[u].level++,r.gemCount-=o.weaponArray[u].cost*.1)}function Ui(i,n,e,s,h,l,c,y,T,b,H,z,O,Q){i.strokeRect(e.x+s*n/4,e.y,s/4,h),i.fillRect(e.x+s*n/4+s/8-l/2,e.y*1.3,l,l),i.drawImage(c,y.x,y.y,T,b,e.x+s*n/4+s/8-l/2,e.y*1.3,l,l),i.font="2rem Eater",i.fillStyle="white";const ti=i.measureText("sample"),K=ti.actualBoundingBoxAscent+ti.actualBoundingBoxDescent;i.fillText(`Gun: ${H}`,e.x+s*n/4+l/2,e.y*1.3+l+K*4),i.fillText(`Cost: ${z}`,e.x+s*n/4+l/2,e.y*1.3+l+K*5.5),i.fillText(`Damage: ${O}`,e.x+s*n/4+l/2,e.y*1.3+l+K*7),i.fillText(`Fire Rate: ${Q}`,e.x+s*n/4+l/2,e.y*1.3+l+K*8.5)}function et(i){const n=a.width*.8-o.mapPosition.x,e=a.height*.5-o.mapPosition.y,s=new t(a.width*.1-o.mapPosition.x,a.height*.1-o.mapPosition.y),h=a.width*.05;i==null||i.clearRect(-o.mapPosition.x,-o.mapPosition.y,a.width,a.height),i.fillStyle="rgba(10,10,40,0.5)",i.fillRect(s.x,s.y,n,e),i.font="3rem ShadowOfTheDeadOver",i.fillStyle="#4caf50",i.fillText("Buy Menu: ",a.width*.1-o.mapPosition.x,a.height*.1-o.mapPosition.y),i.font="2rem Eater",i.fillStyle="#4caf50",i.fillText(`Gems Count: ${r.gemCount}`,a.width*.8-o.mapPosition.x,a.height*.1-o.mapPosition.y),i.fillStyle="rgba(200,200,200,0.8)",i.strokeStyle="green",Ui(i,0,s,n,e,h,m.pistol.image,x.positionRight[0],x.width,x.height,"Pistol",m.pistol.cost,m.pistol.damage,m.pistol.fireRate),Ui(i,1,s,n,e,h,m.smg.image,$.positionRight[0],$.width,$.height,"SMG",m.smg.cost,m.smg.damage,m.smg.fireRate),_t(i),i.strokeStyle="gold",i.strokeRect(-o.mapPosition.x+a.width*(.2+.1*u+.025),-o.mapPosition.y+a.height*(.8+.03),a.width*.05,a.width*.05),U(i,new t(a.width*.1-o.mapPosition.x,a.height*.7-o.mapPosition.y),qi(),_i,a.width*.8,a.height*.01,"Buy Time:"),qi()>=_i&&(o.weaponArray.forEach((l,c)=>{l&&(l.position=r.weaponPositions[c])}),d.buyScreenFlag=!1,ht(i)),d.ingame||requestAnimationFrame(()=>{et(i)})}function Yt(i){i.translate(-o.mapPosition.x,-o.mapPosition.y),o.mapPosition=new t(0,0),d.ingame=!1,d.buyScreenFlag=!0,tt=new Date,u=0;for(let n=0;n<o.weaponArray.length&&(u=n,!!o.weaponArray[n]);n++);et(i)}const D={width:45,height:55,positionRight:[new t(93,226),new t(142,230),new t(189,235),new t(229,231)],positionLeft:[new t(278,235),new t(326,231),new t(372,225),new t(414,230)],attackLeft:[{width:34,height:58,position:new t(173,283)},{width:64,height:41,position:new t(208,300)},{width:53,height:42,position:new t(273,305)}],attackRight:[{width:33,height:58,position:new t(20,283)},{width:64,height:41,position:new t(54,300)},{width:53,height:41,position:new t(119,306)}]},Mi=new Image;Mi.src=Ei;Mi.onload=f;class Wt extends J{constructor(){super(...arguments);p(this,"isSpwaned",!1);p(this,"attackInterval",null);p(this,"isAttacking",!1)}checkCollision(){let e=!1,s=!1,h=o.collideableObjs[0];return o.collideableObjs.forEach(l=>{l.position.y+l.tileSize>=this.position.y&&l.position.y<=this.position.y+this.height&&l.position.x+l.tileSize>=this.position.x&&l.position.x+l.tileSize<=this.position.x+l.tileSize+this.width&&(e=!0,h=l)}),r.position.y+r.height/2>=this.position.y&&r.position.y<=this.position.y+this.height&&r.position.x+r.width>=this.position.x&&r.position.x+r.width<=this.position.x+r.width+this.width&&(s=!0,h=r),{collided:e,collidedObj:h,collidedHero:s}}update(){const e=this.checkCollision();this.lookingLeft=this.position.x>r.position.x;const s=Math.sqrt((this.position.x-r.position.x)**2+(this.position.y-r.position.y)**2);s>50&&(clearInterval(this.attackInterval),this.attackInterval=null);const h=new t((this.position.x-r.position.x)/s,(this.position.y-r.position.y)/s),l=Math.sqrt(2);if(this.velocity=new t(-h.x*l,-h.y*l),e.collidedHero?this.isAttacking=!0:(this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.isAttacking=!1),!e.collided)this.position.x+=this.velocity.x,this.position.y+=this.velocity.y;else{const c=e.collidedObj.position.x<this.position.x?1:-1,y=e.collidedObj.position.y<this.position.y?1:-1;this.position.x+=c,this.position.y+=y}}draw(e){if(this.update(),this.isAttacking){const s=this.lookingLeft?D.attackLeft:D.attackRight,l=Math.floor(this.spritePosition/10)%D.attackLeft.length;this.height=s[l].height,this.width=s[l].width,l==2&&(r.healthpoint-=this.damage),e.drawImage(g.type3.image,s[l].position.x,s[l].position.y,s[l].width,s[l].height,this.position.x,this.position.y,this.width,this.height)}else{const s=this.lookingLeft?D.positionLeft:D.positionRight,l=Math.floor(this.spritePosition/8)%D.positionLeft.length;this.width=D.width,this.height=D.height,e.drawImage(g.type3.image,s[l].x,s[l].y,D.width,D.height,this.position.x,this.position.y,this.width,this.height)}this.spritePosition++}spwan(e){const h=Math.floor(this.spritePosition/10)%10;e.drawImage(Mi,k.position[h].x,k.position[h].y,k.width,k.height,this.position.x,this.position.y,this.width,this.height),this.spritePosition++,h>=9&&(this.isSpwaned=!0,this.spritePosition=0)}}const Jt={position:[{width:137,height:79,position:new t(12,28)},{width:144,height:78,position:new t(168,28)},{width:147,height:77,position:new t(326,29)},{width:144,height:76,position:new t(488,28)},{width:127,height:80,position:new t(659,27)},{width:111,height:83,position:new t(27,168)},{width:127,height:80,position:new t(179,167)}]};class nt{constructor(n,e,s,h){p(this,"position");p(this,"damage");p(this,"isHit",!1);p(this,"velocity");p(this,"gunPosition");p(this,"radius",window.innerWidth/100);this.position=n,this.damage=e,this.velocity=s,this.gunPosition=h}checkOnhit(){this.position.x-this.radius>r.position.x&&this.position.x+this.radius<r.position.x+r.width&&this.position.y-this.radius>r.position.y&&this.position.y+this.radius<r.position.y+r.height&&(this.isHit=!0,r.healthpoint-=this.damage)}update(){this.position.x+=this.velocity.x,this.position.y+=this.velocity.y}draw(n){this.update(),n.beginPath(),n.fillStyle="green",n.arc(this.position.x,this.position.y,this.radius,0,Math.PI*2),n.fill()}}const Fi=new Image;Fi.src=Ei;Fi.onload=f;class Qt extends J{constructor(){super(...arguments);p(this,"isSpwaned",!1);p(this,"attackInterval",null);p(this,"attackRadius",400)}update(){const e=Math.sqrt((this.position.x-r.position.x)**2+(this.position.y-r.position.y)**2),s=new t((this.position.x-r.position.x)/e,(this.position.y-r.position.y)/e),h=Math.sqrt(this.velocity.x*this.velocity.x+this.velocity.y*this.velocity.y),l=new t(-s.x*h,-s.y*h);e>2e3?(clearInterval(this.attackInterval),this.attackInterval=null,this.position.x+=l.x,this.position.y+=l.y):this.spitHero()}spitHero(){this.attackInterval||(this.attackInterval=setInterval(()=>{if(r){const e=new t(r.position.x,r.position.y),s=this.position.pointDifference(e),h=this.position.distanceBetween(e),l=new t(s.x/h,s.y/h),c=new nt(new t(this.position.x+this.width/2,this.position.y+this.width/2),this.damage,new t(-l.x*L.bulletVelocity*.3,-l.y*L.bulletVelocity*.3),this.position);G.push(c)}},1e3/this.attackRate))}draw(e){const s=Jt;this.update();let l=Math.floor(this.spritePosition/5)%s.position.length;this.width=s.position[l].width,this.height=s.position[l].height,e.drawImage(this.gruntImage,s.position[l].position.x,s.position[l].position.y,s.position[l].width,s.position[l].height,this.position.x,this.position.y,s.position[l].width*g.type2.width,s.position[l].height*g.type2.height),this.spritePosition++}spwan(e){let h=Math.floor(this.spritePosition/10)%10;e.drawImage(Fi,k.position[h].x,k.position[h].y,k.width,k.height,this.position.x,this.position.y,this.width,this.height),this.spritePosition++,h>=9&&(this.isSpwaned=!0,this.spritePosition=0)}}const Kt="/LF-SE-Minor-Project_Dungeon-Dread/assets/gem-CYeD5NUz.png",A={1:[{width:80,height:80,position:new t(91,7)},{width:77,height:80,position:new t(172,7)},{width:57,height:80,position:new t(262,7)},{width:40,height:80,position:new t(351,7)},{width:57,height:80,position:new t(422,7)},{width:77,height:80,position:new t(492,7)}]},Li=new Image;Li.src=Kt;Li.onload=f;class Zt{constructor(n,e,s,h){p(this,"position");p(this,"value");p(this,"spritePostion",0);p(this,"width");p(this,"height");this.position=n,this.value=e,this.width=s,this.height=h}draw(n){const s=Math.floor(this.spritePostion/5)%A[1].length;n.drawImage(Li,A[1][s].position.x,A[1][s].position.y,A[1][s].width,A[1][s].height,this.position.x,this.position.y,A[1][s].width*.3,A[1][s].height*.3),this.spritePostion++}collected(){return r.position.y+r.height+20>=this.position.y&&r.position.y-20<=this.position.y+this.height&&r.position.x+r.width+20>=this.position.x&&r.position.x-20<=this.position.x+this.width?(d.ismute||(o.gemSound&&(o.gemSound.pause(),o.gemSound.currentTime=0),o.gemSound.play()),r.gemCount+=this.value,r.essenceCount<S.maxEssence&&(r.essenceCount+=1),!1):!0}}const M={width:226,height:148,position:[new t(1,21),new t(234,21),new t(456,21),new t(700,21),new t(936,21),new t(1169,21),new t(1396,21),new t(1622,21),new t(1850,21),new t(2077,21),new t(2304,21),new t(2531,21),new t(2758,21),new t(2985,21),new t(3212,21),new t(3439,21),new t(3665,21),new t(3892,21),new t(4119,21),new t(4346,21),new t(4572,21),new t(4800,21),new t(5027,21),new t(5253,21),new t(5481,21),new t(5708,21),new t(5936,21),new t(6163,21),new t(6391,21),new t(6619,21),new t(6846,21),new t(7074,21),new t(7301,21),new t(7529,21),new t(7983,21),new t(8210,21),new t(8437,21),new t(8665,21)]},jt="/LF-SE-Minor-Project_Dungeon-Dread/assets/boss-CV5mu1oo.png",Hi=new Image;Hi.src=jt;Hi.onload=f;class ie extends J{constructor(){super(...arguments);p(this,"speedToggle",!1);p(this,"attackInterval",null);p(this,"spitInterval",null)}changeSpeed(){this.spitTohero(),this.spitInterval=setInterval(()=>{this.velocity=this.speedToggle?g.boss.velocity:g.boss.velocityFast,this.speedToggle=!this.speedToggle},5e3)}checkCollision(){return r.position.y+r.height/2>=this.position.y&&r.position.y<=this.position.y+this.height&&r.position.x+r.width>=this.position.x&&r.position.x+r.width<=this.position.x+r.width+this.width}update(){this.checkCollision()?this.attackInterval||(this.attackInterval=setInterval(()=>{r.healthpoint>0&&(r.healthpoint-=this.damage)},1e3/this.attackRate)):(this.moveTowardsHero(),clearInterval(this.attackInterval),this.attackInterval=null)}spitTohero(){this.attackInterval||(this.spitInterval=setInterval(()=>{if(r){const e=new t(r.position.x,r.position.y),s=this.position.pointDifference(e),h=this.position.distanceBetween(e),l=new t(s.x/h,s.y/h),c=new nt(new t(this.position.x+this.width/2,this.position.y+this.width/2),this.damage,new t(-l.x*L.bulletVelocity*.3,-l.y*L.bulletVelocity*.3),this.position);G.push(c)}},1e3/this.attackRate))}moveTowardsHero(){const e=this.position.pointDifference(r.position),s=this.position.distanceBetween(r.position),h=new t(-(e.x/s)*this.velocity.x,-(e.y/s)*this.velocity.y);this.position.x+=h.x,this.position.y+=h.y}draw(e){this.update();const s=(this.lookingLeft,M.position);let l=Math.floor(this.spritePosition/5)%s.length;this.width=M.width*g.boss.width,this.height=M.height*g.boss.height,e.drawImage(Hi,M.position[l].x,M.position[l].y,M.width,M.height,this.position.x,this.position.y,this.width,this.height),U(e,this.position,this.healthpoint,g.boss.healthPoint,200,5),this.spritePosition++}}const Ci=new Image;Ci.src=$t;Ci.onload=f;let ot,v=[],X=[],Y=[],G=[],r,P,hi;function Xi(){return new Date().getTime()-ot.getTime()}const te=new Ht(w.tileSize);function st(){r=new Bt(new t(window.innerWidth/2,window.innerHeight/2),"blue",!0,o.heroTotalHealth,S.width,S.height),r.reheal()}function ee(){Y=Y.filter(i=>i.collected())}function ne(){v=v.filter(i=>{if(i.healthpoint<0)clearInterval(i.attackInterval),Y.push(new Zt(i.position,16,A[1][0].width*.2,A[1][0].height*.2));else return!0})}function oe(){X=X.filter(i=>(i.checkOnhit(v,P),!(i.endPoint.x>=window.innerHeight*w.mapSizeMultiplier||i.startPoint.x<=0||i.isHit))),G=G.filter(i=>(i.checkOnhit(),!(i.position.x>=window.innerHeight*w.mapSizeMultiplier||i.position.x<=0||i.isHit)))}function se(){hi=setInterval(()=>{if(v.length<o.maxEnemies){const i=I(1,100);d.wave>2&&i<40&&v.push(new Qt(new t(I(w.tileSize+w.displayPosition.x,window.innerWidth*5-w.tileSize),I(w.tileSize+w.displayPosition.y,window.innerHeight*5-w.tileSize*2)),"red",!0,g.type2.healthPoint,g.type2.width,g.type2.height,g.type2.damage,g.type2.attackRate,g.type2.image,2,g.type2.velocity)),d.wave>3&&i<50?v.push(new Wt(new t(I(w.tileSize+w.displayPosition.x,window.innerWidth*5-w.tileSize),I(w.tileSize+w.displayPosition.y,window.innerHeight*5-w.tileSize*2)),"red",!0,g.type4.healthPoint,g.type4.width,g.type4.height,g.type4.damage,g.type4.attackRate,g.type4.image,4,g.type4.velocity)):d.wave>1&&i<60?v.push(new Ni(new t(I(w.tileSize+w.displayPosition.x,window.innerWidth*5-w.tileSize),I(w.tileSize+w.displayPosition.y,window.innerHeight*5-w.tileSize*2)),"red",!0,g.type3.healthPoint,g.type3.width,g.type3.height,g.type3.damage,g.type3.attackRate,g.type3.image,3,g.type3.velocity)):v.push(new Ni(new t(I(w.tileSize+w.displayPosition.x,window.innerWidth*5-w.tileSize),I(w.tileSize+w.displayPosition.y,window.innerHeight*5-w.tileSize*2)),"red",!0,g.type1.healthPoint,g.type1.width,g.type1.height,g.type1.damage,g.type1.attackRate,g.type1.image,1,g.type1.velocity))}},500)}function ae(i){i.strokeStyle="white",i.fillStyle="rgba(40,200,40,0.1)",i.fillRect(-o.mapPosition.x+a.width*.2,-o.mapPosition.y+a.height*.8,a.width*.6,a.width*.08),i.strokeRect(-o.mapPosition.x+a.width*.2,-o.mapPosition.y+a.height*.8,a.width*.6,a.width*.08),i.fillStyle="rgba(200,200,200,0.8)";for(let e=0;e<6;e++)i.fillRect(-o.mapPosition.x+a.width*(.2+.1*e+.025),-o.mapPosition.y+a.height*(.8+.03),a.width*.05,a.width*.05),o.weaponArray[e]&&i.drawImage(o.weaponArray[e].gunImage,-o.mapPosition.x+a.width*(.2+.1*e+.025),-o.mapPosition.y+a.height*(.8+.03),a.width*.05,a.width*.05)}function Yi(){d.ingame=!1,clearInterval(r.abilityInterval),P&&clearInterval(P.attackInterval),o.weaponArray.forEach(i=>{i&&(clearInterval(i.fireInterval),i.detectedEnemy=!1,i.trackingEnemyObj=null)}),o.weaponArray=[],d.wave=1,v.forEach(i=>{i&&clearInterval(i.attackInterval)}),st()}function he(i){i.drawImage(Ci,w.displayPosition.x,w.displayPosition.y,window.innerWidth*w.mapSizeMultiplier,window.innerHeight*w.mapSizeMultiplier),te.draw(i),v.forEach(s=>{s.isSpwaned?s.draw(i):s.spwan(i)}),P&&(P.draw(i),o.maxEnemies=100,o.weaponArray.forEach(s=>{s&&s.detectEnemy(P)}),P.healthpoint<=0&&(li(),Yi(),yi(i))),r.draw(i),o.dropdownInterval&&_(i,`wave : ${d.wave}`);const n=i.createRadialGradient(r.position.x+r.width/2,r.position.y+r.height/2,r.width,r.position.x+r.width/2,r.position.y+r.height/2,1e3);r.healthpoint>30?(n.addColorStop(0,"rgba(10,10,10,0)"),n.addColorStop(1,"rgba(0,0,0,0.99)")):(n.addColorStop(0,"rgba(10,10,10,0)"),n.addColorStop(1,"rgba(200,0,0,0.99)")),i.fillStyle=n,i.fillRect(-o.mapPosition.x,-o.mapPosition.y,a.width,a.height),U(i,new t(a.width*.05-o.mapPosition.x,a.height*.1-o.mapPosition.y),r.healthpoint,o.heroTotalHealth,a.width*.45,a.height*.03,"Life line");const e=`Gems: ${r.gemCount}`;if(_(i,e,new t(-a.width*.4-o.mapPosition.x,a.height/5-o.mapPosition.y),"1rem Eater"),U(i,new t(a.width*.95-a.width*.4-o.mapPosition.x,a.height*.1-o.mapPosition.y),r.essenceCount,S.maxEssence,a.width*.4,a.height*.03,"Essence"),Xi()>=o.waveIntervalTime&&r.healthpoint>0&&!P&&(d.wave++,o.weaponArray.forEach(s=>{clearInterval(s==null?void 0:s.fireInterval)}),Yt(i)),P)_(i,"Final Wave",new t(-(i.measureText("Final Wave").width/2+o.mapPosition.x),a.height/5-o.mapPosition.y),"0.1rem");else{const s=`${Math.floor((o.waveIntervalTime-Xi())/1e3)}`;_(i,`${s}`,new t(-(i.measureText(s).width/2+o.mapPosition.x),a.height/5-o.mapPosition.y),"0.1rem")}r.healthpoint<=0&&(li(),Yi(),yi(i)),X.forEach(s=>{s.draw(i)}),G.forEach(s=>{s.draw(i)}),Y.forEach(s=>{s.draw(i)}),o.weaponArray.forEach((s,h)=>{s&&(s.draw(i),s.position=r.weaponPositions[h])}),o.maxEnemies=500,ae(i)}function at(i){i==null||i.clearRect(-o.mapPosition.x,-o.mapPosition.y,a.width,a.height),Pe(),he(i),ne(),oe(),ee(),v.forEach(n=>{o.weaponArray.forEach(e=>{e&&e.detectEnemy(n)})}),d.ingame&&requestAnimationFrame(()=>{at(i)})}function li(){o.windSound.pause(),o.windSound.currentTime=0,v.forEach(i=>{clearInterval(i.attackInterval)}),P&&(clearInterval(P.attackInterval),clearInterval(P.spitInterval)),r.healthpoint=o.heroTotalHealth,X=[],v=[],G=[],Y=[],clearInterval(hi),hi=null,ot=new Date,o.weaponArray[0]||(o.weaponArray[0]=new ai(r.weaponPositions[0],!1,m.pistol.damage,m.pistol.width,m.pistol.height,m.pistol.fireRate,m.pistol.cost,m.pistol.image,"pistol")),o.weaponArray.forEach((i,n)=>{i&&(clearInterval(i.fireInterval),i.trackingEnemyObj=null,i.detectedEnemy=!1,i.position=r.weaponPositions[n])})}function ht(i){d.ingame=!0,r||st(),li(),se(),o.dropdownInterval=!0,setTimeout(()=>{o.dropdownInterval=!1},5e3),o.dropdownInterval&&_(i,`wave : ${d.wave}`),d.wave>=5&&(P=new ie(new t(I(w.tileSize+w.displayPosition.x,window.innerWidth*5-w.tileSize),I(w.tileSize+w.displayPosition.y,window.innerHeight*5-w.tileSize*2)),"red",!0,g.boss.healthPoint,g.boss.width,g.boss.height,g.boss.damage,g.boss.attackRate,g.boss.image,2,g.boss.velocity),P.changeSpeed()),d.ismute||(o.windSound&&(o.windSound.pause(),o.windSound.currentTime=0),o.windSound.play()),at(i)}const zi=new Image;zi.src=W;zi.onload=f;let ri,pi,di,wi,gi,ci,Wi=0;function ei(i,n,e){i=new t(i.x+o.mapPosition.x,i.y+o.mapPosition.y);const s=e.width,h=e.actualBoundingBoxAscent+e.actualBoundingBoxDescent;return i.x>n.x&&i.x<n.x+s&&i.y>n.y-h&&i.y<n.y}function le(i,n){i=new t(-o.mapPosition.x+i.x,-o.mapPosition.y+i.y),pi&&ei(i,ri,pi)&&(d.homeScreenFlag=!1,o.homeSound.pause(),ht(n)),ci&&ei(i,gi,ci)&&(d.homeScreenFlag=!1,Mt(n)),wi&&ei(i,di,wi)&&(d.homeScreenFlag=!1,yi(n))}function re(i){const n=Math.floor(Wi/8)%C[1].length;i.drawImage(g.type3.image,C[1][n].position.x,C[1][n].position.y,C[1][n].width,C[1][n].height,a.width*.9-24,o.mapPosition.y,C[1][n].width*a.width*.001,C[1][n].height*a.width*.001),Wi++}function pe(i){i.clearRect(-o.mapPosition.x,-o.mapPosition.y,a.width,a.height),i.drawImage(zi,-o.mapPosition.x,-o.mapPosition.y,a.width,a.height),i.fillStyle="rgba(40,40,40,0.1)",i.fillRect(-o.mapPosition.x,-o.mapPosition.y,a.width,a.height),ri=new t(-o.mapPosition.x+a.width*.01,-o.mapPosition.y+a.height*.4),gi=new t(-o.mapPosition.x+a.width*.01,-o.mapPosition.y+a.height*.5),di=new t(-o.mapPosition.x+a.width*.01,-o.mapPosition.y+a.height*.6);const n="DUNGEON DREAD";i.font="3rem ShadowOfTheDeadOver",i.fillStyle="white";const e=i.measureText(n);i.fillText(n,-o.mapPosition.x+a.width*.01,-o.mapPosition.y+a.height*.01+e.actualBoundingBoxAscent+e.actualBoundingBoxDescent),pi=B(i,"PLAY",ri),wi=B(i,"ABOUT",di),ci=B(i,"CONTROLS",gi),re(i)}function lt(i){i.clearRect(0,0,a.width,a.height),pe(i),d.homeScreenFlag&&requestAnimationFrame(()=>{lt(i)})}function Bi(i){d.homeScreenFlag=!0,d.ismute||(o.homeSound&&(o.homeSound.pause(),o.homeSound.currentTime=0),o.homeSound.play()),lt(i)}const $i=new Image;$i.src=W;$i.onload=f;const de=`
    The world in Dungeon Dread has multiple dungeons 
    where zombies/monsters exist. The dungeon boss controls them. 
    Our main character is a zombie/monster hunter. 
    Initially, our character is equipped with 
    a weaker weapon. As he kills zombies and collects 
    rewards, the character can buy weapons at the end 
    of the wave. The boss appears at the final wave. 
    The game's objective is to survive each wave and defeat 
    the boss. Boss is much stronger than a regular monster/zombie. Stronger in the sense 
    of higher damage and higher health. After defeating the boss, 
    the dungeon's remaining monsters/zombies disappear and the dungeon 
    is free of monsters/zombies.`;let mi,rt;function we(i,n,e){const s=e.width,h=e.actualBoundingBoxAscent+e.actualBoundingBoxDescent;return i.x>n.x&&i.x<n.x+s&&i.y>n.y-h&&i.y<n.y}function ge(i,n){we(i,mi,rt)&&(d.aboutScreenFlag=!1,Bi(n))}function ce(i){i.drawImage($i,0,0,a.width,a.height),i.fillStyle="rgba(40,40,40,0.8)",i.fillRect(a.width*.1,a.height*.1,a.width*.8,a.height*.8),i.fillStyle="white",i.font="2rem ShadowOfTheDeadOver",i.fillText("About",a.width*.1,a.height*.1),kt(i,de,a.width*.8,new t(a.width*.1,a.height*.3),"1rem GloriaHallelujah"),mi=new t(a.width*.1,a.height*.8),rt=B(i,"<-- return Home",mi,"1rem ShadowOfTheDeadOver")}function pt(i){i.clearRect(0,0,a.width,a.height),ce(i),requestAnimationFrame(()=>{pt(i)})}function yi(i){d.aboutScreenFlag=!0,i.translate(-o.mapPosition.x,-o.mapPosition.y),o.mapPosition=new t(0,0),pt(i)}const Gi=new Image;Gi.src=W;Gi.onload=f;let fi,ui;function me(i,n,e){i=new t(i.x+o.mapPosition.x,i.y+o.mapPosition.y);const s=e.width,h=e.actualBoundingBoxAscent+e.actualBoundingBoxDescent;return i.x>n.x&&i.x<n.x+s&&i.y>n.y-h&&i.y<n.y}function ye(i,n){i=new t(-o.mapPosition.x+i.x,-o.mapPosition.y+i.y),ui&&me(i,fi,ui)&&(d.firstPageFlag=!1,Bi(n))}function fe(i){i.clearRect(-o.mapPosition.x,-o.mapPosition.y,a.width,a.height),i.drawImage(Gi,-o.mapPosition.x,-o.mapPosition.y,a.width,a.height);const n="DUNGEON DREAD";i.font="3rem ShadowOfTheDeadOver",i.fillStyle="white";const e=i.measureText(n);i.fillText(n,a.width*.5-e.width/2,a.height*.3+e.actualBoundingBoxAscent+e.actualBoundingBoxDescent),i.font="3rem Eater",fi=new t(a.width*.5-i.measureText("ENTER").width/2,-o.mapPosition.y+a.height*.8),ui=B(i,"ENTER",fi)}function dt(i){i.clearRect(0,0,a.width,a.height),fe(i),d.homeScreenFlag&&requestAnimationFrame(()=>{dt(i)})}function ue(i){d.firstPageFlag=!0,o.homeSound&&(o.homeSound.pause(),o.homeSound.currentTime=0),dt(i)}function Se(){d.ismute?(o.windSound.pause(),o.windSound.currentTime=0):(d.homeScreenFlag&&o.homeSound.play(),d.ingame&&o.windSound.play())}function Pe(){d.btnPressed.a&&d.btnPressed.w||d.btnPressed.a&&d.btnPressed.s||d.btnPressed.d&&d.btnPressed.w||d.btnPressed.d&&d.btnPressed.s?(r.velocity.x=.7*S.velocity.x,r.velocity.y=.7*S.velocity.y):(r.velocity.x=S.velocity.x,r.velocity.y=S.velocity.y),d.btnPressed.a&&(r.isMoving=!0,r.moveLeft(!0,R)),d.btnPressed.d&&(r.isMoving=!0,r.moveLeft(!1,R)),d.btnPressed.w&&(r.moveUp(!0,R),r.isMoving=!0),d.btnPressed.s&&(r.moveUp(!1,R),r.isMoving=!0),d.btnPressed[" "]&&r.ability()}function ve(){window.addEventListener("keydown",i=>{d.btnPressed[i.key.toLowerCase()]=!0,d.buyScreenFlag&&d.btnPressed.u&&(console.log("here"),Xt()),i.key.toLowerCase()==="m"&&(d.ismute=!d.ismute,Se())}),window.addEventListener("keyup",i=>{d.btnPressed[i.key.toLowerCase()]=!1,r.isMoving=!1}),window.addEventListener("click",i=>{d.firstPageFlag&&ye(new t(i.offsetX,i.offsetY),R),d.homeScreenFlag&&le(new t(i.offsetX,i.offsetY),R),d.buyScreenFlag&&Ut(new t(i.offsetX,i.offsetY)),d.aboutScreenFlag&&ge(new t(i.offsetX,i.offsetY),R),d.controlScreenFlag&&At(new t(i.offsetX,i.offsetY),R)})}const wt=new Image;wt.src=W;wt.onload=f;function Ie(i){i.clearRect(-o.mapPosition.x,-o.mapPosition.y,a.width,a.height),i.fillStyle="rgba(40,40,240,1)",i.fillRect(-o.mapPosition.x,-o.mapPosition.y,a.width,a.height),i.fillStyle="rgba(40,40,40,0.1)",i.fillRect(-o.mapPosition.x,-o.mapPosition.y,a.width,a.height);const n="DUNGEON DREAD";i.font="3rem ShadowOfTheDeadOver",i.fillStyle="white";const e=i.measureText(n);i.fillText(n,-o.mapPosition.x+a.width*.01,-o.mapPosition.y+a.height*.01+e.actualBoundingBoxAscent+e.actualBoundingBoxDescent),U(i,new t(a.width*.3,a.height*.5),d.assetsLoaded,18,a.width*.4,10,"Loading... "),d.assetsLoaded>=19&&(d.loadingScreen=!1,ue(i))}function gt(i){i.clearRect(0,0,a.width,a.height),Ie(i),d.loadingScreen&&requestAnimationFrame(()=>{gt(i)})}function xe(i){d.loadingScreen=!0,d.ismute||(o.homeSound&&(o.homeSound.pause(),o.homeSound.currentTime=0),o.homeSound.play()),gt(i)}const a=document.getElementById("canvas"),R=a.getContext("2d");ve();a&&(a.width=window.innerWidth,a.height=window.innerHeight,a.style.background="linear-gradient(172.33deg, #30303A -1.75%, #20202E 83.53%, #050519 104.9%)",xe(R));
