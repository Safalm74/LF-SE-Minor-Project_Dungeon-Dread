var Z=Object.defineProperty;var ii=(i,t,e)=>t in i?Z(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var p=(i,t,e)=>ii(i,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const h of s)if(h.type==="childList")for(const w of h.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&n(w)}).observe(document,{childList:!0,subtree:!0});function e(s){const h={};return s.integrity&&(h.integrity=s.integrity),s.referrerPolicy&&(h.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?h.credentials="include":s.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function n(s){if(s.ep)return;s.ep=!0;const h=e(s);fetch(s.href,h)}})();const W="/LF-SE-Minor-Project_Dungeon-Dread/assets/background-fPH3rH_v.webp";class o{constructor(t,e){p(this,"x");p(this,"y");this.x=t,this.y=e}distanceBetween(t){return Math.sqrt((this.x-t.x)**2+(this.y-t.y)**2)}angle(t){const e=this.x-t.x,n=this.y-t.y;return Math.atan(n/e)}add(t){return new o(this.x+t.x,this.y+t.y)}pointDifference(t){return new o(this.x-t.x,this.y-t.y)}}let ti=[];const C=50,ei=Math.floor(window.innerWidth*10/C),oi=Math.floor(window.innerHeight*10/C),ni="#radial-gradient(#a9c0a6,#000)",d={tileSize:C,mapWidth:ei,mapHeight:oi,mapColor:ni,mapTileArray:ti,displayPosition:new o(0,0),mapSizeMultiplier:5},r={collideableObjs:[],heroTotalHealth:120,waveIntervalTime:60*1e3,maxEnemies:1*d.mapSizeMultiplier,mapPosition:new o(0,0),dropdownInterval:null,weaponArray:[]};function R(i,t,e){return i.fillStyle="white",i.font="3rem Eater",i.fillText(t,e.x,e.y),i.measureText(t)}const g={ingame:!1,btnPressed:{},wave:1},x={width:115,height:62,position:new o(27,18)},si="/LF-SE-Minor-Project_Dungeon-Dread/assets/bush-fjx7lCik.png",hi="/LF-SE-Minor-Project_Dungeon-Dread/assets/stonedrum-tRkNoq3q.png",B=new Image;B.src=si;const ai=new Image;ai.src=hi;class S{constructor(t,e,n,s){p(this,"position");p(this,"tileType");p(this,"isObstacle");p(this,"tileSize");this.position=t,this.tileType=e,this.isObstacle=n,this.tileSize=s}draw(t){switch(this.tileType){case"bush":t.drawImage(B,x.position.x,x.position.y,x.width,x.height,this.position.x,this.position.y,this.tileSize,this.tileSize);break}}}function v(i,t){const e=Math.ceil(i),n=Math.floor(t);return Math.floor(Math.random()*(n-e+1)+e)}class li{constructor(t){p(this,"tileSize");p(this,"mapHeight");p(this,"mapWidth");this.tileSize=t,this.mapHeight=Math.floor(window.innerHeight*d.mapSizeMultiplier/t),this.mapWidth=Math.floor(window.innerWidth*d.mapSizeMultiplier/t),this.initialize(),this.collectCollideableobj()}collectCollideableobj(){d.mapTileArray.forEach(t=>{t.forEach(e=>{e.isObstacle&&r.collideableObjs.push(e)})})}initialize(){for(let t=0;t<this.mapHeight;t++){d.mapTileArray[t]=[];for(let e=0;e<this.mapWidth;e++)if(e===0||t===0||t===this.mapHeight-1||e===this.mapWidth-1)d.mapTileArray[t][e]=new S(new o(e*this.tileSize,t*this.tileSize),"bush",!0,this.tileSize);else{const n=v(1,100);n%2==0&&n<10?n>5?d.mapTileArray[t][e]=new S(new o(e*this.tileSize,t*this.tileSize),"drum",!0,this.tileSize):d.mapTileArray[t][e]=new S(new o(e*this.tileSize,t*this.tileSize),"stone",!0,this.tileSize):d.mapTileArray[t][e]=new S(new o(e*this.tileSize,t*this.tileSize),"empty",!1,this.tileSize)}}}draw(t){d.mapTileArray.forEach(e=>{e.forEach(n=>{n.draw(t)})})}}class q{constructor(t,e,n,s,h,w){p(this,"position");p(this,"team");p(this,"lookingLeft");p(this,"healthpoint");p(this,"width");p(this,"height");p(this,"spritePosition",0);p(this,"velocity",new o(5,5));this.position=t,this.team=e,this.lookingLeft=n,this.healthpoint=s,this.width=h,this.height=w}}const ri="/LF-SE-Minor-Project_Dungeon-Dread/assets/hero-CXBE-ivq.png",m={width:35,height:44,positionRight:[new o(6,6),new o(6,71),new o(6,124),new o(6,172),new o(6,124),new o(6,71)],positionLeft:[new o(64,6),new o(67,71),new o(64,124),new o(67,172),new o(64,124),new o(67,71)]},E=new Image;E.src=ri;class pi extends q{constructor(){super(...arguments);p(this,"isMoving",!1);p(this,"speedLimit",3);p(this,"weaponOffset",10);p(this,"weaponPositions",[new o(this.position.x+this.weaponOffset+this.width,this.position.y),new o(this.position.x-this.weaponOffset,this.position.y),new o(this.position.x+this.weaponOffset+this.width,this.position.y+this.height/2),new o(this.position.x-this.weaponOffset,this.position.y+this.height/2),new o(this.position.x+this.weaponOffset+this.width,this.position.y),new o(this.position.x+this.weaponOffset+this.width,this.position.y)])}ability(){console.log("using ability")}checkCollision(){let e=!1,n=r.collideableObjs[0];return r.collideableObjs.forEach(s=>{s.position.y+s.tileSize>=this.position.y&&s.position.y<=this.position.y+this.height&&s.position.x+s.tileSize>=this.position.x&&s.position.x+s.tileSize<=this.position.x+s.tileSize+this.width&&(e=!0,n=s)}),{collided:e,collidedObj:n}}updateWeaponPosition(){this.weaponPositions=[new o(this.position.x+this.weaponOffset+this.width,this.position.y),new o(this.position.x-this.weaponOffset,this.position.y),new o(this.position.x+this.weaponOffset+this.width,this.position.y+this.height/2),new o(this.position.x-this.weaponOffset,this.position.y+this.height/2),new o(this.position.x+this.weaponOffset+this.width,this.position.y+this.height),new o(this.position.x-this.weaponOffset,this.position.y+this.height)]}moveLeft(e,n){const s=e?this.velocity.x:-1*this.velocity.x;this.lookingLeft=e;const h=this.checkCollision();if(!h.collided)r.mapPosition.x+=s,n.translate(s,0);else{const w=h.collidedObj.position.y<this.position.y?-1:1,f=h.collidedObj.position.x<this.position.x?-1:1;r.mapPosition.x+=f,r.mapPosition.y+=w,n.translate(f,w)}this.updateWeaponPosition()}moveUp(e,n){const s=e?this.velocity.y:-1*this.velocity.y,h=this.checkCollision();if(!h.collided)r.mapPosition.y+=s,n.translate(0,s);else{const w=h.collidedObj.position.y<this.position.y?-1:1,f=h.collidedObj.position.x<this.position.x?-1:1;r.mapPosition.x+=f,r.mapPosition.y+=w,n.translate(f,w)}this.updateWeaponPosition()}draw(e){this.position.x=a.width/2-r.mapPosition.x,this.position.y=a.height/2-r.mapPosition.y;const n=this.lookingLeft?m.positionLeft:m.positionRight;if(this.isMoving){let h=Math.floor(this.spritePosition/5)%6;e.drawImage(E,n[h].x,n[h].y,m.width,m.height,this.position.x,this.position.y,this.width,this.height),this.spritePosition++}else e.drawImage(E,n[0].x,n[0].y,m.width,m.height,this.position.x,this.position.y,this.width,this.height)}}const di="/LF-SE-Minor-Project_Dungeon-Dread/assets/spwan-6_Ug9n4C.png",wi="/LF-SE-Minor-Project_Dungeon-Dread/assets/type1-CCCx1Bt1.png",k={width:31,height:17,position:[new o(76,17),new o(224,17),new o(410,17),new o(576,17),new o(742,17),new o(76,118),new o(224,118),new o(410,118),new o(576,118),new o(742,118),new o(48,217)]},O={width:24,height:34,positionLeft:[new o(10,3),new o(118,3),new o(226,3),new o(335,3),new o(443,3),new o(6,114),new o(443,3),new o(335,3),new o(226,3),new o(118,3)],positionRight:[new o(479,2),new o(587,2),new o(696,3),new o(804,5),new o(914,5),new o(482,112),new o(914,5),new o(804,5),new o(696,3),new o(587,2)]},_=new Image,j=new Image;_.src=di;j.src=wi;class ci extends q{constructor(){super(...arguments);p(this,"isSpwaned",!1);p(this,"attackInterval",null)}checkCollision(){let e=!1,n=!1,s=r.collideableObjs[0];return r.collideableObjs.forEach(h=>{h.position.y+h.tileSize>=this.position.y&&h.position.y<=this.position.y+this.height&&h.position.x+h.tileSize>=this.position.x&&h.position.x+h.tileSize<=this.position.x+h.tileSize+this.width&&(e=!0,s=h)}),l.position.y+l.height/2>=this.position.y&&l.position.y<=this.position.y+this.height&&l.position.x+l.width>=this.position.x&&l.position.x+l.width<=this.position.x+l.width+this.width?(n=!0,s=l,this.attackInterval||(this.attackInterval=setInterval(()=>{l.healthpoint>0&&(l.healthpoint-=2)},1200))):(clearInterval(this.attackInterval),this.attackInterval=null),{collided:e,collidedObj:s,collidedHero:n}}update(){const e=this.checkCollision();this.lookingLeft=this.position.x>l.position.x;const n=Math.sqrt((this.position.x-l.position.x)**2+(this.position.y-l.position.y)**2);n>50&&(clearInterval(this.attackInterval),this.attackInterval=null);const s=new o((this.position.x-l.position.x)/n,(this.position.y-l.position.y)/n),h=Math.sqrt(2);if(this.velocity=new o(-s.x*h,-s.y*h),e.collidedHero&&(this.velocity.x=0,this.velocity.y=0),!e.collided)this.position.x+=this.velocity.x,this.position.y+=this.velocity.y;else{const w=e.collidedObj.position.x<this.position.x?1:-1,f=e.collidedObj.position.y<this.position.y?1:-1;this.position.x+=w,this.position.y+=f}}draw(e){const n=this.lookingLeft?O.positionLeft:O.positionRight;this.update();let h=Math.floor(this.spritePosition/5)%10;e.drawImage(j,n[h].x,n[h].y,O.width,O.height,this.position.x,this.position.y,this.width,this.height),this.spritePosition++}spwan(e){let s=Math.floor(this.spritePosition/10)%10;e.drawImage(_,k.position[s].x,k.position[s].y,k.width,k.height,this.position.x,this.position.y,this.width,this.height),this.spritePosition++,s>=9&&(this.isSpwaned=!0,this.spritePosition=0,this.velocity=new o(v(1,3),v(1,3)),this.healthpoint=10)}}const gi="/LF-SE-Minor-Project_Dungeon-Dread/assets/map-BCq2fiXg.png";function H(i,t,e,n,s,h,w=""){i.font="2rem ShadowOfTheDead",i.fillStyle="#4caf50",i.fillText(w,t.x,t.y-h/5);const f=Math.floor(e/n*s);i.strokeRect(t.x,t.y,s,h),i.fillStyle="rgba(200,200,200,0.5)",i.fillRect(t.x,t.y,s,h),i.fillStyle="rgba(76, 175, 80,0.5)",i.fillRect(t.x,t.y,f,h)}function G(i,t){i.font="5rem ShadowOfTheDeadOver",i.fillStyle="#4caf50",i.translate(-(i.measureText(t).width/2+r.mapPosition.x),a.height/2-r.mapPosition.y),i.fillText(t,a.width/2,0),i.translate(i.measureText(t).width/2+r.mapPosition.x,-(a.height/2-r.mapPosition.y))}class fi{constructor(t,e,n,s,h){p(this,"position");p(this,"lookingLeft");p(this,"damage");p(this,"width");p(this,"height");p(this,"spritePosition",0);this.position=t,this.lookingLeft=e,this.damage=n,this.width=s,this.height=h}}const yi="/LF-SE-Minor-Project_Dungeon-Dread/assets/pestol-2UG2JAP-.svg",c={width:66,height:38,positionRight:[new o(5,31),new o(67,40),new o(19,46)],positionLeft:[new o(90,31),new o(94,40),new o(143,46)]},u={bulletSize:2,bulletVelocity:20,pestol:200,pestolFireRate:1,pestolDamage:5};class mi{constructor(t,e,n,s,h){p(this,"startPoint");p(this,"endPoint");p(this,"damage");p(this,"isHit",!1);p(this,"velocity");p(this,"gunPosition");this.startPoint=t,this.endPoint=e,this.damage=n,this.velocity=s,this.gunPosition=h}checkOnhit(t){t.forEach(e=>{this.endPoint.x>e.position.x&&this.endPoint.x<e.position.x+e.width&&this.endPoint.y>e.position.y&&this.endPoint.y<e.position.y+e.height&&(this.isHit=!0,e.healthpoint-=this.damage,r.weaponArray.forEach(n=>{n.trackingEnemyObj=null,n.detectedEnemy=!1}))})}draw(t){this.startPoint=this.startPoint.add(this.velocity),this.endPoint=this.endPoint.add(this.velocity),t.beginPath(),t.strokeStyle="gold",t.moveTo(this.startPoint.x,this.startPoint.y),t.lineTo(this.endPoint.x,this.endPoint.y),t.lineWidth=2,t.stroke()}}const N=new Image;N.src=yi;class I extends fi{constructor(){super(...arguments);p(this,"detectedEnemy",!1);p(this,"trackingEnemyObj",null);p(this,"lookingAngle",0);p(this,"shootingPoint",c.positionRight[1]);p(this,"fireRate",u.pestolFireRate);p(this,"fireInterval",null)}detectEnemy(e){const n=this.position;n.distanceBetween(e.position)<u.pestol&&!this.detectedEnemy&&(console.log("zombie detected"),this.detectedEnemy=!0,this.trackingEnemyObj={position:e.position}),this.detectedEnemy&&this.trackingEnemyObj&&(this.lookingAngle=n.angle(new o(this.trackingEnemyObj.position.x,this.trackingEnemyObj.position.y)),this.shoot(),this.position.distanceBetween(this.trackingEnemyObj.position)>u.pestol&&(this.detectedEnemy=!1,clearInterval(this.fireInterval),this.fireInterval=null))}shoot(){this.lookingLeft?this.shootingPoint=new o(this.position.x,this.position.y+this.height/4):this.shootingPoint=new o(this.position.x+this.width,this.position.y+this.height/4),this.trackingEnemyObj&&this.position.x>this.trackingEnemyObj.position.x&&(this.shootingPoint.x=this.position.x),this.shootingPoint.x=this.position.x+(this.shootingPoint.x-this.position.x)*Math.cos(this.lookingAngle)-(this.shootingPoint.y-this.position.y)*Math.sin(this.lookingAngle),this.shootingPoint.y=this.position.y+(this.shootingPoint.x-this.position.x)*Math.sin(this.lookingAngle)+(this.shootingPoint.y-this.position.y)*Math.cos(this.lookingAngle),this.fireInterval||(this.fireInterval=setInterval(()=>{if(this.trackingEnemyObj){const e=new o(this.trackingEnemyObj.position.x+this.width/2,this.trackingEnemyObj.position.y+this.height/2),n=this.shootingPoint.pointDifference(e),s=this.shootingPoint.distanceBetween(e),h=new o(n.x/s,n.y/s),w=new o(this.shootingPoint.x+h.x*10,this.shootingPoint.y+h.y*10),f=new mi(this.shootingPoint,w,u.pestolDamage,new o(-h.x*u.bulletVelocity,-h.y*u.bulletVelocity),this.position);b.push(f)}},1e3/this.fireRate))}draw(e){e.translate(this.position.x,this.position.y),e.rotate(this.lookingAngle);let n;this.lookingLeft?(n=c.positionLeft[0],this.shootingPoint=new o(0,this.height/4)):(n=c.positionRight[0],this.shootingPoint=new o(this.width,this.height/4)),this.trackingEnemyObj&&this.position.x>this.trackingEnemyObj.position.x&&(n=n===c.positionLeft[0]?c.positionRight[0]:c.positionLeft[0],this.shootingPoint.x=0),e.fillStyle="red",e.drawImage(N,n.x,n.y,c.width,c.height,0,0,this.width,this.height),e.rotate(-this.lookingAngle),e.translate(-this.position.x,-this.position.y)}}function ui(){g.btnPressed.a&&(l.isMoving=!0,l.moveLeft(!0,P)),g.btnPressed.d&&(l.isMoving=!0,l.moveLeft(!1,P)),g.btnPressed.w&&(l.moveUp(!0,P),l.isMoving=!0),g.btnPressed.s&&(l.moveUp(!1,P),l.isMoving=!0),g.btnPressed[" "]&&l.ability(),g.btnPressed[`
`]&&console.log("enter")}function Pi(){window.addEventListener("keydown",i=>{g.btnPressed[i.key.toLowerCase()]=!0}),window.addEventListener("keyup",i=>{g.btnPressed[i.key.toLowerCase()]=!1,l.isMoving=!1}),window.addEventListener("click",i=>{zi(new o(i.offsetX,i.offsetY),P)}),window.addEventListener("mouseover",i=>{console.log(i.offsetX,i.offsetY)})}const X=new Image;X.src=gi;let M,y=[],b=[],l;function vi(){const i=new Date().getTime()-M.getTime();return i>=r.waveIntervalTime&&(g.wave++,M=new Date,r.dropdownInterval=!0,setTimeout(()=>{r.dropdownInterval=!1},5e3)),i}const xi=new li(d.tileSize);function Si(){l=new pi(new o(window.innerWidth/2,window.innerHeight/2),"blue",!0,120,35*a.height/600,44*a.height/600)}function ki(){y=y.filter(i=>i.healthpoint>0)}function Oi(){b=b.filter(i=>(i.checkOnhit(y),!(i.endPoint.x>=window.innerHeight*d.mapSizeMultiplier||i.startPoint.x<=0||i.isHit)))}function bi(){setInterval(()=>{if(y.length<r.maxEnemies){const i=new ci(new o(v(d.tileSize+d.displayPosition.x,window.innerWidth*5-d.tileSize),v(d.tileSize+d.displayPosition.y,window.innerHeight*5-d.tileSize*2)),"red",!0,100,24*a.height/700,34*a.height/700);y.push(i)}},500)}function Ii(i){i.strokeStyle="white",i.strokeRect(-r.mapPosition.x+a.width*.2,-r.mapPosition.y+a.height*.9,a.width*.6,a.height*.08),i.fillStyle="rgba(40,200,40,0.1)";for(let e=0;e<6;e++)i.fillRect(-r.mapPosition.x+a.width*(.2+.1*e+.025),-r.mapPosition.y+a.height*(.9+.01),a.width*.05,a.height*.06)}function Ei(i){i.drawImage(X,d.displayPosition.x,d.displayPosition.y,window.innerWidth*d.mapSizeMultiplier,window.innerHeight*d.mapSizeMultiplier),xi.draw(i),l.draw(i),y.forEach(e=>{e.isSpwaned?e.draw(i):e.spwan(i)}),r.dropdownInterval&&G(i,`wave : ${g.wave}`);const t=i.createRadialGradient(l.position.x+l.width/2,l.position.y+l.height/2,l.width,l.position.x+l.width/2,l.position.y+l.height/2,1e3);l.healthpoint>30?(t.addColorStop(0,"rgba(10,10,10,0)"),t.addColorStop(1,"rgba(0,0,0,0.99)")):(t.addColorStop(0,"rgba(10,10,10,0)"),t.addColorStop(1,"rgba(200,0,0,0.99)")),i.fillStyle=t,i.fillRect(-r.mapPosition.x,-r.mapPosition.y,a.width,a.height),H(i,new o(a.width*.05-r.mapPosition.x,a.height*.05-r.mapPosition.y),l.healthpoint,r.heroTotalHealth,a.width*.4,a.height*.03,"Life line"),H(i,new o(a.width*.95-a.width*.4-r.mapPosition.x,a.height*.05-r.mapPosition.y),r.waveIntervalTime-vi(),r.waveIntervalTime,a.width*.4,a.height*.03,"Time remaining"),b.forEach(e=>{e.draw(i)}),r.weaponArray.forEach((e,n)=>{e.draw(i),e.position=l.weaponPositions[n]}),Ii(i)}let L,T,z;function $(i){i==null||i.clearRect(-r.mapPosition.x,-r.mapPosition.y,a.width,a.height),ui(),Ei(i),console.log(y.length),ki(),Oi(),y.forEach(t=>{L.detectEnemy(t),z.detectEnemy(t),T.detectEnemy(t)}),g.ingame&&requestAnimationFrame(()=>{$(i)})}function Mi(i){g.ingame=!0,bi(),Si(),M=new Date,L=new I(l.weaponPositions[0],!1,10,c.width*l.width*.01,c.height*l.width*.01),T=new I(l.weaponPositions[1],!1,10,c.width*l.width*.01,c.height*l.width*.01),z=new I(l.weaponPositions[2],!1,10,c.width*l.width*.01,c.height*l.width*.01),r.weaponArray.push(L),r.weaponArray.push(T),r.weaponArray.push(z),r.dropdownInterval=!0,setTimeout(()=>{r.dropdownInterval=!1},5e3),r.dropdownInterval&&G(i,`wave : ${g.wave}`),$(i)}const V=new Image;V.src=W;function Li(i){i.drawImage(V,0,0,a.width,a.height),i.fillRect(a.width*.1,a.height*.1,a.width*.8,a.height*.8)}function U(i){i.clearRect(0,0,a.width,a.height),Li(i),requestAnimationFrame(()=>{U(i)})}function Ti(i){i.translate(-r.mapPosition.x,-r.mapPosition.y),U(i)}const Y=new Image;Y.src=W;let A,J,D,K;function F(i,t,e){const n=e.width,s=e.actualBoundingBoxAscent+e.actualBoundingBoxDescent;return i.x>t.x&&i.x<t.x+n&&i.y>t.y-s&&i.y<t.y}function zi(i,t){F(i,A,J)&&Mi(t),F(i,D,K)&&Ti(t)}function Ai(i){i.drawImage(Y,0,0,a.width,a.height),A=new o(a.width*.01,a.height*.2),D=new o(a.width*.01,a.height*.3),J=R(i,"Start Game",A),K=R(i,"About",D)}function Q(i){i.clearRect(0,0,a.width,a.height),Ai(i),requestAnimationFrame(()=>{Q(i)})}function Di(i){i.translate(-r.mapPosition.x,-r.mapPosition.y),Q(i)}const a=document.getElementById("canvas"),P=a.getContext("2d");Pi();a&&(a.width=window.innerWidth,a.height=window.innerHeight,a.style.background="linear-gradient(172.33deg, #30303A -1.75%, #20202E 83.53%, #050519 104.9%)",Di(P));
