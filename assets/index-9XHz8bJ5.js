var wt=Object.defineProperty;var pt=(i,n,e)=>n in i?wt(i,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[n]=e;var w=(i,n,e)=>pt(i,typeof n!="symbol"?n+"":n,e);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))s(h);new MutationObserver(h=>{for(const l of h)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function e(h){const l={};return h.integrity&&(l.integrity=h.integrity),h.referrerPolicy&&(l.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?l.credentials="include":h.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(h){if(h.ep)return;h.ep=!0;const l=e(h);fetch(h.href,l)}})();class t{constructor(n,e){w(this,"x");w(this,"y");this.x=n,this.y=e}distanceBetween(n){return Math.sqrt((this.x-n.x)**2+(this.y-n.y)**2)}angle(n){const e=this.x-n.x,s=this.y-n.y;return Math.atan(s/e)}add(n){return new t(this.x+n.x,this.y+n.y)}pointDifference(n){return new t(this.x-n.x,this.y-n.y)}}const O={width:35,height:44,positionRight:[new t(6,6),new t(6,71),new t(6,124),new t(6,172),new t(6,124),new t(6,71)],positionLeft:[new t(64,6),new t(67,71),new t(64,124),new t(67,172),new t(64,124),new t(67,71)]},gt="/LF-SE-Minor-Project_Dungeon-Dread/assets/amaterasu-BhcJas4O.mp3",f={heroTotalHealth:120,width:O.width*window.innerHeight/600,height:O.height*window.innerHeight/600,velocity:new t(5,5),abilityDamage:.1,abilityRate:10,abilityDurability:10*1e3,maxEssence:50,amaterasuSound:new Audio(gt)};let dt=[];const ui=50,ct=Math.floor(window.innerWidth*10/ui),mt=Math.floor(window.innerHeight*10/ui),yt="#radial-gradient(#a9c0a6,#000)",g={tileSize:ui,mapWidth:ct,mapHeight:mt,mapColor:yt,mapTileArray:dt,displayPosition:new t(0,0),mapSizeMultiplier:5},ft="/LF-SE-Minor-Project_Dungeon-Dread/assets/homeMusic-CTRQ4BfC.mp3",ut="/LF-SE-Minor-Project_Dungeon-Dread/assets/wind-1mG3RRHB.mp3",At="/LF-SE-Minor-Project_Dungeon-Dread/assets/coinCollect-D0EQSH2R.wav",St=new Audio(ft),Ti=new Audio(ut),Ri=new Audio(At);Ti.volume=.5;Ri.volume=.2;const o={collideableObjs:[],heroTotalHealth:120,waveIntervalTime:90*1e3,maxEnemies:100*g.mapSizeMultiplier,mapPosition:new t(0,0),dropdownInterval:null,weaponArray:[null,null,null,null,null,null],homeSound:St,windSound:Ti,gemSound:Ri},p={ingame:!1,aboutScreenFlag:!1,controlScreenFlag:!1,homeScreenFlag:!1,btnPressed:{},wave:1,buyScreenFlag:!1,ismute:!1,firstPageFlag:!1},$="/LF-SE-Minor-Project_Dungeon-Dread/assets/background-fPH3rH_v.webp";function z(i,n,e,s="3rem Eater",h="white"){return e||console.log("no position"),i.fillStyle=h,i.font=s,i.fillText(n,e.x,e.y),i.measureText(n)}function Pt(i,n,e,s,h="1rem Arial",l="white"){i.font=h,i.fillStyle=l;const c=i.measureText("sample"),y=c.actualBoundingBoxAscent+c.actualBoundingBoxDescent,k=n.split(" ").filter(D=>!(D===`
`||D==="	"||D===" "));let x="",F=s.y+y;const H=s.x+y;for(let D=0;D<k.length;D++){const Z=x+k[D]+" ";i.measureText(Z).width<=e?x=Z:(i.fillText(x,H,F),F+=y,x="")}i.fillText(x,H,F)}const vt="/LF-SE-Minor-Project_Dungeon-Dread/assets/type_3_4_-0Cq7KuU3.png",Bi="/LF-SE-Minor-Project_Dungeon-Dread/assets/type1-CCCx1Bt1.png",It="/LF-SE-Minor-Project_Dungeon-Dread/assets/type2-BH0ylXV7.png",ti={width:24,height:34,positionLeft:[new t(10,3),new t(118,3),new t(226,3),new t(335,3),new t(443,3),new t(6,114),new t(443,3),new t(335,3),new t(226,3),new t(118,3)],positionRight:[new t(479,2),new t(587,2),new t(696,3),new t(804,5),new t(914,5),new t(482,112),new t(914,5),new t(804,5),new t(696,3),new t(587,2)]},V={width:34,height:30,positionRight:[new t(84,542),new t(121,541),new t(158,542),new t(195,541)],positionLeft:[new t(343,541),new t(308,542),new t(269,541),new t(232,542)]},Oi=new Image,W=new Image,Ci=new Image;Oi.src=Bi;W.src=vt;Ci.src=It;const d={type1:{healthPoint:10,width:ti.width*window.innerHeight/700,height:ti.height*window.innerHeight/700,image:Oi,attackRate:.8,damage:2,velocity:new t(1,1)},type2:{healthPoint:20,width:window.innerHeight/1500,height:window.innerHeight/1500,image:Ci,attackRate:.01,damage:2,velocity:new t(1,1)},type3:{healthPoint:15,width:V.width*window.innerHeight/700,height:V.height*window.innerHeight/700,image:W,attackRate:3,damage:6,velocity:new t(3,3)},type4:{healthPoint:28,width:window.innerHeight/500,height:window.innerHeight/500,image:W,attackRate:1,damage:3,velocity:new t(1,1)},boss:{healthPoint:1800,width:window.innerHeight/500,height:window.innerHeight/500,image:W,attackRate:1,damage:30,velocity:new t(1,1),velocityFast:new t(4,4)}},L={1:[{width:5,height:5,position:new t(106,614)},{width:5,height:16,position:new t(114,614)},{width:10,height:30,position:new t(122,614)},{width:5,height:32,position:new t(135,614)},{width:10,height:30,position:new t(143,614)},{width:15,height:3,position:new t(160,614)},{width:19,height:5,position:new t(183,614)},{width:21,height:7,position:new t(207,614)},{width:22,height:9,position:new t(232,614)},{width:23,height:11,position:new t(256,614)},{width:24,height:13,position:new t(281,614)},{width:24,height:15,position:new t(306,614)},{width:24,height:16,position:new t(331,614)}]},xt="/LF-SE-Minor-Project_Dungeon-Dread/assets/Controls-B4QXboM1.png",Mi=new Image;Mi.src=xt;const Fi=new Image;Fi.src=$;let ei,Li;function kt(i,n,e){const s=e.width,h=e.actualBoundingBoxAscent+e.actualBoundingBoxDescent;return i.x>n.x&&i.x<n.x+s&&i.y>n.y-h&&i.y<n.y}function Et(i,n){kt(i,ei,Li)&&(p.aboutScreenFlag=!1,Si(n))}function bt(i){i.drawImage(Fi,0,0,a.width,a.height),i.fillStyle="rgba(40,40,40,0.8)",i.drawImage(Mi,a.width*.1,a.height*.2,a.width*.5,a.height*.5),i.fillStyle="white",i.font="2rem ShadowOfTheDeadOver",i.fillText("Controls",a.width*.1,a.height*.1),ei=new t(a.width*.1,a.height*.8),Li=z(i,"<-- return Home",ei,"1rem ShadowOfTheDeadOver")}function Hi(i){i.clearRect(0,0,a.width,a.height),bt(i),requestAnimationFrame(()=>{Hi(i)})}function Dt(i){p.controlScreenFlag=!0,console.log("in control"),i.translate(-o.mapPosition.x,-o.mapPosition.y),o.mapPosition=new t(0,0),Hi(i)}const q={width:115,height:62,position:new t(27,18)},Tt="/LF-SE-Minor-Project_Dungeon-Dread/assets/bush-fjx7lCik.png",E={drum:{width:738,height:226,position:new t(590,2280)},stone:{width:1663,height:1487,position:new t(577,773)}},Rt="/LF-SE-Minor-Project_Dungeon-Dread/assets/stoneandDrum-BzVPJaqp.svg",zi=new Image;zi.src=Tt;const ni=new Image;ni.src=Rt;class U{constructor(n,e,s,h){w(this,"position");w(this,"tileType");w(this,"isObstacle");w(this,"tileSize");this.position=n,this.tileType=e,this.isObstacle=s,this.tileSize=h}draw(n){switch(this.tileType){case"bush":n.drawImage(zi,q.position.x,q.position.y,q.width,q.height,this.position.x,this.position.y,this.tileSize,this.tileSize);break;case"empty":break;case"stone":n.drawImage(ni,E.stone.position.x,E.stone.position.y,E.stone.width,E.stone.height,this.position.x,this.position.y,E.stone.width/30,E.stone.height/30);break;case"drum":n.drawImage(ni,E.drum.position.x,E.drum.position.y,E.drum.width,E.drum.height,this.position.x,this.position.y,this.tileSize,this.tileSize);break}}}function P(i,n){const e=Math.ceil(i),s=Math.floor(n);return Math.floor(Math.random()*(s-e+1)+e)}class Bt{constructor(n){w(this,"tileSize");w(this,"mapHeight");w(this,"mapWidth");this.tileSize=n,this.mapHeight=Math.floor(window.innerHeight*g.mapSizeMultiplier/n),this.mapWidth=Math.floor(window.innerWidth*g.mapSizeMultiplier/n),this.initialize(),this.collectCollideableobj()}collectCollideableobj(){g.mapTileArray.forEach(n=>{n.forEach(e=>{e.isObstacle&&o.collideableObjs.push(e)})})}initialize(){for(let n=0;n<this.mapHeight;n++){g.mapTileArray[n]=[];for(let e=0;e<this.mapWidth;e++)if(e===0||n===0||n===this.mapHeight-1||e===this.mapWidth-1)g.mapTileArray[n][e]=new U(new t(e*this.tileSize,n*this.tileSize),"bush",!0,this.tileSize);else{const s=P(1,100);s%2==0&&s<10?s>5?g.mapTileArray[n][e]=new U(new t(e*this.tileSize,n*this.tileSize),"drum",!0,this.tileSize):g.mapTileArray[n][e]=new U(new t(e*this.tileSize,n*this.tileSize),"stone",!0,this.tileSize):g.mapTileArray[n][e]=new U(new t(e*this.tileSize,n*this.tileSize),"empty",!1,this.tileSize)}}}draw(n){g.mapTileArray.forEach(e=>{e.forEach(s=>{s.draw(n)})})}}class K{constructor(n,e,s,h,l,c,y=0,k=0,x=new Image,F=0,H=new t(5,5)){w(this,"position");w(this,"team");w(this,"lookingLeft");w(this,"healthpoint");w(this,"width");w(this,"height");w(this,"spritePosition",0);w(this,"velocity");w(this,"damage");w(this,"attackRate");w(this,"gruntImage");w(this,"gruntType");this.position=n,this.team=e,this.lookingLeft=s,this.healthpoint=h,this.width=l,this.height=c,this.damage=y,this.attackRate=k,this.gruntImage=x,this.gruntType=F,this.velocity=H}}const Ot="/LF-SE-Minor-Project_Dungeon-Dread/assets/hero-CXBE-ivq.png",Ct="/LF-SE-Minor-Project_Dungeon-Dread/assets/amaterasu-Bq5RU4UD.png",Q={width:339,height:404,position:[new t(6,13),new t(345,13),new t(684,13),new t(1024,13),new t(1365,13),new t(1706,13),new t(2047,13),new t(2388,13)]},Gi=new Image;Gi.src=Ct;const oi=new Image;oi.src=Ot;class Mt extends K{constructor(){super(...arguments);w(this,"isMoving",!1);w(this,"speedLimit",3);w(this,"weaponOffset",10);w(this,"abilityInterval",null);w(this,"abilityDamage",f.abilityDamage);w(this,"abilityDurability",f.abilityDurability);w(this,"abilityRate",f.abilityRate);w(this,"abilityInUse",!1);w(this,"inRangeEnemies",[]);w(this,"abilityTime",new Date);w(this,"gemCount",0);w(this,"essenceCount",0);w(this,"weaponPositions",[new t(this.position.x+this.weaponOffset+this.width,this.position.y),new t(this.position.x-this.weaponOffset,this.position.y),new t(this.position.x+this.weaponOffset+this.width,this.position.y+this.height/2),new t(this.position.x-this.weaponOffset,this.position.y+this.height/2),new t(this.position.x+this.weaponOffset+this.width,this.position.y),new t(this.position.x+this.weaponOffset+this.width,this.position.y)])}ability(){!this.abilityInUse&&new Date().getTime()-this.abilityTime.getTime()>15*1e3&&this.essenceCount&&(this.abilityTime=new Date,this.abilityInUse=!0,f.amaterasuSound.currentTime=2,f.amaterasuSound.play(),this.inRangeEnemies=A.filter(e=>{if(e.position.x>-o.mapPosition.x&&e.position.x<-o.mapPosition.x+a.width&&e.position.y>-o.mapPosition.y&&e.position.y<-o.mapPosition.y+a.height)return!0}),S&&this.inRangeEnemies.push(S),setTimeout(()=>{this.inRangeEnemies=[],this.abilityInUse=!1},this.abilityDurability*(this.essenceCount/f.maxEssence)),this.essenceCount=0)}reheal(){setInterval(()=>{this.healthpoint<50&&(this.healthpoint+=3)},5e3)}checkCollision(){let e=!1,s=o.collideableObjs[0];return o.collideableObjs.forEach(h=>{h.position.y+h.tileSize>=this.position.y&&h.position.y<=this.position.y+this.height&&h.position.x+h.tileSize>=this.position.x&&h.position.x+h.tileSize<=this.position.x+h.tileSize+this.width&&(e=!0,s=h)}),{collided:e,collidedObj:s}}updateWeaponPosition(){this.weaponPositions=[new t(this.position.x+this.weaponOffset+this.width,this.position.y),new t(this.position.x-this.weaponOffset,this.position.y),new t(this.position.x+this.weaponOffset+this.width,this.position.y+this.height/2),new t(this.position.x-this.weaponOffset,this.position.y+this.height/2),new t(this.position.x+this.weaponOffset+this.width,this.position.y+this.height),new t(this.position.x-this.weaponOffset,this.position.y+this.height)]}moveLeft(e,s){const h=e?this.velocity.x:-1*this.velocity.x;this.lookingLeft=e;const l=this.checkCollision();if(!l.collided)o.mapPosition.x+=h,s.translate(h,0);else{const c=l.collidedObj.position.y<this.position.y?-1:1,y=l.collidedObj.position.x<this.position.x?-1:1;o.mapPosition.x+=y,o.mapPosition.y+=c,s.translate(y,c)}this.updateWeaponPosition()}moveUp(e,s){const h=e?this.velocity.y:-1*this.velocity.y,l=this.checkCollision();if(!l.collided)o.mapPosition.y+=h,s.translate(0,h);else{const c=l.collidedObj.position.y<this.position.y?-1:1,y=l.collidedObj.position.x<this.position.x?-1:1;o.mapPosition.x+=y,o.mapPosition.y+=c,s.translate(y,c)}this.updateWeaponPosition()}draw(e){this.position.x=a.width/2-o.mapPosition.x,this.position.y=a.height/2-o.mapPosition.y,this.inRangeEnemies.forEach(h=>{let l=Math.floor(this.spritePosition/5)%Q.position.length;e.drawImage(Gi,Q.position[l].x,Q.position[l].y,Q.width,Q.height,h.position.x,h.position.y,h.width,h.height),h.healthpoint-=this.abilityDamage});const s=this.lookingLeft?O.positionLeft:O.positionRight;if(this.isMoving){let l=Math.floor(this.spritePosition/5)%s.length;e.drawImage(oi,s[l].x,s[l].y,O.width,O.height,this.position.x,this.position.y,this.width,this.height)}else e.drawImage(oi,s[0].x,s[0].y,O.width,O.height,this.position.x,this.position.y,this.width,this.height);this.healthpoint<0,this.spritePosition++}}const Ai="/LF-SE-Minor-Project_Dungeon-Dread/assets/spwan-6_Ug9n4C.png",I={width:31,height:17,position:[new t(76,17),new t(224,17),new t(410,17),new t(576,17),new t(742,17),new t(76,118),new t(224,118),new t(410,118),new t(576,118),new t(742,118),new t(48,217)]},Qi=new Image;Qi.src=Ai;class Pi extends K{constructor(){super(...arguments);w(this,"isSpwaned",!1);w(this,"attackInterval",null)}checkCollision(){let e=!1,s=!1,h=o.collideableObjs[0];return o.collideableObjs.forEach(l=>{l.position.y+l.tileSize>=this.position.y&&l.position.y<=this.position.y+this.height&&l.position.x+l.tileSize>=this.position.x&&l.position.x+l.tileSize<=this.position.x+l.tileSize+this.width&&(e=!0,h=l)}),r.position.y+r.height/2>=this.position.y&&r.position.y<=this.position.y+this.height&&r.position.x+r.width>=this.position.x&&r.position.x+r.width<=this.position.x+r.width+this.width?(s=!0,h=r,this.attackInterval||(this.attackInterval=setInterval(()=>{r.healthpoint>0&&(r.healthpoint-=this.damage)},1e3/this.attackRate))):(clearInterval(this.attackInterval),this.attackInterval=null),{collided:e,collidedObj:h,collidedHero:s}}update(){const e=this.checkCollision();this.lookingLeft=this.position.x>r.position.x;const s=Math.sqrt((this.position.x-r.position.x)**2+(this.position.y-r.position.y)**2);s>50&&(clearInterval(this.attackInterval),this.attackInterval=null);const h=new t((this.position.x-r.position.x)/s,(this.position.y-r.position.y)/s),l=Math.sqrt(this.velocity.x*this.velocity.x+this.velocity.y*this.velocity.y),c=new t(-h.x*l,-h.y*l);if(!e.collidedHero&&!e.collided&&(this.position.x+=c.x,this.position.y+=c.y),e.collided){const y=e.collidedObj.position.x<this.position.x?1:-1,k=e.collidedObj.position.y<this.position.y?1:-1;this.position.x+=y,this.position.y+=k}}draw(e){let s;switch(this.gruntType){case 1:s=ti;break;case 3:s=V;break}const h=this.lookingLeft?s.positionLeft:s.positionRight;this.update();let c=Math.floor(this.spritePosition/5)%s.positionLeft.length;e.drawImage(this.gruntImage,h[c].x,h[c].y,V.width,V.height,this.position.x,this.position.y,this.width,this.height),this.spritePosition++}spwan(e){let h=Math.floor(this.spritePosition/10)%10;e.drawImage(Qi,I.position[h].x,I.position[h].y,I.width,I.height,this.position.x,this.position.y,this.width,this.height),this.spritePosition++,h>=9&&(this.isSpwaned=!0,this.spritePosition=0)}}const Ft="/LF-SE-Minor-Project_Dungeon-Dread/assets/map-BCq2fiXg.png";function j(i,n,e,s,h,l,c=""){i.font="2rem ShadowOfTheDead",i.fillStyle="#4caf50",i.fillText(c,n.x,n.y-l/5);const y=Math.floor(e/s*h);i.strokeRect(n.x,n.y,h,l),i.fillStyle="rgba(200,200,200,0.5)",i.fillRect(n.x,n.y,h,l),i.fillStyle="rgba(76, 175, 80,0.5)",i.fillRect(n.x,n.y,y,l)}function J(i,n,e=new t(-(i.measureText(n).width/2+o.mapPosition.x),a.height/2-o.mapPosition.y),s="5rem ShadowOfTheDeadOver",h="#4caf50"){i.font=s,i.fillStyle=h,i.translate(e.x,e.y),i.fillText(n,a.width/2,0),i.translate(-e.x,-e.y)}class Lt{constructor(n,e,s,h,l,c=1,y=500,k,x){w(this,"position");w(this,"lookingLeft");w(this,"damage");w(this,"width");w(this,"height");w(this,"spritePosition",0);w(this,"fireRate");w(this,"cost");w(this,"gunImage");w(this,"guntype");this.position=n,this.lookingLeft=e,this.damage=s,this.width=h,this.height=l,this.gunImage=k,this.fireRate=c,this.cost=y,this.guntype=x}}const v={width:66,height:38,positionRight:[new t(5,31),new t(67,40),new t(19,46)],positionLeft:[new t(90,31),new t(94,40),new t(143,46)]},C={bulletSize:2,bulletVelocity:20,pestol:300,pestolFireRate:1,pestolDamage:5};class Ht{constructor(n,e,s,h,l){w(this,"startPoint");w(this,"endPoint");w(this,"damage");w(this,"isHit",!1);w(this,"velocity");w(this,"gunPosition");this.startPoint=n,this.endPoint=e,this.damage=s,this.velocity=h,this.gunPosition=l}checkOnhit(n,e=null){n.forEach(s=>{this.endPoint.x>s.position.x&&this.endPoint.x<s.position.x+s.width&&this.endPoint.y>s.position.y&&this.endPoint.y<s.position.y+s.height&&(this.isHit=!0,s.healthpoint-=this.damage)}),e&&this.endPoint.x>e.position.x&&this.endPoint.x<e.position.x+e.width&&this.endPoint.y>e.position.y&&this.endPoint.y<e.position.y+e.height&&(this.isHit=!0,e.healthpoint-=this.damage)}draw(n){this.startPoint=this.startPoint.add(this.velocity),this.endPoint=this.endPoint.add(this.velocity),n.beginPath(),n.strokeStyle="gold",n.moveTo(this.startPoint.x,this.startPoint.y),n.lineTo(this.endPoint.x,this.endPoint.y),n.lineWidth=2,n.stroke()}}const M={width:66,height:38,positionLeft:[new t(5,31),new t(67,40),new t(19,46)],positionRight:[new t(90,31),new t(94,40),new t(143,46)]},Vi="/LF-SE-Minor-Project_Dungeon-Dread/assets/gun-CYm9DPhZ.mp3";class si extends Lt{constructor(){super(...arguments);w(this,"detectedEnemy",!1);w(this,"trackingEnemyObj",null);w(this,"lookingAngle",0);w(this,"shootingPoint",v.positionRight[1]);w(this,"fireInterval",null);w(this,"level",1);w(this,"sound",new Audio(Vi))}playSound(){p.ismute||(this.sound.volume=.2,this.sound&&(this.sound.pause(),this.sound.currentTime=0),this.sound.play())}detectEnemy(e){const s=this.position;s.distanceBetween(e.position)<C.pestol&&!this.detectedEnemy&&(this.detectedEnemy=!0,this.trackingEnemyObj=e),this.detectedEnemy&&this.trackingEnemyObj&&(this.lookingAngle=s.angle(new t(this.trackingEnemyObj.position.x,this.trackingEnemyObj.position.y)),this.shoot(),this.position.distanceBetween(this.trackingEnemyObj.position)>C.pestol&&(this.detectedEnemy=!1,clearInterval(this.fireInterval),this.fireInterval=null)),this.trackingEnemyObj&&this.trackingEnemyObj.healthpoint<0&&(this.detectedEnemy=!1,clearInterval(this.fireInterval),this.fireInterval=null)}shoot(){this.lookingLeft?this.shootingPoint=new t(this.position.x,this.position.y+this.height/4):this.shootingPoint=new t(this.position.x+this.width,this.position.y+this.height/4),this.trackingEnemyObj&&this.position.x>this.trackingEnemyObj.position.x&&(this.shootingPoint.x=this.position.x),this.shootingPoint.x=this.position.x+(this.shootingPoint.x-this.position.x)*Math.cos(this.lookingAngle)-(this.shootingPoint.y-this.position.y)*Math.sin(this.lookingAngle),this.shootingPoint.y=this.position.y+(this.shootingPoint.x-this.position.x)*Math.sin(this.lookingAngle)+(this.shootingPoint.y-this.position.y)*Math.cos(this.lookingAngle),this.fireInterval||(this.fireInterval=setInterval(()=>{if(this.trackingEnemyObj){const e=new t(this.trackingEnemyObj.position.x+this.trackingEnemyObj.width/2,this.trackingEnemyObj.position.y+this.trackingEnemyObj.height/2),s=this.shootingPoint.pointDifference(e),h=this.shootingPoint.distanceBetween(e),l=new t(s.x/h,s.y/h),c=new t(this.shootingPoint.x+l.x*10,this.shootingPoint.y+l.y*10),y=new Ht(this.shootingPoint,c,this.damage,new t(-l.x*C.bulletVelocity,-l.y*C.bulletVelocity),this.position);Y.push(y),this.playSound()}},1e3/this.fireRate))}draw(e){let s;switch(this.guntype){case"pistol":s=v;break;case"smg":s=M;break}e.translate(this.position.x,this.position.y),e.rotate(this.lookingAngle);let h;this.lookingLeft?(h=s.positionLeft[0],this.shootingPoint=new t(0,this.height/4)):(h=s.positionRight[0],this.shootingPoint=new t(this.width,this.height/4)),this.trackingEnemyObj&&this.position.x>this.trackingEnemyObj.position.x&&(h=h===v.positionLeft[0]?v.positionRight[0]:v.positionLeft[0],this.shootingPoint.x=0),e.fillStyle="red",e.drawImage(this.gunImage,h.x,h.y,v.width,v.height,0,0,this.width,this.height),e.rotate(-this.lookingAngle),e.translate(-this.position.x,-this.position.y)}}function zt(i){i.strokeStyle="white",i.fillStyle="rgba(40,200,40,0.1)",i.fillRect(-o.mapPosition.x+a.width*.2,-o.mapPosition.y+a.height*.8,a.width*.6,a.width*.08),i.strokeRect(-o.mapPosition.x+a.width*.2,-o.mapPosition.y+a.height*.8,a.width*.6,a.width*.08),i.fillStyle="rgba(200,200,200,0.8)";for(let e=0;e<6;e++)if(i.fillRect(-o.mapPosition.x+a.width*(.2+.1*e+.025),-o.mapPosition.y+a.height*(.8+.03),a.width*.05,a.width*.05),o.weaponArray[e]){switch(o.weaponArray[e].level){case 1:i.fillStyle="rgba(200,200,200,0.8)";break;case 2:i.fillStyle="rgba(15,10,222,0.8)";break;case 3:i.fillStyle="rgba(255,215,0,0.8)";break}i.drawImage(o.weaponArray[e].gunImage,-o.mapPosition.x+a.width*(.2+.1*e+.025),-o.mapPosition.y+a.height*(.8+.03),a.width*.05,a.width*.05)}}const Gt="/LF-SE-Minor-Project_Dungeon-Dread/assets/pestol-2UG2JAP-.svg",Qt="/LF-SE-Minor-Project_Dungeon-Dread/assets/smg-9gzp5Pqq.svg",Vt="data:image/png;base64,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",Yt=new Audio(Vi),Yi=new Image;Yi.src=Gt;const Ni=new Image;Ni.src=Qt;const Ki=new Image;Ki.src=Vt;const m={pistol:{damage:3,width:v.width*f.width*.01,height:v.height*f.width*.01,image:Yi,fireRate:2,cost:500},smg:{damage:1,width:M.width*f.width*.01,height:M.height*f.width*.01,image:Ni,fireRate:4,cost:1500},sword:{damage:10,width:M.width*f.width*.01,height:M.height*f.width*.01,image:Ki,fireRate:1,cost:1e3},sound:Yt};let Zi;const vi=5*1e3;let u=0;function Ii(){return new Date().getTime()-Zi.getTime()}function xi(i,n,e){const s=e.x,h=e.y;return i=new t(i.x-o.mapPosition.x,i.y-o.mapPosition.y),i.x>n.x&&i.x<n.x+s&&i.y>n.y&&i.y<n.y+h}let Nt=i=>{for(let h=0;h<6;h++)if(xi(i,new t(-o.mapPosition.x+a.width*(.2+.1*h+.025),-o.mapPosition.y+a.height*.8300000000000001),new t(a.width*.05,a.width*.05))){u=h;break}const n=a.width*.8-o.mapPosition.x,e=a.height*.5-o.mapPosition.y,s=new t(a.width*.1-o.mapPosition.x,a.height*.1-o.mapPosition.y);for(let h=0;h<4;h++)if(xi(i,new t(s.x+n*h/4,s.y),new t(n/4,e))){switch(h){case 0:r.gemCount>=m.pistol.cost&&(o.weaponArray[u]=new si(r.weaponPositions[u],!1,m.pistol.damage,m.pistol.width,m.pistol.height,m.pistol.fireRate,m.pistol.cost,m.pistol.image,"pistol"),r.gemCount-=m.pistol.cost);break;case 1:r.gemCount>=m.smg.cost&&(o.weaponArray[u]=new si(r.weaponPositions[u],!1,m.smg.damage,m.smg.width,m.smg.height,m.smg.fireRate,m.smg.cost,m.smg.image,"smg"),r.gemCount-=m.smg.cost);break}for(let c=0;c<o.weaponArray.length&&(u=c,!!o.weaponArray[c]);c++);break}};function Kt(){o.weaponArray[u]&&o.weaponArray[u].level<3&&r.gemCount>=o.weaponArray[u].cost*1.1&&(o.weaponArray[u].damage+=o.weaponArray[u].damage*.1,o.weaponArray[u].fireRate+=o.weaponArray[u].fireRate*.1,o.weaponArray[u].level++,r.gemCount-=o.weaponArray[u].cost*.1)}function ki(i,n,e,s,h,l,c,y,k,x,F,H,D,Z){i.strokeRect(e.x+s*n/4,e.y,s/4,h),i.fillRect(e.x+s*n/4+s/8-l/2,e.y*1.3,l,l),i.drawImage(c,y.x,y.y,k,x,e.x+s*n/4+s/8-l/2,e.y*1.3,l,l),i.font="2rem Eater",i.fillStyle="white";const _=i.measureText("sample"),X=_.actualBoundingBoxAscent+_.actualBoundingBoxDescent;i.fillText(`Gun: ${F}`,e.x+s*n/4+l/2,e.y*1.3+l+X*4),i.fillText(`Cost: ${H}`,e.x+s*n/4+l/2,e.y*1.3+l+X*5.5),i.fillText(`Damage: ${D}`,e.x+s*n/4+l/2,e.y*1.3+l+X*7),i.fillText(`Fire Rate: ${Z}`,e.x+s*n/4+l/2,e.y*1.3+l+X*8.5)}function Xi(i){const n=a.width*.8-o.mapPosition.x,e=a.height*.5-o.mapPosition.y,s=new t(a.width*.1-o.mapPosition.x,a.height*.1-o.mapPosition.y),h=a.width*.05;i==null||i.clearRect(-o.mapPosition.x,-o.mapPosition.y,a.width,a.height),i.fillStyle="rgba(10,10,40,0.5)",i.fillRect(s.x,s.y,n,e),i.font="3rem ShadowOfTheDeadOver",i.fillStyle="#4caf50",i.fillText("Buy Menu: ",a.width*.1-o.mapPosition.x,a.height*.1-o.mapPosition.y),i.font="2rem Eater",i.fillStyle="#4caf50",i.fillText(`Gems Count: ${r.gemCount}`,a.width*.8-o.mapPosition.x,a.height*.1-o.mapPosition.y),i.fillStyle="rgba(200,200,200,0.8)",i.strokeStyle="green",ki(i,0,s,n,e,h,m.pistol.image,v.positionRight[0],v.width,v.height,"Pistol",m.pistol.cost,m.pistol.damage,m.pistol.fireRate),ki(i,1,s,n,e,h,m.smg.image,M.positionRight[0],M.width,M.height,"SMG",m.smg.cost,m.smg.damage,m.smg.fireRate),zt(i),i.strokeStyle="gold",i.strokeRect(-o.mapPosition.x+a.width*(.2+.1*u+.025),-o.mapPosition.y+a.height*(.8+.03),a.width*.05,a.width*.05),j(i,new t(a.width*.1-o.mapPosition.x,a.height*.7-o.mapPosition.y),Ii(),vi,a.width*.8,a.height*.01,"Buy Time:"),Ii()>=vi&&(o.weaponArray.forEach((l,c)=>{l&&(l.position=r.weaponPositions[c])}),p.buyScreenFlag=!1,et(i)),p.ingame||requestAnimationFrame(()=>{Xi(i)})}function Zt(i){i.translate(-o.mapPosition.x,-o.mapPosition.y),o.mapPosition=new t(0,0),p.ingame=!1,p.buyScreenFlag=!0,Zi=new Date,u=0;for(let n=0;n<o.weaponArray.length&&(u=n,!!o.weaponArray[n]);n++);Xi(i)}const b={width:45,height:55,positionRight:[new t(93,226),new t(142,230),new t(189,235),new t(229,231)],positionLeft:[new t(278,235),new t(326,231),new t(372,225),new t(414,230)],attackLeft:[{width:34,height:58,position:new t(173,283)},{width:64,height:41,position:new t(208,300)},{width:53,height:42,position:new t(273,305)}],attackRight:[{width:33,height:58,position:new t(20,283)},{width:64,height:41,position:new t(54,300)},{width:53,height:41,position:new t(119,306)}]},qi=new Image,Xt=new Image;qi.src=Ai;Xt.src=Bi;class qt extends K{constructor(){super(...arguments);w(this,"isSpwaned",!1);w(this,"attackInterval",null);w(this,"isAttacking",!1)}checkCollision(){let e=!1,s=!1,h=o.collideableObjs[0];return o.collideableObjs.forEach(l=>{l.position.y+l.tileSize>=this.position.y&&l.position.y<=this.position.y+this.height&&l.position.x+l.tileSize>=this.position.x&&l.position.x+l.tileSize<=this.position.x+l.tileSize+this.width&&(e=!0,h=l)}),r.position.y+r.height/2>=this.position.y&&r.position.y<=this.position.y+this.height&&r.position.x+r.width>=this.position.x&&r.position.x+r.width<=this.position.x+r.width+this.width&&(s=!0,h=r),{collided:e,collidedObj:h,collidedHero:s}}update(){const e=this.checkCollision();this.lookingLeft=this.position.x>r.position.x;const s=Math.sqrt((this.position.x-r.position.x)**2+(this.position.y-r.position.y)**2);s>50&&(clearInterval(this.attackInterval),this.attackInterval=null);const h=new t((this.position.x-r.position.x)/s,(this.position.y-r.position.y)/s),l=Math.sqrt(2);if(this.velocity=new t(-h.x*l,-h.y*l),e.collidedHero?this.isAttacking=!0:(this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.isAttacking=!1),!e.collided)this.position.x+=this.velocity.x,this.position.y+=this.velocity.y;else{const c=e.collidedObj.position.x<this.position.x?1:-1,y=e.collidedObj.position.y<this.position.y?1:-1;this.position.x+=c,this.position.y+=y}}draw(e){if(this.update(),this.isAttacking){const s=this.lookingLeft?b.attackLeft:b.attackRight,l=Math.floor(this.spritePosition/10)%b.attackLeft.length;this.height=s[l].height,this.width=s[l].width,l==2&&(r.healthpoint-=this.damage),e.drawImage(d.type3.image,s[l].position.x,s[l].position.y,s[l].width,s[l].height,this.position.x,this.position.y,this.width,this.height)}else{const s=this.lookingLeft?b.positionLeft:b.positionRight,l=Math.floor(this.spritePosition/8)%b.positionLeft.length;this.width=b.width,this.height=b.height,e.drawImage(d.type3.image,s[l].x,s[l].y,b.width,b.height,this.position.x,this.position.y,this.width,this.height)}this.spritePosition++}spwan(e){const h=Math.floor(this.spritePosition/10)%10;e.drawImage(qi,I.position[h].x,I.position[h].y,I.width,I.height,this.position.x,this.position.y,this.width,this.height),this.spritePosition++,h>=9&&(this.isSpwaned=!0,this.spritePosition=0)}}const Ut={position:[{width:137,height:79,position:new t(12,28)},{width:144,height:78,position:new t(168,28)},{width:147,height:77,position:new t(326,29)},{width:144,height:76,position:new t(488,28)},{width:127,height:80,position:new t(659,27)},{width:111,height:83,position:new t(27,168)},{width:127,height:80,position:new t(179,167)}]},Wt="/LF-SE-Minor-Project_Dungeon-Dread/assets/spit-CufzTxly.png",Jt=new Image;Jt.src=Wt;class Ui{constructor(n,e,s,h){w(this,"position");w(this,"damage");w(this,"isHit",!1);w(this,"velocity");w(this,"gunPosition");w(this,"radius",window.innerWidth/100);this.position=n,this.damage=e,this.velocity=s,this.gunPosition=h}checkOnhit(){this.position.x-this.radius>r.position.x&&this.position.x+this.radius<r.position.x+r.width&&this.position.y-this.radius>r.position.y&&this.position.y+this.radius<r.position.y+r.height&&(this.isHit=!0,r.healthpoint-=this.damage)}update(){this.position.x+=this.velocity.x,this.position.y+=this.velocity.y}draw(n){this.update(),n.beginPath(),n.fillStyle="green",n.arc(this.position.x,this.position.y,this.radius,0,Math.PI*2),n.fill()}}const Wi=new Image;Wi.src=Ai;class jt extends K{constructor(){super(...arguments);w(this,"isSpwaned",!1);w(this,"attackInterval",null);w(this,"attackRadius",400)}update(){const e=Math.sqrt((this.position.x-r.position.x)**2+(this.position.y-r.position.y)**2),s=new t((this.position.x-r.position.x)/e,(this.position.y-r.position.y)/e),h=Math.sqrt(this.velocity.x*this.velocity.x+this.velocity.y*this.velocity.y),l=new t(-s.x*h,-s.y*h);e>2e3?(clearInterval(this.attackInterval),this.attackInterval=null,this.position.x+=l.x,this.position.y+=l.y):this.spitHero()}spitHero(){this.attackInterval||(this.attackInterval=setInterval(()=>{if(r){const e=new t(r.position.x,r.position.y),s=this.position.pointDifference(e),h=this.position.distanceBetween(e),l=new t(s.x/h,s.y/h),c=new Ui(new t(this.position.x+this.width/2,this.position.y+this.width/2),this.damage,new t(-l.x*C.bulletVelocity*.3,-l.y*C.bulletVelocity*.3),this.position);G.push(c)}},1e3/this.attackRate))}draw(e){const s=Ut;this.update();let l=Math.floor(this.spritePosition/5)%s.position.length;this.width=s.position[l].width,this.height=s.position[l].height,e.drawImage(this.gruntImage,s.position[l].position.x,s.position[l].position.y,s.position[l].width,s.position[l].height,this.position.x,this.position.y,s.position[l].width*d.type2.width,s.position[l].height*d.type2.height),this.spritePosition++}spwan(e){let h=Math.floor(this.spritePosition/10)%10;e.drawImage(Wi,I.position[h].x,I.position[h].y,I.width,I.height,this.position.x,this.position.y,this.width,this.height),this.spritePosition++,h>=9&&(this.isSpwaned=!0,this.spritePosition=0)}}const $t="/LF-SE-Minor-Project_Dungeon-Dread/assets/gem-CYeD5NUz.png",T={1:[{width:80,height:80,position:new t(91,7)},{width:77,height:80,position:new t(172,7)},{width:57,height:80,position:new t(262,7)},{width:40,height:80,position:new t(351,7)},{width:57,height:80,position:new t(422,7)},{width:77,height:80,position:new t(492,7)}]},Ji=new Image;Ji.src=$t;class _t{constructor(n,e,s,h){w(this,"position");w(this,"value");w(this,"spritePostion",0);w(this,"width");w(this,"height");this.position=n,this.value=e,this.width=s,this.height=h}draw(n){const s=Math.floor(this.spritePostion/5)%T[1].length;n.drawImage(Ji,T[1][s].position.x,T[1][s].position.y,T[1][s].width,T[1][s].height,this.position.x,this.position.y,T[1][s].width*.3,T[1][s].height*.3),this.spritePostion++}collected(){return r.position.y+r.height+20>=this.position.y&&r.position.y-20<=this.position.y+this.height&&r.position.x+r.width+20>=this.position.x&&r.position.x-20<=this.position.x+this.width?(p.ismute||(o.gemSound&&(o.gemSound.pause(),o.gemSound.currentTime=0),o.gemSound.play()),r.gemCount+=this.value,r.essenceCount<f.maxEssence&&(r.essenceCount+=1),!1):!0}}const B={width:226,height:148,position:[new t(1,21),new t(234,21),new t(456,21),new t(700,21),new t(936,21),new t(1169,21),new t(1396,21),new t(1622,21),new t(1850,21),new t(2077,21),new t(2304,21),new t(2531,21),new t(2758,21),new t(2985,21),new t(3212,21),new t(3439,21),new t(3665,21),new t(3892,21),new t(4119,21),new t(4346,21),new t(4572,21),new t(4800,21),new t(5027,21),new t(5253,21),new t(5481,21),new t(5708,21),new t(5936,21),new t(6163,21),new t(6391,21),new t(6619,21),new t(6846,21),new t(7074,21),new t(7301,21),new t(7529,21),new t(7983,21),new t(8210,21),new t(8437,21),new t(8665,21)]},ie="/LF-SE-Minor-Project_Dungeon-Dread/assets/boss-CV5mu1oo.png",ji=new Image;ji.src=ie;class te extends K{constructor(){super(...arguments);w(this,"speedToggle",!1);w(this,"attackInterval",null);w(this,"spitInterval",null)}changeSpeed(){this.spitTohero(),this.spitInterval=setInterval(()=>{this.velocity=this.speedToggle?d.boss.velocity:d.boss.velocityFast,this.speedToggle=!this.speedToggle},5e3)}checkCollision(){return r.position.y+r.height/2>=this.position.y&&r.position.y<=this.position.y+this.height&&r.position.x+r.width>=this.position.x&&r.position.x+r.width<=this.position.x+r.width+this.width}update(){this.checkCollision()?this.attackInterval||(this.attackInterval=setInterval(()=>{r.healthpoint>0&&(r.healthpoint-=this.damage)},1e3/this.attackRate)):(this.moveTowardsHero(),clearInterval(this.attackInterval),this.attackInterval=null)}spitTohero(){this.attackInterval||(this.spitInterval=setInterval(()=>{if(r){const e=new t(r.position.x,r.position.y),s=this.position.pointDifference(e),h=this.position.distanceBetween(e),l=new t(s.x/h,s.y/h),c=new Ui(new t(this.position.x+this.width/2,this.position.y+this.width/2),this.damage,new t(-l.x*C.bulletVelocity*.3,-l.y*C.bulletVelocity*.3),this.position);G.push(c)}},1e3/this.attackRate))}moveTowardsHero(){const e=this.position.pointDifference(r.position),s=this.position.distanceBetween(r.position),h=new t(-(e.x/s)*this.velocity.x,-(e.y/s)*this.velocity.y);this.position.x+=h.x,this.position.y+=h.y}draw(e){this.update();const s=(this.lookingLeft,B.position);let l=Math.floor(this.spritePosition/5)%s.length;this.width=B.width*d.boss.width,this.height=B.height*d.boss.height,e.drawImage(ji,B.position[l].x,B.position[l].y,B.width,B.height,this.position.x,this.position.y,this.width,this.height),j(e,this.position,this.healthpoint,d.boss.healthPoint,200,5),this.spritePosition++}}const $i=new Image;$i.src=Ft;let _i,A=[],Y=[],N=[],G=[],r,S,hi;function Ei(){return new Date().getTime()-_i.getTime()}const ee=new Bt(g.tileSize);function it(){r=new Mt(new t(window.innerWidth/2,window.innerHeight/2),"blue",!0,o.heroTotalHealth,f.width,f.height),r.reheal()}function ne(){N=N.filter(i=>i.collected())}function oe(){A=A.filter(i=>{if(i.healthpoint<0)clearInterval(i.attackInterval),N.push(new _t(i.position,16,T[1][0].width*.2,T[1][0].height*.2));else return!0})}function se(){Y=Y.filter(i=>(i.checkOnhit(A,S),!(i.endPoint.x>=window.innerHeight*g.mapSizeMultiplier||i.startPoint.x<=0||i.isHit))),G=G.filter(i=>(i.checkOnhit(),!(i.position.x>=window.innerHeight*g.mapSizeMultiplier||i.position.x<=0||i.isHit)))}function he(){hi=setInterval(()=>{if(A.length<o.maxEnemies){const i=P(1,100);p.wave>2&&i<40&&A.push(new jt(new t(P(g.tileSize+g.displayPosition.x,window.innerWidth*5-g.tileSize),P(g.tileSize+g.displayPosition.y,window.innerHeight*5-g.tileSize*2)),"red",!0,d.type2.healthPoint,d.type2.width,d.type2.height,d.type2.damage,d.type2.attackRate,d.type2.image,2,d.type2.velocity)),p.wave>3&&i<50?A.push(new qt(new t(P(g.tileSize+g.displayPosition.x,window.innerWidth*5-g.tileSize),P(g.tileSize+g.displayPosition.y,window.innerHeight*5-g.tileSize*2)),"red",!0,d.type4.healthPoint,d.type4.width,d.type4.height,d.type4.damage,d.type4.attackRate,d.type4.image,4,d.type4.velocity)):p.wave>1&&i<60?A.push(new Pi(new t(P(g.tileSize+g.displayPosition.x,window.innerWidth*5-g.tileSize),P(g.tileSize+g.displayPosition.y,window.innerHeight*5-g.tileSize*2)),"red",!0,d.type3.healthPoint,d.type3.width,d.type3.height,d.type3.damage,d.type3.attackRate,d.type3.image,3,d.type3.velocity)):A.push(new Pi(new t(P(g.tileSize+g.displayPosition.x,window.innerWidth*5-g.tileSize),P(g.tileSize+g.displayPosition.y,window.innerHeight*5-g.tileSize*2)),"red",!0,d.type1.healthPoint,d.type1.width,d.type1.height,d.type1.damage,d.type1.attackRate,d.type1.image,1,d.type1.velocity))}},500)}function ae(i){i.strokeStyle="white",i.fillStyle="rgba(40,200,40,0.1)",i.fillRect(-o.mapPosition.x+a.width*.2,-o.mapPosition.y+a.height*.8,a.width*.6,a.width*.08),i.strokeRect(-o.mapPosition.x+a.width*.2,-o.mapPosition.y+a.height*.8,a.width*.6,a.width*.08),i.fillStyle="rgba(200,200,200,0.8)";for(let e=0;e<6;e++)i.fillRect(-o.mapPosition.x+a.width*(.2+.1*e+.025),-o.mapPosition.y+a.height*(.8+.03),a.width*.05,a.width*.05),o.weaponArray[e]&&i.drawImage(o.weaponArray[e].gunImage,-o.mapPosition.x+a.width*(.2+.1*e+.025),-o.mapPosition.y+a.height*(.8+.03),a.width*.05,a.width*.05)}function bi(){p.ingame=!1,clearInterval(r.abilityInterval),S&&clearInterval(S.attackInterval),o.weaponArray.forEach(i=>{i&&(clearInterval(i.fireInterval),i.detectedEnemy=!1,i.trackingEnemyObj=null)}),o.weaponArray=[],p.wave=1,A.forEach(i=>{i&&clearInterval(i.attackInterval)}),it()}function le(i){i.drawImage($i,g.displayPosition.x,g.displayPosition.y,window.innerWidth*g.mapSizeMultiplier,window.innerHeight*g.mapSizeMultiplier),ee.draw(i),A.forEach(h=>{h.isSpwaned?h.draw(i):h.spwan(i)}),S&&(S.draw(i),o.weaponArray.forEach(h=>{h&&h.detectEnemy(S)}),S.healthpoint<=0&&(ai(),bi(),mi(i))),r.draw(i),o.dropdownInterval&&J(i,`wave : ${p.wave}`);const n=i.createRadialGradient(r.position.x+r.width/2,r.position.y+r.height/2,r.width,r.position.x+r.width/2,r.position.y+r.height/2,1e3);r.healthpoint>30?(n.addColorStop(0,"rgba(10,10,10,0)"),n.addColorStop(1,"rgba(0,0,0,0.99)")):(n.addColorStop(0,"rgba(10,10,10,0)"),n.addColorStop(1,"rgba(200,0,0,0.99)")),i.fillStyle=n,i.fillRect(-o.mapPosition.x,-o.mapPosition.y,a.width,a.height),j(i,new t(a.width*.05-o.mapPosition.x,a.height*.1-o.mapPosition.y),r.healthpoint,o.heroTotalHealth,a.width*.45,a.height*.03,"Life line");const e=`Gems: ${r.gemCount}`;J(i,e,new t(-a.width*.4-o.mapPosition.x,a.height/5-o.mapPosition.y),"1rem Eater"),j(i,new t(a.width*.95-a.width*.4-o.mapPosition.x,a.height*.1-o.mapPosition.y),r.essenceCount,f.maxEssence,a.width*.4,a.height*.03,"Essence");const s=`${Math.floor((o.waveIntervalTime-Ei())/1e3)}`;J(i,`${s}`,new t(-(i.measureText(s).width/2+o.mapPosition.x),a.height/5-o.mapPosition.y),"0.1rem"),Ei()>=o.waveIntervalTime&&r.healthpoint>0&&(p.wave++,o.weaponArray.forEach(h=>{clearInterval(h==null?void 0:h.fireInterval)}),Zt(i)),r.healthpoint<=0&&(ai(),bi(),mi(i)),Y.forEach(h=>{h.draw(i)}),G.forEach(h=>{h.draw(i)}),N.forEach(h=>{h.draw(i)}),o.weaponArray.forEach((h,l)=>{h&&(h.draw(i),h.position=r.weaponPositions[l])}),ae(i)}function tt(i){i==null||i.clearRect(-o.mapPosition.x,-o.mapPosition.y,a.width,a.height),Pe(),le(i),oe(),se(),ne(),A.forEach(n=>{o.weaponArray.forEach(e=>{e&&e.detectEnemy(n)})}),p.ingame&&requestAnimationFrame(()=>{tt(i)})}function ai(){o.windSound.pause(),o.windSound.currentTime=0,A.forEach(i=>{clearInterval(i.attackInterval)}),S&&(clearInterval(S.attackInterval),clearInterval(S.spitInterval)),r.healthpoint=o.heroTotalHealth,Y=[],A=[],G=[],N=[],clearInterval(hi),hi=null,_i=new Date,o.weaponArray[0]||(o.weaponArray[0]=new si(r.weaponPositions[0],!1,m.pistol.damage,m.pistol.width,m.pistol.height,m.pistol.fireRate,m.pistol.cost,m.pistol.image,"pistol")),o.weaponArray.forEach((i,n)=>{i&&(clearInterval(i.fireInterval),i.trackingEnemyObj=null,i.detectedEnemy=!1,i.position=r.weaponPositions[n])})}function et(i){p.ingame=!0,r||it(),ai(),he(),o.dropdownInterval=!0,setTimeout(()=>{o.dropdownInterval=!1},5e3),o.dropdownInterval&&J(i,`wave : ${p.wave}`),p.wave>=5&&(S=new te(new t(P(g.tileSize+g.displayPosition.x,window.innerWidth*5-g.tileSize),P(g.tileSize+g.displayPosition.y,window.innerHeight*5-g.tileSize*2)),"red",!0,d.boss.healthPoint,d.boss.width,d.boss.height,d.boss.damage,d.boss.attackRate,d.boss.image,2,d.boss.velocity),S.changeSpeed()),p.ismute||(o.windSound&&(o.windSound.pause(),o.windSound.currentTime=0),o.windSound.play()),tt(i)}const nt=new Image;nt.src=$;let li,ri,wi,pi,gi,di,Di=0;function ii(i,n,e){i=new t(i.x+o.mapPosition.x,i.y+o.mapPosition.y);const s=e.width,h=e.actualBoundingBoxAscent+e.actualBoundingBoxDescent;return i.x>n.x&&i.x<n.x+s&&i.y>n.y-h&&i.y<n.y}function re(i,n){i=new t(-o.mapPosition.x+i.x,-o.mapPosition.y+i.y),ri&&ii(i,li,ri)&&(p.homeScreenFlag=!1,o.homeSound.pause(),et(n)),di&&ii(i,gi,di)&&(p.homeScreenFlag=!1,Dt(n)),pi&&ii(i,wi,pi)&&(p.homeScreenFlag=!1,mi(n))}function we(i){const n=Math.floor(Di/8)%L[1].length;i.drawImage(d.type3.image,L[1][n].position.x,L[1][n].position.y,L[1][n].width,L[1][n].height,a.width*.9-24,o.mapPosition.y,L[1][n].width*a.width*.001,L[1][n].height*a.width*.001),Di++}function pe(i){i.clearRect(-o.mapPosition.x,-o.mapPosition.y,a.width,a.height),i.drawImage(nt,-o.mapPosition.x,-o.mapPosition.y,a.width,a.height),i.fillStyle="rgba(40,40,40,0.1)",i.fillRect(-o.mapPosition.x,-o.mapPosition.y,a.width,a.height),li=new t(-o.mapPosition.x+a.width*.01,-o.mapPosition.y+a.height*.4),gi=new t(-o.mapPosition.x+a.width*.01,-o.mapPosition.y+a.height*.5),wi=new t(-o.mapPosition.x+a.width*.01,-o.mapPosition.y+a.height*.6);const n="DUNGEON DREAD";i.font="3rem ShadowOfTheDeadOver",i.fillStyle="white";const e=i.measureText(n);i.fillText(n,-o.mapPosition.x+a.width*.01,-o.mapPosition.y+a.height*.01+e.actualBoundingBoxAscent+e.actualBoundingBoxDescent),ri=z(i,"PLAY",li),pi=z(i,"ABOUT",wi),di=z(i,"CONTROLS",gi),we(i)}function ot(i){i.clearRect(0,0,a.width,a.height),pe(i),p.homeScreenFlag&&requestAnimationFrame(()=>{ot(i)})}function Si(i){p.homeScreenFlag=!0,p.ismute||(o.homeSound&&(o.homeSound.pause(),o.homeSound.currentTime=0),o.homeSound.play()),ot(i)}const st=new Image;st.src=$;const ge=`
    The world in Dungeon Dread has multiple dungeons 
    where zombies/monsters exist. The dungeon boss controls them. 
    Our main character is a zombie/monster hunter. 
    Initially, our character is equipped with 
    a weaker weapon. As he kills zombies and collects 
    rewards, the character can buy weapons at the end 
    of the wave. The boss appears at the final wave. 
    The game's objective is to survive each wave and defeat 
    the boss. Boss is much stronger than a regular monster/zombie. Stronger in the sense 
    of higher damage and higher health. After defeating the boss, 
    the dungeon's remaining monsters/zombies disappear and the dungeon 
    is free of monsters/zombies.`;let ci,ht;function de(i,n,e){const s=e.width,h=e.actualBoundingBoxAscent+e.actualBoundingBoxDescent;return i.x>n.x&&i.x<n.x+s&&i.y>n.y-h&&i.y<n.y}function ce(i,n){de(i,ci,ht)&&(p.aboutScreenFlag=!1,Si(n))}function me(i){i.drawImage(st,0,0,a.width,a.height),i.fillStyle="rgba(40,40,40,0.8)",i.fillRect(a.width*.1,a.height*.1,a.width*.8,a.height*.8),i.fillStyle="white",i.font="2rem ShadowOfTheDeadOver",i.fillText("About",a.width*.1,a.height*.1),Pt(i,ge,a.width*.8,new t(a.width*.1,a.height*.3),"1rem GloriaHallelujah"),ci=new t(a.width*.1,a.height*.8),ht=z(i,"<-- return Home",ci,"1rem ShadowOfTheDeadOver")}function at(i){i.clearRect(0,0,a.width,a.height),me(i),requestAnimationFrame(()=>{at(i)})}function mi(i){p.aboutScreenFlag=!0,i.translate(-o.mapPosition.x,-o.mapPosition.y),o.mapPosition=new t(0,0),at(i)}const lt=new Image;lt.src=$;let yi,fi;function ye(i,n,e){i=new t(i.x+o.mapPosition.x,i.y+o.mapPosition.y);const s=e.width,h=e.actualBoundingBoxAscent+e.actualBoundingBoxDescent;return i.x>n.x&&i.x<n.x+s&&i.y>n.y-h&&i.y<n.y}function fe(i,n){i=new t(-o.mapPosition.x+i.x,-o.mapPosition.y+i.y),fi&&ye(i,yi,fi)&&(p.firstPageFlag=!1,Si(n))}function ue(i){i.clearRect(-o.mapPosition.x,-o.mapPosition.y,a.width,a.height),i.drawImage(lt,-o.mapPosition.x,-o.mapPosition.y,a.width,a.height);const n="DUNGEON DREAD";i.font="3rem ShadowOfTheDeadOver",i.fillStyle="white";const e=i.measureText(n);i.fillText(n,a.width*.5-e.width/2,a.height*.3+e.actualBoundingBoxAscent+e.actualBoundingBoxDescent),i.font="3rem Eater",yi=new t(a.width*.5-i.measureText("ENTER").width/2,-o.mapPosition.y+a.height*.8),fi=z(i,"ENTER",yi)}function rt(i){i.clearRect(0,0,a.width,a.height),ue(i),p.homeScreenFlag&&requestAnimationFrame(()=>{rt(i)})}function Ae(i){p.firstPageFlag=!0,o.homeSound&&(o.homeSound.pause(),o.homeSound.currentTime=0),rt(i)}function Se(){p.ismute?(o.windSound.pause(),o.windSound.currentTime=0):(p.homeScreenFlag&&o.homeSound.play(),p.ingame&&o.windSound.play())}function Pe(){p.btnPressed.a&&p.btnPressed.w||p.btnPressed.a&&p.btnPressed.s||p.btnPressed.d&&p.btnPressed.w||p.btnPressed.d&&p.btnPressed.s?(r.velocity.x=.7*f.velocity.x,r.velocity.y=.7*f.velocity.y):(r.velocity.x=f.velocity.x,r.velocity.y=f.velocity.y),p.btnPressed.a&&(r.isMoving=!0,r.moveLeft(!0,R)),p.btnPressed.d&&(r.isMoving=!0,r.moveLeft(!1,R)),p.btnPressed.w&&(r.moveUp(!0,R),r.isMoving=!0),p.btnPressed.s&&(r.moveUp(!1,R),r.isMoving=!0),p.btnPressed[" "]&&r.ability()}function ve(){window.addEventListener("keydown",i=>{p.btnPressed[i.key.toLowerCase()]=!0,p.buyScreenFlag&&p.btnPressed.u&&(console.log("here"),Kt()),i.key.toLowerCase()==="m"&&(p.ismute=!p.ismute,Se())}),window.addEventListener("keyup",i=>{p.btnPressed[i.key.toLowerCase()]=!1,r.isMoving=!1}),window.addEventListener("click",i=>{p.firstPageFlag&&fe(new t(i.offsetX,i.offsetY),R),p.homeScreenFlag&&re(new t(i.offsetX,i.offsetY),R),p.buyScreenFlag&&Nt(new t(i.offsetX,i.offsetY)),p.aboutScreenFlag&&ce(new t(i.offsetX,i.offsetY),R),p.controlScreenFlag&&Et(new t(i.offsetX,i.offsetY),R)})}const a=document.getElementById("canvas"),R=a.getContext("2d");ve();a&&(a.width=window.innerWidth,a.height=window.innerHeight,a.style.background="linear-gradient(172.33deg, #30303A -1.75%, #20202E 83.53%, #050519 104.9%)",Ae(R));
