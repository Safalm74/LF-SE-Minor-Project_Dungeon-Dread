var Ii=Object.defineProperty;var ki=(t,n,o)=>n in t?Ii(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o;var d=(t,n,o)=>ki(t,typeof n!="symbol"?n+"":n,o);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const w of l.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&s(w)}).observe(document,{childList:!0,subtree:!0});function o(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(a){if(a.ep)return;a.ep=!0;const l=o(a);fetch(a.href,l)}})();class i{constructor(n,o){d(this,"x");d(this,"y");this.x=n,this.y=o}distanceBetween(n){return Math.sqrt((this.x-n.x)**2+(this.y-n.y)**2)}angle(n){const o=this.x-n.x,s=this.y-n.y;return Math.atan(s/o)}add(n){return new i(this.x+n.x,this.y+n.y)}pointDifference(n){return new i(this.x-n.x,this.y-n.y)}}const bi="/LF-SE-Minor-Project_Dungeon-Dread/assets/hero-bHENNDIt.png",p={ingame:!1,aboutScreenFlag:!1,controlScreenFlag:!1,homeScreenFlag:!1,btnPressed:{},wave:1,buyScreenFlag:!1,ismute:!1,firstPageFlag:!1,assetsLoaded:0,loadingScreen:!1,infoScreenFlag:!1};function f(){p.assetsLoaded++}const M={positionRight:[{width:55,height:96,position:new i(5,0)},{width:86,height:88,position:new i(4,122)},{width:85,height:88,position:new i(104,123)},{width:84,height:90,position:new i(201,121)},{width:85,height:89,position:new i(302,122)},{width:84,height:88,position:new i(400,123)},{width:84,height:90,position:new i(500,121)}],positionLeft:[{width:55,height:96,position:new i(533,219)},{width:86,height:88,position:new i(503,341)},{width:85,height:88,position:new i(404,342)},{width:84,height:90,position:new i(308,340)},{width:85,height:89,position:new i(206,341)},{width:84,height:88,position:new i(109,342)},{width:84,height:90,position:new i(9,340)}]},oi="/LF-SE-Minor-Project_Dungeon-Dread/assets/amaterasu-BhcJas4O.mp3",Ei="/LF-SE-Minor-Project_Dungeon-Dread/assets/amaterasu-Bq5RU4UD.png",xi="/LF-SE-Minor-Project_Dungeon-Dread/assets/sharingan-CjDJlJ4A.png",Et=new Image,xt=new Image,Tt=new Image;xt.src=Ei;Et.src=xi;Tt.src=bi;const si=new Audio(oi),ai=new Audio(oi);ai.onload=f;xt.onload=f;Tt.onload=f;si.onload=f;Et.onload=f;const u={heroTotalHealth:200,width:M.positionLeft[0].width*window.innerHeight/1400,height:M.positionLeft[0].height*window.innerHeight/1400,velocity:new i(5,5),abilityDamage:.1,abilityRate:10,abilityDurability:10*1e3,maxEssence:50,amaterasuSound:ai,heavyBreath:si,stamina:10,image:Tt,amatherasuImage:xt,sharingan:Et},Ti="/LF-SE-Minor-Project_Dungeon-Dread/assets/stoneandDrum-BzVPJaqp.svg",Di="/LF-SE-Minor-Project_Dungeon-Dread/assets/bush-fjx7lCik.png",Ai="/LF-SE-Minor-Project_Dungeon-Dread/assets/map-BCq2fiXg.png",Dt=new Image,At=new Image,Rt=new Image;Dt.src=Ai;At.src=Di;Rt.src=Ti;Dt.onload=f;At.onload=f;Rt.onload=f;let Ri=[];const Ot=50,Oi=Math.floor(window.innerWidth*10/Ot),Li=Math.floor(window.innerHeight*10/Ot),Mi="#radial-gradient(#a9c0a6,#000)",m={tileSize:Ot,mapWidth:Oi,mapHeight:Li,mapColor:Mi,mapTileArray:Ri,displayPosition:new i(0,0),mapSizeMultiplier:5,bushImage:At,stoneImage:Rt,mapImage:Dt},Fi="/LF-SE-Minor-Project_Dungeon-Dread/assets/homeMusic-CTRQ4BfC.mp3",Hi="/LF-SE-Minor-Project_Dungeon-Dread/assets/wind-1mG3RRHB.mp3",Ci="/LF-SE-Minor-Project_Dungeon-Dread/assets/gem-CYeD5NUz.png",Bi="/LF-SE-Minor-Project_Dungeon-Dread/assets/coinCollect-D0EQSH2R.wav",zi="/LF-SE-Minor-Project_Dungeon-Dread/assets/deny-zoSqCo59.mp3",Lt=new Image;Lt.src=Ci;const Mt=new Audio(Fi),Ft=new Audio(Hi),Ht=new Audio(Bi),Ct=new Audio(zi);Mt.onload=f;Ft.onload=f;Ht.onload=f;Ct.onload=f;Lt.onload=f;Mt.volume=.5;Ft.volume=.5;Ht.volume=.2;Ct.volume=.5;const e={collideableObjs:[],heroTotalHealth:120,waveIntervalTime:90*1e3,buyTime:30*1e3,maxEnemies:100*m.mapSizeMultiplier,mapPosition:new i(0,0),dropdownInterval:null,weaponArray:[null,null,null,null,null,null],homeSound:Mt,windSound:Ft,gemSound:Ht,denySound:Ct,gemImage:Lt},F={bulletSize:2,bulletVelocity:20,pestol:300,pestolFireRate:1,pestolDamage:5},nt={width:115,height:62,position:new i(27,18)},D={drum:{width:738,height:226,position:new i(590,2280)},stone:{width:1663,height:1487,position:new i(577,773)}};class ot{constructor(n,o,s,a){d(this,"position");d(this,"tileType");d(this,"isObstacle");d(this,"tileSize");this.position=n,this.tileType=o,this.isObstacle=s,this.tileSize=a}draw(n){switch(this.tileType){case"bush":n.drawImage(m.bushImage,nt.position.x,nt.position.y,nt.width,nt.height,this.position.x,this.position.y,this.tileSize,this.tileSize);break;case"empty":break;case"stone":n.drawImage(m.stoneImage,D.stone.position.x,D.stone.position.y,D.stone.width,D.stone.height,this.position.x,this.position.y,D.stone.width/30,D.stone.height/30);break;case"drum":n.drawImage(m.stoneImage,D.drum.position.x,D.drum.position.y,D.drum.width,D.drum.height,this.position.x,this.position.y,this.tileSize,this.tileSize);break}}}function T(t,n){const o=Math.ceil(t),s=Math.floor(n);return Math.floor(Math.random()*(s-o+1)+o)}class _i{constructor(n){d(this,"tileSize");d(this,"mapHeight");d(this,"mapWidth");this.tileSize=n,this.mapHeight=Math.floor(window.innerHeight*m.mapSizeMultiplier/n),this.mapWidth=Math.floor(window.innerWidth*m.mapSizeMultiplier/n),this.initialize(),this.collectCollideableobj()}collectCollideableobj(){m.mapTileArray.forEach(n=>{n.forEach(o=>{o.isObstacle&&e.collideableObjs.push(o)})})}initialize(){for(let n=0;n<this.mapHeight;n++){m.mapTileArray[n]=[];for(let o=0;o<this.mapWidth;o++)if(o===0||n===0||n===this.mapHeight-1||o===this.mapWidth-1)m.mapTileArray[n][o]=new ot(new i(o*this.tileSize,n*this.tileSize),"bush",!0,this.tileSize);else{const s=T(1,100);s%2==0&&s<10?s>5?m.mapTileArray[n][o]=new ot(new i(o*this.tileSize,n*this.tileSize),"drum",!0,this.tileSize):m.mapTileArray[n][o]=new ot(new i(o*this.tileSize,n*this.tileSize),"stone",!0,this.tileSize):m.mapTileArray[n][o]=new ot(new i(o*this.tileSize,n*this.tileSize),"empty",!1,this.tileSize)}}}draw(n){m.mapTileArray.forEach(o=>{o.forEach(s=>{s.draw(n)})})}}class tt{constructor(n,o,s,a,l,w,v=0,x=0,b=new Image,O=0,z=new i(5,5)){d(this,"position");d(this,"team");d(this,"lookingLeft");d(this,"healthpoint");d(this,"width");d(this,"height");d(this,"spritePosition",0);d(this,"velocity");d(this,"damage");d(this,"attackRate");d(this,"gruntImage");d(this,"gruntType");this.position=n,this.team=o,this.lookingLeft=s,this.healthpoint=a,this.width=l,this.height=w,this.damage=v,this.attackRate=x,this.gruntImage=b,this.gruntType=O,this.velocity=z}}const X={width:339,height:404,position:[new i(6,13),new i(345,13),new i(684,13),new i(1024,13),new i(1365,13),new i(1706,13),new i(2047,13),new i(2388,13)]};class Gi extends tt{constructor(){super(...arguments);d(this,"isMoving",!1);d(this,"speedLimit",3);d(this,"weaponOffset",10);d(this,"abilityInterval",null);d(this,"abilityDamage",u.abilityDamage);d(this,"abilityDurability",u.abilityDurability);d(this,"abilityRate",u.abilityRate);d(this,"abilityInUse",!1);d(this,"inRangeEnemies",[]);d(this,"abilityTime",new Date);d(this,"stamina",u.stamina);d(this,"staminaInterval");d(this,"healthInterval");d(this,"staminaUse",!1);d(this,"onAttack",!1);d(this,"gemCount",0);d(this,"essenceCount",0);d(this,"weaponPositions",[new i(this.position.x+this.weaponOffset+this.width,this.position.y),new i(this.position.x-this.weaponOffset,this.position.y),new i(this.position.x+this.weaponOffset+this.width,this.position.y+this.height/2),new i(this.position.x-this.weaponOffset,this.position.y+this.height/2),new i(this.position.x+this.weaponOffset+this.width,this.position.y),new i(this.position.x+this.weaponOffset+this.width,this.position.y)])}ability(){!this.abilityInUse&&new Date().getTime()-this.abilityTime.getTime()>15*1e3&&this.essenceCount&&(this.abilityInUse=!0,u.amaterasuSound.currentTime=2,u.amaterasuSound.play(),this.inRangeEnemies=k.filter(o=>{if(o.position.x>-e.mapPosition.x&&o.position.x<-e.mapPosition.x+h.width&&o.position.y>-e.mapPosition.y&&o.position.y<-e.mapPosition.y+h.height)return!0}),y&&this.inRangeEnemies.push(y),setTimeout(()=>{this.inRangeEnemies=[],this.abilityInUse=!1},this.abilityDurability*(this.essenceCount/u.maxEssence)),this.abilityTime=new Date,this.essenceCount=0)}reheal(){this.healthInterval=setInterval(()=>{this.healthpoint<50&&(u.heavyBreath.played||u.heavyBreath.play(),this.healthpoint+=3)},5e3),this.staminaInterval=setInterval(()=>{this.stamina<u.stamina&&(this.stamina+=1),this.staminaUse=!1},2e3)}run(){this.staminaUse=!0,this.stamina>0&&(this.velocity=new i(7,7),this.stamina-=.1)}checkCollision(){let o=!1,s=e.collideableObjs[0];return e.collideableObjs.forEach(a=>{a.position.y+a.tileSize>=this.position.y&&a.position.y<=this.position.y+this.height&&a.position.x+a.tileSize>=this.position.x&&a.position.x+a.tileSize<=this.position.x+a.tileSize+this.width&&(o=!0,s=a)}),{collided:o,collidedObj:s}}updateWeaponPosition(){this.weaponPositions=[new i(this.position.x+this.weaponOffset+this.width,this.position.y),new i(this.position.x-this.weaponOffset,this.position.y),new i(this.position.x+this.weaponOffset+this.width,this.position.y+this.height/2),new i(this.position.x-this.weaponOffset,this.position.y+this.height/2),new i(this.position.x+this.weaponOffset+this.width,this.position.y+this.height),new i(this.position.x-this.weaponOffset,this.position.y+this.height)]}moveLeft(o,s){const a=o?this.velocity.x:-1*this.velocity.x;this.lookingLeft=o;const l=this.checkCollision();if(!l.collided)e.mapPosition.x+=a,s.translate(a,0);else{const w=l.collidedObj.position.y<this.position.y?-1:1,v=l.collidedObj.position.x<this.position.x?-1:1;e.mapPosition.x+=v,e.mapPosition.y+=w,s.translate(v,w)}}moveUp(o,s){const a=o?this.velocity.y:-1*this.velocity.y,l=this.checkCollision();if(!l.collided)e.mapPosition.y+=a,s.translate(0,a);else{const w=l.collidedObj.position.y<this.position.y?-1:1,v=l.collidedObj.position.x<this.position.x?-1:1;e.mapPosition.x+=v,e.mapPosition.y+=w,s.translate(v,w)}}draw(o){this.updateWeaponPosition(),this.position.x=h.width/2-e.mapPosition.x,this.position.y=h.height/2-e.mapPosition.y,this.inRangeEnemies.forEach(a=>{let l=Math.floor(this.spritePosition/5)%X.position.length;o.drawImage(u.amatherasuImage,X.position[l].x,X.position[l].y,X.width,X.height,a.position.x,a.position.y,a.width,a.height),a.healthpoint-=this.abilityDamage});const s=this.lookingLeft?M.positionLeft:M.positionRight;if(this.isMoving){const a=20/this.velocity.x*.9;let l=Math.floor(this.spritePosition/a)%(s.length-1)+1;this.width=M.positionLeft[l].width*window.innerHeight/1200,this.height=M.positionLeft[l].height*window.innerHeight/1200,o.drawImage(u.image,s[l].position.x,s[l].position.y,s[l].width,s[l].height,this.position.x,this.position.y,this.width,this.height)}else this.width=M.positionLeft[0].width*window.innerHeight/1200,this.height=M.positionLeft[0].height*window.innerHeight/1200,o.drawImage(u.image,s[0].position.x,s[0].position.y,s[0].width,s[0].height,this.position.x,this.position.y,this.width,this.height);this.spritePosition++}}const I={width:31,height:17,position:[new i(76,17),new i(224,17),new i(410,17),new i(576,17),new i(742,17),new i(76,118),new i(224,118),new i(410,118),new i(576,118),new i(742,118),new i(48,217)]},vt={width:24,height:34,positionLeft:[new i(10,3),new i(118,3),new i(226,3),new i(335,3),new i(443,3),new i(6,114),new i(443,3),new i(335,3),new i(226,3),new i(118,3)],positionRight:[new i(479,2),new i(587,2),new i(696,3),new i(804,5),new i(914,5),new i(482,112),new i(914,5),new i(804,5),new i(696,3),new i(587,2)]},j={width:34,height:30,positionRight:[new i(84,542),new i(121,541),new i(158,542),new i(195,541)],positionLeft:[new i(343,541),new i(308,542),new i(269,541),new i(232,542)]},qi="/LF-SE-Minor-Project_Dungeon-Dread/assets/type_3_4_-0Cq7KuU3.png",Ni="/LF-SE-Minor-Project_Dungeon-Dread/assets/type1-CCCx1Bt1.png",Vi="/LF-SE-Minor-Project_Dungeon-Dread/assets/type2-BH0ylXV7.png",$i="/LF-SE-Minor-Project_Dungeon-Dread/assets/bossLeft-CV5mu1oo.png",Ui="/LF-SE-Minor-Project_Dungeon-Dread/assets/bossRight-CcEZmngP.png",Yi="/LF-SE-Minor-Project_Dungeon-Dread/assets/spwan-6_Ug9n4C.png",Bt=new Image,zt=new Image,Q=new Image,_t=new Image,Gt=new Image,qt=new Image;Bt.src=Yi;zt.src=Ni;Q.src=qi;_t.src=Vi;qt.src=$i;Gt.src=Ui;zt.onload=f;Q.onload=f;_t.onload=f;qt.onload=f;Bt.onload=f;Gt.onload=f;const c={type1:{healthPoint:10,width:vt.width*window.innerHeight/700,height:vt.height*window.innerHeight/700,image:zt,attackRate:2,damage:2,velocity:new i(1,1)},type2:{healthPoint:20,width:window.innerHeight/1500,height:window.innerHeight/1500,image:_t,attackRate:2,damage:2,velocity:new i(1,1)},type3:{healthPoint:15,width:j.width*window.innerHeight/700,height:j.height*window.innerHeight/700,image:Q,attackRate:3,damage:6,velocity:new i(3,3)},type4:{healthPoint:28,width:window.innerHeight/500,height:window.innerHeight/500,image:Q,attackRate:1,damage:3,velocity:new i(1,1)},boss:{healthPoint:800,width:window.innerHeight/500,height:window.innerHeight/500,image:Q,attackRate:1,damage:30,velocity:new i(1,1),velocityFast:new i(4,4),imageLeft:qt,imageRight:Gt},spwanImage:Bt};class jt extends tt{constructor(){super(...arguments);d(this,"isSpwaned",!1);d(this,"attackInterval",null)}checkCollision(){let o=!1,s=!1,a=e.collideableObjs[0];return e.collideableObjs.forEach(l=>{l.position.y+l.tileSize>=this.position.y&&l.position.y<=this.position.y+this.height&&l.position.x+l.tileSize>=this.position.x&&l.position.x+l.tileSize<=this.position.x+l.tileSize+this.width&&(o=!0,a=l)}),r.position.y+r.height/2>=this.position.y&&r.position.y<=this.position.y+this.height&&r.position.x+r.width>=this.position.x&&r.position.x+r.width<=this.position.x+r.width+this.width?(s=!0,a=r,this.attackInterval||(this.attackInterval=setInterval(()=>{r.healthpoint>0&&(r.onAttack=!0,r.healthpoint-=this.damage)},1e3/this.attackRate))):(clearInterval(this.attackInterval),this.attackInterval=null,r.onAttack=!1),{collided:o,collidedObj:a,collidedHero:s}}update(){const o=this.checkCollision();this.lookingLeft=this.position.x>r.position.x;const s=Math.sqrt((this.position.x-r.position.x)**2+(this.position.y-r.position.y)**2);s>50&&(clearInterval(this.attackInterval),this.attackInterval=null);const a=new i((this.position.x-r.position.x)/s,(this.position.y-r.position.y)/s),l=Math.sqrt(this.velocity.x*this.velocity.x+this.velocity.y*this.velocity.y),w=new i(-a.x*l,-a.y*l);if(!o.collidedHero&&!o.collided&&(this.position.x+=w.x,this.position.y+=w.y),o.collided){const v=o.collidedObj.position.x<this.position.x?1:-1,x=o.collidedObj.position.y<this.position.y?1:-1;this.position.x+=v,this.position.y+=x}}draw(o){if(this.isSpwaned){let s;switch(this.gruntType){case 1:s=vt;break;case 3:s=j;break}const a=this.lookingLeft?s.positionLeft:s.positionRight;this.update();let w=Math.floor(this.spritePosition/5)%s.positionLeft.length;o.drawImage(this.gruntImage,a[w].x,a[w].y,j.width,j.height,this.position.x,this.position.y,this.width,this.height),this.spritePosition++}}spwan(o){let a=Math.floor(this.spritePosition/10)%I.position.length;o.drawImage(c.spwanImage,I.position[a].x,I.position[a].y,I.width,I.height,this.position.x,this.position.y,this.width,this.height),this.spritePosition++,a>=9&&(this.isSpwaned=!0,this.spritePosition=0)}}const A={width:45,height:55,positionRight:[new i(93,226),new i(142,230),new i(189,235),new i(229,231)],positionLeft:[new i(278,235),new i(326,231),new i(372,225),new i(414,230)],attackLeft:[{width:34,height:58,position:new i(173,283)},{width:64,height:41,position:new i(208,300)},{width:53,height:42,position:new i(273,305)}],attackRight:[{width:33,height:58,position:new i(20,283)},{width:64,height:41,position:new i(54,300)},{width:53,height:41,position:new i(119,306)}]};class Xi extends tt{constructor(){super(...arguments);d(this,"isSpwaned",!1);d(this,"attackInterval",null);d(this,"isAttacking",!1)}checkCollision(){let o=!1,s=!1,a=e.collideableObjs[0];return e.collideableObjs.forEach(l=>{l.position.y+l.tileSize>=this.position.y&&l.position.y<=this.position.y+this.height&&l.position.x+l.tileSize>=this.position.x&&l.position.x+l.tileSize<=this.position.x+l.tileSize+this.width&&(o=!0,a=l)}),r.position.y+r.height/2>=this.position.y&&r.position.y<=this.position.y+this.height&&r.position.x+r.width>=this.position.x&&r.position.x+r.width<=this.position.x+r.width+this.width&&(s=!0,a=r),{collided:o,collidedObj:a,collidedHero:s}}update(){const o=this.checkCollision();this.lookingLeft=this.position.x>r.position.x;const s=Math.sqrt((this.position.x-r.position.x)**2+(this.position.y-r.position.y)**2);s>50&&(clearInterval(this.attackInterval),this.attackInterval=null,r.onAttack=!1);const a=new i((this.position.x-r.position.x)/s,(this.position.y-r.position.y)/s),l=Math.sqrt(2);if(this.velocity=new i(-a.x*l,-a.y*l),o.collidedHero?this.isAttacking=!0:(this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.isAttacking=!1,r.onAttack=!1),!o.collided)this.position.x+=this.velocity.x,this.position.y+=this.velocity.y;else{const w=o.collidedObj.position.x<this.position.x?1:-1,v=o.collidedObj.position.y<this.position.y?1:-1;this.position.x+=w,this.position.y+=v}}draw(o){if(this.update(),this.isAttacking){const s=this.lookingLeft?A.attackLeft:A.attackRight,a=10,l=Math.floor(this.spritePosition/a)%A.attackLeft.length;this.height=s[l].height,this.width=s[l].width,l===2&&this.spritePosition%a===0&&(r.healthpoint-=this.damage,r.onAttack=!0),o.drawImage(c.type3.image,s[l].position.x,s[l].position.y,s[l].width,s[l].height,this.position.x,this.position.y,this.width,this.height)}else{const s=this.lookingLeft?A.positionLeft:A.positionRight,l=Math.floor(this.spritePosition/8)%A.positionLeft.length;this.width=A.width,this.height=A.height,o.drawImage(c.type3.image,s[l].x,s[l].y,A.width,A.height,this.position.x,this.position.y,this.width,this.height)}this.spritePosition++}spwan(o){const a=Math.floor(this.spritePosition/10)%I.position.length;o.drawImage(c.spwanImage,I.position[a].x,I.position[a].y,I.width,I.height,this.position.x,this.position.y,this.width,this.height),this.spritePosition++,a>=9&&(this.isSpwaned=!0,this.spritePosition=0)}}class hi{constructor(n,o,s,a){d(this,"position");d(this,"damage");d(this,"isHit",!1);d(this,"velocity");d(this,"gunPosition");d(this,"radius",window.innerWidth/100);this.position=n,this.damage=o,this.velocity=s,this.gunPosition=a}checkOnhit(){this.position.x-this.radius>r.position.x&&this.position.x+this.radius<r.position.x+r.width&&this.position.y-this.radius>r.position.y&&this.position.y+this.radius<r.position.y+r.height&&(this.isHit=!0,r.healthpoint-=this.damage)}update(){this.position.x+=this.velocity.x,this.position.y+=this.velocity.y}draw(n){this.update(),n.beginPath(),n.fillStyle="green",n.arc(this.position.x,this.position.y,this.radius,0,Math.PI*2),n.fill()}}const Ji={position:[{width:137,height:79,position:new i(12,28)},{width:144,height:78,position:new i(168,28)},{width:147,height:77,position:new i(326,29)},{width:144,height:76,position:new i(488,28)},{width:127,height:80,position:new i(659,27)},{width:111,height:83,position:new i(27,168)},{width:127,height:80,position:new i(179,167)}]};class ji extends tt{constructor(){super(...arguments);d(this,"isSpwaned",!1);d(this,"attackInterval",null);d(this,"attackRadius",400);d(this,"spitRange",200)}update(){const o=Math.sqrt((this.position.x-r.position.x)**2+(this.position.y-r.position.y)**2),s=new i((this.position.x-r.position.x)/o,(this.position.y-r.position.y)/o),a=Math.sqrt(this.velocity.x*this.velocity.x+this.velocity.y*this.velocity.y),l=new i(-s.x*a,-s.y*a);o>this.spitRange?(clearInterval(this.attackInterval),this.attackInterval=null,this.position.x+=l.x,this.position.y+=l.y):this.spitHero()}spitHero(){this.attackInterval||(this.attackInterval=setInterval(()=>{if(r){const o=new i(r.position.x,r.position.y),s=this.position.pointDifference(o),a=this.position.distanceBetween(o),l=new i(s.x/a,s.y/a),w=new hi(new i(this.position.x+this.width/2,this.position.y+this.width/2),this.damage,new i(-l.x*F.bulletVelocity*.3,-l.y*F.bulletVelocity*.3),this.position);Y.push(w)}},1e3/this.attackRate))}draw(o){const s=Ji;this.update();let l=Math.floor(this.spritePosition/5)%s.position.length;this.width=s.position[l].width,this.height=s.position[l].height,o.drawImage(this.gruntImage,s.position[l].position.x,s.position[l].position.y,s.position[l].width,s.position[l].height,this.position.x,this.position.y,s.position[l].width*c.type2.width,s.position[l].height*c.type2.height),this.spritePosition++}spwan(o){let a=Math.floor(this.spritePosition/10)%I.position.length;o.drawImage(c.spwanImage,I.position[a].x,I.position[a].y,I.width,I.height,this.position.x,this.position.y,this.width,this.height),this.spritePosition++,a>=9&&(this.isSpwaned=!0,this.spritePosition=0)}}const S={1:[{width:80,height:80,position:new i(91,7)},{width:77,height:80,position:new i(172,7)},{width:57,height:80,position:new i(262,7)},{width:40,height:80,position:new i(351,7)},{width:57,height:80,position:new i(422,7)},{width:77,height:80,position:new i(492,7)}]};class Qi{constructor(n,o,s,a){d(this,"position");d(this,"value");d(this,"spritePostion",0);d(this,"width");d(this,"height");this.position=n,this.value=o,this.width=s,this.height=a}draw(n){const s=Math.floor(this.spritePostion/5)%S[1].length;n.drawImage(e.gemImage,S[1][s].position.x,S[1][s].position.y,S[1][s].width,S[1][s].height,this.position.x,this.position.y,S[1][s].width*.3,S[1][s].height*.3),this.spritePostion++}collected(){return r.position.y+r.height+20>=this.position.y&&r.position.y-20<=this.position.y+this.height&&r.position.x+r.width+20>=this.position.x&&r.position.x-20<=this.position.x+this.width?(p.ismute||(e.gemSound&&(e.gemSound.pause(),e.gemSound.currentTime=0),e.gemSound.play()),r.gemCount+=this.value,r.essenceCount<u.maxEssence&&(r.essenceCount+=1),!1):!0}}function G(t,n,o,s,a,l,w="",v="2rem ShadowOfTheDead",x="#4caf50"){t.font=v,t.fillStyle=x,t.fillText(w,n.x,n.y-l/5);const b=Math.floor(o/s*a);t.strokeStyle="black",t.strokeRect(n.x,n.y,a,l),t.fillStyle="rgba(200,200,200,0.5)",t.fillRect(n.x,n.y,a,l),t.fillStyle="rgba(76, 175, 80,0.5)",t.fillRect(n.x,n.y,b,l)}const _={width:226,height:148,positionLeft:[new i(1,21),new i(234,21),new i(456,21),new i(700,21),new i(936,21),new i(1169,21),new i(1396,21),new i(1622,21),new i(1850,21),new i(2077,21),new i(2304,21),new i(2531,21),new i(2758,21),new i(2985,21),new i(3212,21),new i(3439,21),new i(3665,21),new i(3892,21),new i(4119,21),new i(4346,21),new i(4572,21),new i(4800,21),new i(5027,21),new i(5253,21),new i(5481,21),new i(5708,21),new i(5936,21),new i(6163,21),new i(6391,21),new i(6619,21),new i(6846,21),new i(7074,21),new i(7301,21),new i(7529,21),new i(7983,21),new i(8210,21),new i(8437,21),new i(8665,21)],positionRight:[new i(1,21),new i(229,21),new i(458,21),new i(686,21),new i(914,21),new i(1143,21),new i(1370,21),new i(1598,21),new i(1827,21),new i(2056,21),new i(2284,21),new i(2512,21),new i(2740,21),new i(2968,21),new i(3195,21),new i(3422,21),new i(3651,21),new i(3878,21),new i(4107,21),new i(4334,21),new i(4562,21),new i(4790,21),new i(5018,21),new i(5246,21),new i(5475,21),new i(5703,21),new i(5932,21),new i(6160,21),new i(6388,21),new i(6616,21),new i(6843,21),new i(7071,21),new i(7300,21),new i(7755,21),new i(7982,21),new i(8209,21),new i(8437,21),new i(8665,21)]};class Ki extends tt{constructor(){super(...arguments);d(this,"speedToggle",!1);d(this,"attackInterval",null);d(this,"spitInterval",null)}changeSpeed(){this.spitTohero(),this.spitInterval=setInterval(()=>{this.velocity=this.speedToggle?c.boss.velocity:c.boss.velocityFast,this.speedToggle=!this.speedToggle},5e3)}checkCollision(){return r.position.y+r.height/2>=this.position.y&&r.position.y<=this.position.y+this.height&&r.position.x+r.width>=this.position.x&&r.position.x+r.width<=this.position.x+r.width+this.width}update(){this.checkCollision()?this.attackInterval||(this.attackInterval=setInterval(()=>{r.healthpoint>0&&(r.healthpoint-=this.damage)},1e3/this.attackRate)):(this.moveTowardsHero(),clearInterval(this.attackInterval),this.attackInterval=null)}spitTohero(){this.spitInterval||(this.spitInterval=setInterval(()=>{if(r){const o=new i(r.position.x,r.position.y),s=this.position.pointDifference(o),a=this.position.distanceBetween(o),l=new i(s.x/a,s.y/a),w=new hi(new i(this.position.x+this.width/2,this.position.y+this.width/2),this.damage,new i(-l.x*F.bulletVelocity*.3,-l.y*F.bulletVelocity*.3),this.position);Y.push(w)}},1e3/this.attackRate))}moveTowardsHero(){const o=this.position.pointDifference(r.position),s=this.position.distanceBetween(r.position),a=new i(-(o.x/s)*this.velocity.x,-(o.y/s)*this.velocity.y);this.position.x+=a.x,this.position.y+=a.y}draw(o){this.update(),this.lookingLeft=r.position.x<this.position.x+this.width/2;const s=this.lookingLeft?_.positionLeft:_.positionRight,a=this.lookingLeft?c.boss.imageLeft:c.boss.imageRight;let w=Math.floor(this.spritePosition/5)%s.length;this.width=_.width*c.boss.width,this.height=_.height*c.boss.height,o.drawImage(a,s[w].x,s[w].y,_.width,_.height,this.position.x,this.position.y,this.width,this.height),G(o,this.position,this.healthpoint,c.boss.healthPoint,200,5),this.spritePosition++}}const Wi="/LF-SE-Minor-Project_Dungeon-Dread/assets/pestol-2UG2JAP-.svg",Zi="/LF-SE-Minor-Project_Dungeon-Dread/assets/smg-BDN-O0iq.png",te="/LF-SE-Minor-Project_Dungeon-Dread/assets/vandal-BC5dnWgQ.png",ie="/LF-SE-Minor-Project_Dungeon-Dread/assets/hunter-C0NwOVTE.png",ee="/LF-SE-Minor-Project_Dungeon-Dread/assets/pistolSound-BpmxTjxL.mp3",ne="/LF-SE-Minor-Project_Dungeon-Dread/assets/vandalSound-C1wxq2K1.mp3",oe="/LF-SE-Minor-Project_Dungeon-Dread/assets/hunterSound-BmhEE_dh.mp3",se="/LF-SE-Minor-Project_Dungeon-Dread/assets/SMGSound-3Wzeh9yy.mp3",q={width:123,height:57,positionRight:[new i(0,0)],positionLeft:[new i(125,0)]},N={width:127,height:56,positionRight:[new i(0,0)],positionLeft:[new i(149,0)]},B={width:66,height:38,positionRight:[new i(5,31),new i(67,40),new i(19,46)],positionLeft:[new i(90,31),new i(94,40),new i(143,46)]},V={width:101,height:54,positionRight:[new i(0,0)],positionLeft:[new i(127,0)]},Nt=new Image,Vt=new Image,$t=new Image,Ut=new Image;Ut.src=Wi;Nt.src=Zi;$t.src=te;Vt.src=ie;Ut.onload=f;Nt.onload=f;$t.onload=f;Vt.onload=f;const g={pistol:{damage:3,width:B.width*u.width*.01,height:B.height*u.width*.01,image:Ut,fireRate:2,cost:500,soundSrc:ee},smg:{damage:.5,width:V.width*u.width*.01,height:V.height*u.width*.01,image:Nt,fireRate:5,cost:1500,soundSrc:se},vandal:{damage:1,width:q.width*u.width*.01,height:q.height*u.width*.01,image:$t,fireRate:7,cost:2e3,soundSrc:ne},hunter:{damage:5,width:N.width*u.width*.01,height:N.height*u.width*.01,image:Vt,fireRate:7,cost:2500,soundSrc:oe}};function at(t,n,o=new i(-(t.measureText(n).width/2+e.mapPosition.x),h.height/2-e.mapPosition.y),s="5rem ShadowOfTheDeadOver",a="#4caf50"){t.font=s,t.fillStyle=a,t.translate(o.x,o.y),t.fillText(n,h.width/2,0),t.translate(-o.x,-o.y)}const ae="/LF-SE-Minor-Project_Dungeon-Dread/assets/background-fPH3rH_v.webp",he="/LF-SE-Minor-Project_Dungeon-Dread/assets/Controls-CzxVzJrG.png",re="/LF-SE-Minor-Project_Dungeon-Dread/assets/story1-DyVB0wqQ.mp3",le="/LF-SE-Minor-Project_Dungeon-Dread/assets/heroIntroduction-Dad3xrGL.mp3",ut=new Audio(re),yt=new Audio(le);ut.volume=.2;yt.volume=.2;const Yt=new Image,Xt=new Image;Xt.src=he;Yt.src=ae;yt.onload=f;ut.onload=f;Xt.onload=f;Yt.onload=f;ut.onload=f;yt.onload=f;const E={controlImage:Xt,backGroundImage:Yt,story1sound:ut,prevSoundHolder:null,heroIntroductionSound:yt};function $(t,n,o,s="3rem Eater",a="white"){return o||console.log("no position"),t.fillStyle=a,t.font=s,t.fillText(n,o.x,o.y),t.measureText(n)}function de(t,n,o,s,a="1rem Arial",l="white"){t.font=a,t.fillStyle=l;const w=t.measureText("sample"),v=w.actualBoundingBoxAscent+w.actualBoundingBoxDescent,x=n.split(" ").filter(H=>H.trim()!=="");let b="",O=s.y+v;const z=s.x+v;for(let H=0;H<x.length;H++){const it=b+x[H]+" ",ft=t.measureText(it).width;b=it,ft>=o*.9&&(t.fillText(b,z,O),O+=v,b="")}t.fillText(b,z,O)}function R(t,n,o){t=new i(t.x+e.mapPosition.x,t.y+e.mapPosition.y);const s=o.width,a=o.actualBoundingBoxAscent+o.actualBoundingBoxDescent;return t.x>n.x&&t.x<n.x+s&&t.y>n.y-a&&t.y<n.y}let ri,Pt,li;function pe(t,n){R(t,Pt,li)&&(p.infoScreenFlag=!1,E.prevSoundHolder&&(E.prevSoundHolder.pause(),E.prevSoundHolder.currentTime=0),ri(n))}function we(t,n,o,s){t.drawImage(E.backGroundImage,0,0,h.width,h.height),t.fillStyle="rgba(40,40,40,0.8)",t.fillRect(h.width*.1,h.height*.1,h.width*.8,h.height*.8),t.fillStyle="white",t.font="2rem ShadowOfTheDeadOver",t.fillText(n,h.width*.1,h.height*.1),de(t,o,h.width*.8,new i(h.width*.1,h.height*.3),"1.5rem Arial"),Pt=new i(h.width*.1,h.height*.8),li=$(t,s,Pt,"1rem ShadowOfTheDeadOver")}function di(t,n,o,s){t.clearRect(0,0,h.width,h.height),we(t,n,o,s),requestAnimationFrame(()=>{di(t,n,o,s)})}function ge(t,n,o,s,a){ri=a,p.infoScreenFlag=!0,t.translate(-e.mapPosition.x,-e.mapPosition.y),e.mapPosition=new i(0,0),di(t,n,o,s)}const Qt={about:{heading:"About",msg:`The world in Dungeon Dread has multiple dungeons 
            where zombies/monsters exist. The dungeon boss controls them. 
            Our main character is a zombie/monster hunter. 
            Initially, our character is equipped with 
            a weaker weapon. As he kills zombies and collects 
            rewards, the character can buy weapons at the end 
            of the wave. The boss appears at the final wave. 
            The game's objective is to survive each wave and defeat 
            the boss. Boss is much stronger than a regular monster/zombie. Stronger in the sense 
            of higher damage and higher health. After defeating the boss, 
            the dungeon's remaining monsters/zombies disappear and the dungeon 
            is free of monsters/zombies.`},gameOver:{heading:"Game Over",msg:`
        You failed the mission. The villagers were attacked by the monsters`},gameWin:{heading:"You Win",msg:"You defended the village"},story1:{heading:"Attack of Angler Monster",msg:` 
        Once upon a time, there was a peaceful village. But one day suddenly monsters started appearing in 
        the village. The chief was worried about the village. With his research assistant, there was a dungeon
        near the village from where monsters started appearing.so the chief requested the monster hunter to clear
        the dungeon and save the village.`},aboutHero:{heading:"Introduction to hero",msg:`
            Hero is a ninja with supernatural powers.
            He levitates weapons with telepathy power.
            The hero can use Amaterasu from the essence, 
            collected from the monster's dead body. 
            Amaterasu's cooldown is 15s and the max use duration
            of Amaterasu is 10sec depending upon the essence collected.
            Another hero's ability is to regenerate when his health point is 
            lower than 50 hp and regenerates till 50 hp.`}};function K(t,n,o,s,a=null){ge(t,Qt[n].heading,Qt[n].msg,o,s),setTimeout(()=>{a&&!p.ismute&&(E.prevSoundHolder=a,a.play())},800)}function pi(t){var s;t.strokeStyle="white",t.fillStyle="rgba(40,200,40,0.1)",t.fillRect(-e.mapPosition.x+h.width*.2,-e.mapPosition.y+h.height*.8,h.width*.6,h.width*.08),t.strokeRect(-e.mapPosition.x+h.width*.2,-e.mapPosition.y+h.height*.8,h.width*.6,h.width*.08),t.font="1rem Arial";const o=10;for(let a=0;a<6;a++){if(e.weaponArray[a])switch((s=e.weaponArray[a])==null?void 0:s.level){case 1:t.fillStyle="rgba(200,200,200,0.8)";break;case 2:t.fillStyle="rgba(15,10,222,0.8)";break;case 3:t.fillStyle="rgba(255,215,0,0.8)";break}else t.fillStyle="rgba(200,200,200,1)";t.fillRect(-e.mapPosition.x+h.width*(.2+.1*a+.025),-e.mapPosition.y+h.height*(.8+.03),h.width*.05,h.width*.05),e.weaponArray[a]&&(t.drawImage(e.weaponArray[a].gunImage,-e.mapPosition.x+h.width*(.2+.1*a+.025),-e.mapPosition.y+h.height*(.8+.03),h.width*.05,h.width*.05),t.fillStyle="green",t.fillRect(-e.mapPosition.x+h.width*(.2+.1*a+.025),-e.mapPosition.y+h.height*(.8+.03),h.width*.01,h.width*.01),t.fillStyle="white",t.fillText(`${e.weaponArray[a].level}`,-e.mapPosition.x+h.width*(.2+.1*a+.025),-e.mapPosition.y+h.height*(.8+.03)+o))}}const C={1:[{width:5,height:5,position:new i(106,614)},{width:5,height:16,position:new i(114,614)},{width:10,height:30,position:new i(122,614)},{width:5,height:32,position:new i(135,614)},{width:10,height:30,position:new i(143,614)},{width:15,height:3,position:new i(160,614)},{width:19,height:5,position:new i(183,614)},{width:21,height:7,position:new i(207,614)},{width:22,height:9,position:new i(232,614)},{width:23,height:11,position:new i(256,614)},{width:24,height:13,position:new i(281,614)},{width:24,height:15,position:new i(306,614)},{width:24,height:16,position:new i(331,614)}]};let It,wi;function me(t,n){R(t,It,wi)&&(p.aboutScreenFlag=!1,console.log(p),U(n))}function ce(t){t.drawImage(E.backGroundImage,0,0,h.width,h.height),t.fillStyle="rgba(40,40,40,0.8)",t.drawImage(E.controlImage,h.width*.1,h.height*.2,h.width*.5,h.height*.5),t.fillStyle="white",t.font="2rem ShadowOfTheDeadOver",t.fillText("Controls",h.width*.1,h.height*.1),It=new i(h.width*.1,h.height*.8),wi=$(t,"<-- return Home",It,"1rem ShadowOfTheDeadOver")}function gi(t){t.clearRect(0,0,h.width,h.height),ce(t),requestAnimationFrame(()=>{gi(t)})}function ue(t){p.controlScreenFlag=!0,t.translate(-e.mapPosition.x,-e.mapPosition.y),e.mapPosition=new i(0,0),gi(t)}let ht,wt,St,rt,gt,Kt,lt,mt,Wt,Zt=0;function ye(t,n){t=new i(-e.mapPosition.x+t.x,-e.mapPosition.y+t.y),wt&&R(t,ht,wt)&&(p.homeScreenFlag=!1,e.homeSound.pause(),K(n,"story1","Continue =>",()=>{K(n,"aboutHero","Continue =>",bt,E.heroIntroductionSound),bt(n)},E.story1sound)),mt&&R(t,lt,mt)&&(p.homeScreenFlag=!1,ue(n)),gt&&R(t,rt,gt)&&(p.homeScreenFlag=!1,K(n,"about","<=return Home",U))}function fe(t){const n=Math.floor(Zt/8)%C[1].length;t.drawImage(c.type3.image,C[1][n].position.x,C[1][n].position.y,C[1][n].width,C[1][n].height,h.width*.9-24,e.mapPosition.y,C[1][n].width*h.width*.001,C[1][n].height*h.width*.001),Zt++}function Se(t){t.clearRect(-e.mapPosition.x,-e.mapPosition.y,h.width,h.height),t.drawImage(E.backGroundImage,-e.mapPosition.x,-e.mapPosition.y,h.width,h.height),t.fillStyle="rgba(40,40,40,0.1)",t.fillRect(-e.mapPosition.x,-e.mapPosition.y,h.width,h.height),ht=new i(-e.mapPosition.x+h.width*.01,-e.mapPosition.y+h.height*.4),lt=new i(-e.mapPosition.x+h.width*.01,-e.mapPosition.y+h.height*.5),rt=new i(-e.mapPosition.x+h.width*.01,-e.mapPosition.y+h.height*.6);const n="DUNGEON DREAD";t.font="4rem ShadowOfTheDeadOver",t.fillStyle="white";const o=t.measureText(n);t.fillText(n,-e.mapPosition.x+h.width*.01,-e.mapPosition.y+h.height*.01+o.actualBoundingBoxAscent+o.actualBoundingBoxDescent),St="red",window.addEventListener("mousemove",s=>{St=R(new i(s.offsetX,s.offsetY),ht,wt)?"blue":"red"}),wt=$(t,"PLAY",ht,"4rem bold Eater ",St),window.addEventListener("mousemove",s=>{Kt=R(new i(s.offsetX,s.offsetY),rt,gt)?"blue":"white"}),gt=$(t,"ABOUT",rt,"4rem bold Eater ",Kt),window.addEventListener("mousemove",s=>{Wt=R(new i(s.offsetX,s.offsetY),lt,mt)?"blue":"white"}),mt=$(t,"INSTRUCTIONS",lt,"4rem bold Eater ",Wt),fe(t)}function mi(t){t.clearRect(0,0,h.width,h.height),Se(t),p.homeScreenFlag&&requestAnimationFrame(()=>{mi(t)})}function U(t){p.homeScreenFlag=!0,p.controlScreenFlag=!1,p.ismute||(e.homeSound&&(e.homeSound.pause(),e.homeSound.currentTime=0),e.homeSound.play()),mi(t)}let ci,k=[],W=[],Z=[],Y=[],r,y,kt;function ti(){return new Date().getTime()-ci.getTime()}const ve=new _i(m.tileSize);function ui(){r=new Gi(new i(window.innerWidth/2,window.innerHeight/2),"blue",!0,e.heroTotalHealth,u.width,u.height),r.reheal()}function Pe(){Z=Z.filter(t=>t.collected())}function Ie(){k=k.filter(t=>{if(t.healthpoint<0)clearInterval(t.attackInterval),t.attackInterval=null,Z.push(new Qi(t.position,16,S[1][0].width*.2,S[1][0].height*.2));else return!0})}function ke(){W=W.filter(t=>(t.checkOnhit(k,y),!(t.endPoint.x>=window.innerHeight*m.mapSizeMultiplier||t.startPoint.x<=0||t.isHit))),Y=Y.filter(t=>(t.checkOnhit(),!(t.position.x>=window.innerHeight*m.mapSizeMultiplier||t.position.x<=0||t.isHit)))}function be(){kt=setInterval(()=>{if(k.length<e.maxEnemies){const t=T(1,100);p.wave>2&&t<40&&k.push(new ji(new i(T(m.tileSize+m.displayPosition.x,window.innerWidth*5-m.tileSize),T(m.tileSize+m.displayPosition.y,window.innerHeight*5-m.tileSize*2)),"red",!0,c.type2.healthPoint,c.type2.width,c.type2.height,c.type2.damage,c.type2.attackRate,c.type2.image,2,c.type2.velocity)),p.wave>3&&t<50?k.push(new Xi(new i(T(m.tileSize+m.displayPosition.x,window.innerWidth*5-m.tileSize),T(m.tileSize+m.displayPosition.y,window.innerHeight*5-m.tileSize*2)),"red",!0,c.type4.healthPoint,c.type4.width,c.type4.height,c.type4.damage,c.type4.attackRate,c.type4.image,4,c.type4.velocity)):p.wave>1&&t<60?k.push(new jt(new i(T(m.tileSize+m.displayPosition.x,window.innerWidth*5-m.tileSize),T(m.tileSize+m.displayPosition.y,window.innerHeight*5-m.tileSize*2)),"red",!0,c.type3.healthPoint,c.type3.width,c.type3.height,c.type3.damage,c.type3.attackRate,c.type3.image,3,c.type3.velocity)):k.push(new jt(new i(T(m.tileSize+m.displayPosition.x,window.innerWidth*5-m.tileSize),T(m.tileSize+m.displayPosition.y,window.innerHeight*5-m.tileSize*2)),"red",!0,c.type1.healthPoint,c.type1.width,c.type1.height,c.type1.damage,c.type1.attackRate,c.type1.image,1,c.type1.velocity))}},500)}function ii(){p.ingame=!1,clearInterval(r.abilityInterval),r.abilityInterval=null,e.weaponArray=[],p.wave=1,k.forEach(t=>{t&&(clearInterval(t.attackInterval),t.attackInterval=null)}),e.weaponArray.forEach(t=>{t&&(clearInterval(t.fireInterval),t.fireInterval=null,t.detectedEnemy=!1,t.trackingEnemyObj=null)}),y&&(clearInterval(y.attackInterval),y.attackInterval=null,clearInterval(y.spitInterval),y.spitInterval=null),y=null,ui()}function Ee(t){t.drawImage(m.mapImage,m.displayPosition.x,m.displayPosition.y,window.innerWidth*m.mapSizeMultiplier,window.innerHeight*m.mapSizeMultiplier),ve.draw(t),k.forEach(w=>{w.isSpwaned?w.draw(t):w.spwan(t)}),y&&(y.draw(t),e.maxEnemies=50,e.weaponArray.forEach(w=>{y&&w&&w.detectEnemy(y)}),y.healthpoint<=0&&(dt(),ii(),K(t,"gameWin","<= return Home",U))),r.draw(t),e.dropdownInterval&&at(t,`wave : ${p.wave}`);const n=t.createRadialGradient(r.position.x+r.width/2,r.position.y+r.height/2,r.width,r.position.x+r.width/2,r.position.y+r.height/2,1e3);r.healthpoint>30?(n.addColorStop(0,"rgba(10,10,10,0)"),n.addColorStop(1,"rgba(0,0,0,0.99)")):(n.addColorStop(0,"rgba(10,10,10,0)"),n.addColorStop(1,"rgba(200,0,0,0.99)")),t.fillStyle=n,t.fillRect(-e.mapPosition.x,-e.mapPosition.y,h.width,h.height),G(t,new i(h.width*.05-e.mapPosition.x,h.height*.1-e.mapPosition.y),r.healthpoint,e.heroTotalHealth,h.width*.45,h.height*.03,"Life line");const o=`x ${r.gemCount}`;t.drawImage(e.gemImage,S[1][0].position.x,S[1][0].position.y,S[1][0].width,S[1][0].height,h.width*.05-e.mapPosition.x,h.height/5-e.mapPosition.y,S[1][0].width*.3,S[1][0].height*.3),t.font="1rem Eater",t.fillStyle="white";const s=t.measureText(o),a=s.actualBoundingBoxAscent+s.actualBoundingBoxDescent;t.fillText(o,h.width*.05-e.mapPosition.x+S[1][0].width*.5,h.height/5-e.mapPosition.y+a*1.5),t.drawImage(u.sharingan,h.width*.05-e.mapPosition.x,h.height/5-e.mapPosition.y+S[1][0].height*.5,S[1][0].width*.4,S[1][0].height*.4);const l=(new Date().getTime()-r.abilityTime.getTime())/(15*1e3);if(l<1&&!r.abilityInUse?(t.beginPath(),t.fillStyle="rgba(240,240,240,0.6)",t.arc(h.width*.05-e.mapPosition.x+S[1][0].width*.2,h.height/5-e.mapPosition.y+S[1][0].height*.5+S[1][0].height*.2,S[1][0].width*.2,0,2*Math.PI*(1-l)),t.fill()):(t.beginPath(),t.strokeStyle="blue",t.fillStyle="rgba(240,240,240,0.6)",t.arc(h.width*.05-e.mapPosition.x+S[1][0].width*.2,h.height/5-e.mapPosition.y+S[1][0].height*.5+S[1][0].height*.2,S[1][0].width*.2,0,2*Math.PI),t.stroke()),r.staminaUse&&G(t,new i(h.width*.05-e.mapPosition.x,h.height/5-e.mapPosition.y+S[1][0].height*1.5),r.stamina,u.stamina,h.width*.1,h.height*.02,"Stamina","1rem Arial"),r.onAttack&&(t.createRadialGradient(r.position.x+r.width/2,r.position.y+r.height/2,r.width,r.position.x+r.width/2,r.position.y+r.height/2,1e3).addColorStop(0,"rgba(10,10,10,0)"),t.fillStyle=n,t.fillRect(-e.mapPosition.x,-e.mapPosition.y,h.width,h.height)),G(t,new i(h.width*.95-h.width*.4-e.mapPosition.x,h.height*.1-e.mapPosition.y),r.essenceCount,u.maxEssence,h.width*.4,h.height*.03,"Essence"),ti()>=e.waveIntervalTime&&r.healthpoint>0&&!y&&(p.wave++,e.weaponArray.forEach(w=>{w&&(clearInterval(w.fireInterval),w.fireInterval=null)}),dt(),Ae(t)),y)at(t,"Final Wave",new i(-(t.measureText("Final Wave").width/2+e.mapPosition.x),h.height/5-e.mapPosition.y),"0.1rem");else{const w=`${Math.floor((e.waveIntervalTime-ti())/1e3)}`;at(t,`${w}`,new i(-(t.measureText(w).width/2+e.mapPosition.x),h.height/5-e.mapPosition.y),"0.1rem")}r.healthpoint<=0&&(dt(),ii(),K(t,"gameOver","<= return Home",U)),W.forEach(w=>{w.draw(t)}),Y.forEach(w=>{w.draw(t)}),Z.forEach(w=>{w.draw(t)}),e.weaponArray.forEach((w,v)=>{w&&(w.draw(t),w.position=r.weaponPositions[v])}),e.maxEnemies=500,pi(t)}function yi(t){t==null||t.clearRect(-e.mapPosition.x,-e.mapPosition.y,h.width,h.height),Fe(),Ee(t),Ie(),ke(),Pe(),k.forEach(n=>{e.weaponArray.forEach(o=>{o&&o.detectEnemy(n)})}),p.ingame&&requestAnimationFrame(()=>{yi(t)})}function dt(){e.windSound.pause(),e.windSound.currentTime=0,k.forEach(t=>{clearInterval(t.attackInterval),t.attackInterval=null}),y&&(clearInterval(y.attackInterval),clearInterval(y.spitInterval),y.attackInterval=null,y.spitInterval=null),r.healthpoint=e.heroTotalHealth,W=[],k=[],Y=[],Z=[],clearInterval(kt),kt=null,ci=new Date,e.weaponArray[0]||(e.weaponArray[0]=new J(r.weaponPositions[0],!1,g.pistol.damage,g.pistol.width,g.pistol.height,g.pistol.fireRate,g.pistol.cost,g.pistol.image,"pistol",new Audio(g.pistol.soundSrc))),e.weaponArray.forEach((t,n)=>{t&&(clearInterval(t.fireInterval),t.fireInterval=null,t.trackingEnemyObj=null,t.detectedEnemy=!1,t.position=r.weaponPositions[n])})}function bt(t){p.infoScreenFlag||(p.ingame=!0,r||ui(),dt(),be(),e.dropdownInterval=!0,setTimeout(()=>{e.dropdownInterval=!1},5e3),e.dropdownInterval&&at(t,`wave : ${p.wave}`),y&&(clearInterval(y.attackInterval),y.attackInterval=null,clearInterval(y.spitInterval),y.spitInterval=null),y=null,p.wave>=5&&(y=new Ki(new i(T(m.tileSize+m.displayPosition.x,window.innerWidth*5-m.tileSize),T(m.tileSize+m.displayPosition.y,window.innerHeight*5-m.tileSize*2)),"red",!0,c.boss.healthPoint,c.boss.width,c.boss.height,c.boss.damage,c.boss.attackRate,c.boss.image,2,c.boss.velocity),e.maxEnemies=50,y.changeSpeed()),p.ismute||(e.windSound&&(e.windSound.pause(),e.windSound.currentTime=0),e.windSound.play()),e.weaponArray.forEach(n=>{n&&(clearInterval(n.fireInterval),n.fireInterval=null,n.detectedEnemy=!1,n.trackingEnemyObj=null)}),yi(t))}class xe{constructor(n,o,s,a,l){d(this,"startPoint");d(this,"endPoint");d(this,"damage");d(this,"isHit",!1);d(this,"velocity");d(this,"gunPosition");this.startPoint=n,this.endPoint=o,this.damage=s,this.velocity=a,this.gunPosition=l}checkOnhit(n,o=null){n.forEach(s=>{this.endPoint.x>s.position.x&&this.endPoint.x<s.position.x+s.width&&this.endPoint.y>s.position.y&&this.endPoint.y<s.position.y+s.height&&(this.isHit=!0,s.healthpoint-=this.damage)}),o&&this.endPoint.x>o.position.x&&this.endPoint.x<o.position.x+o.width&&this.endPoint.y>o.position.y&&this.endPoint.y<o.position.y+o.height&&(this.isHit=!0,o.healthpoint-=this.damage)}draw(n){this.startPoint=this.startPoint.add(this.velocity),this.endPoint=this.endPoint.add(this.velocity),n.beginPath(),n.strokeStyle="gold",n.moveTo(this.startPoint.x,this.startPoint.y),n.lineTo(this.endPoint.x,this.endPoint.y),n.lineWidth=3,n.stroke()}}class J{constructor(n,o,s,a,l,w=1,v=500,x,b,O){d(this,"position");d(this,"lookingLeft");d(this,"damage");d(this,"width");d(this,"height");d(this,"spritePosition",0);d(this,"fireRate");d(this,"cost");d(this,"gunImage");d(this,"guntype");d(this,"detectedEnemy",!1);d(this,"trackingEnemyObj",null);d(this,"lookingAngle",0);d(this,"shootingPoint",B.positionRight[1]);d(this,"fireInterval",null);d(this,"level",1);d(this,"sound");this.position=n,this.lookingLeft=o,this.damage=s,this.width=a,this.height=l,this.gunImage=x,this.fireRate=w,this.cost=v,this.guntype=b,this.sound=O}playSound(){p.ismute||(this.sound.volume=.2,this.sound&&(this.sound.pause(),this.sound.currentTime=0),this.sound.play())}detectEnemy(n){const o=this.position;o.distanceBetween(n.position)<F.pestol&&!this.detectedEnemy&&(this.detectedEnemy=!0,this.trackingEnemyObj=n),this.detectedEnemy&&this.trackingEnemyObj&&(this.lookingAngle=o.angle(new i(this.trackingEnemyObj.position.x,this.trackingEnemyObj.position.y)),this.shoot(),this.position.distanceBetween(this.trackingEnemyObj.position)>F.pestol&&(this.detectedEnemy=!1,clearInterval(this.fireInterval),this.fireInterval=null)),this.trackingEnemyObj&&this.trackingEnemyObj.healthpoint<0&&(this.detectedEnemy=!1,clearInterval(this.fireInterval),this.fireInterval=null)}shoot(){this.lookingLeft?this.shootingPoint=new i(this.position.x,this.position.y+this.height/4):this.shootingPoint=new i(this.position.x+this.width,this.position.y+this.height/4),this.trackingEnemyObj&&this.position.x>this.trackingEnemyObj.position.x&&(this.shootingPoint.x=this.position.x),this.shootingPoint.x=this.position.x+(this.shootingPoint.x-this.position.x)*Math.cos(this.lookingAngle)-(this.shootingPoint.y-this.position.y)*Math.sin(this.lookingAngle),this.shootingPoint.y=this.position.y+(this.shootingPoint.x-this.position.x)*Math.sin(this.lookingAngle)+(this.shootingPoint.y-this.position.y)*Math.cos(this.lookingAngle),this.fireInterval||(this.fireInterval=setInterval(()=>{if(this.trackingEnemyObj){const n=new i(this.trackingEnemyObj.position.x+this.trackingEnemyObj.width/2,this.trackingEnemyObj.position.y+this.trackingEnemyObj.height/2),o=this.shootingPoint.pointDifference(n),s=this.shootingPoint.distanceBetween(n),a=new i(o.x/s,o.y/s),l=new i(this.shootingPoint.x+a.x*10,this.shootingPoint.y+a.y*10),w=new xe(this.shootingPoint,l,this.damage,new i(-a.x*F.bulletVelocity,-a.y*F.bulletVelocity),this.position);W.push(w),this.playSound()}},1e3/this.fireRate))}draw(n){let o;switch(this.guntype){case"pistol":o=B;break;case"smg":o=V;break;case"vandal":o=q;break;case"hunter":o=N;break}n.translate(this.position.x,this.position.y),n.rotate(this.lookingAngle);let s;this.lookingLeft?(s=o.positionLeft[0],this.shootingPoint=new i(0,this.height/4)):(s=o.positionRight[0],this.shootingPoint=new i(this.width,this.height/4)),this.trackingEnemyObj&&this.position.x>this.trackingEnemyObj.position.x&&(s=s===o.positionLeft[0]?o.positionRight[0]:o.positionLeft[0],this.shootingPoint.x=0),n.fillStyle="red",n.drawImage(this.gunImage,s.x,s.y,o.width,o.height,0,0,this.width,this.height),n.rotate(-this.lookingAngle),n.translate(-this.position.x,-this.position.y)}}let fi,P=0;function ei(){return new Date().getTime()-fi.getTime()}function ni(t,n,o){const s=o.x,a=o.y;return t=new i(t.x-e.mapPosition.x,t.y-e.mapPosition.y),t.x>n.x&&t.x<n.x+s&&t.y>n.y&&t.y<n.y+a}let Te=t=>{for(let a=0;a<6;a++)if(ni(t,new i(-e.mapPosition.x+h.width*(.2+.1*a+.025),-e.mapPosition.y+h.height*.8300000000000001),new i(h.width*.05,h.width*.05))){P=a;break}const n=h.width*.8-e.mapPosition.x,o=h.height*.5-e.mapPosition.y,s=new i(h.width*.1-e.mapPosition.x,h.height*.1-e.mapPosition.y);for(let a=0;a<4;a++)if(ni(t,new i(s.x+n*a/4,s.y),new i(n/4,o))){switch(a){case 0:r.gemCount>=g.pistol.cost?(e.weaponArray[P]=new J(r.weaponPositions[P],!1,g.pistol.damage,g.pistol.width,g.pistol.height,g.pistol.fireRate,g.pistol.cost,g.pistol.image,"pistol",new Audio(g.pistol.soundSrc)),r.gemCount-=g.pistol.cost):(e.denySound&&(e.denySound.pause(),e.denySound.currentTime=0),e.denySound.play());break;case 1:r.gemCount>=g.smg.cost?(e.weaponArray[P]=new J(r.weaponPositions[P],!1,g.smg.damage,g.smg.width,g.smg.height,g.smg.fireRate,g.smg.cost,g.smg.image,"smg",new Audio(g.smg.soundSrc)),r.gemCount-=g.smg.cost):(e.denySound&&(e.denySound.pause(),e.denySound.currentTime=0),e.denySound.play());break;case 2:r.gemCount>=g.vandal.cost?(e.weaponArray[P]=new J(r.weaponPositions[P],!1,g.vandal.damage,g.vandal.width,g.vandal.height,g.vandal.fireRate,g.vandal.cost,g.vandal.image,"vandal",new Audio(g.vandal.soundSrc)),r.gemCount-=g.vandal.cost):(e.denySound&&(e.denySound.pause(),e.denySound.currentTime=0),e.denySound.play());break;case 3:r.gemCount>=g.hunter.cost?(e.weaponArray[P]=new J(r.weaponPositions[P],!1,g.hunter.damage,g.hunter.width,g.hunter.height,g.hunter.fireRate,g.hunter.cost,g.hunter.image,"hunter",new Audio(g.hunter.soundSrc)),r.gemCount-=g.hunter.cost):(e.denySound&&(e.denySound.pause(),e.denySound.currentTime=0),e.denySound.play());break}for(let w=0;w<e.weaponArray.length&&(P=w,!!e.weaponArray[w]);w++);break}};function De(){e.weaponArray[P]&&e.weaponArray[P].level<3&&r.gemCount>=e.weaponArray[P].cost*1.1?(e.weaponArray[P].damage+=e.weaponArray[P].damage*.1,e.weaponArray[P].fireRate+=e.weaponArray[P].fireRate*.1,e.weaponArray[P].level++,r.gemCount-=e.weaponArray[P].cost*.1):(e.denySound&&(e.denySound.pause(),e.denySound.currentTime=0),e.denySound.play())}function st(t,n,o,s,a,l,w,v,x,b,O,z,H,it,ft){t.strokeRect(o.x+s*n/4,o.y,s/4,a),t.fillRect(o.x+s*n/4+s/8-l/2,o.y*1.3,l,l),t.drawImage(w,v.x,v.y,x,b,o.x+s*n/4+s/8-l/2,o.y*1.3,l,l),t.font="2rem Eater",t.fillStyle="white";const Jt=t.measureText("sample"),et=Jt.actualBoundingBoxAscent+Jt.actualBoundingBoxDescent;t.fillText(`Gun: ${O}`,o.x+s*n/4+l/2,o.y*1.3+l+et*4),t.fillText(`Cost: ${z}`,o.x+s*n/4+l/2,o.y*1.3+l+et*5.5),t.fillText(`Damage: ${H}`,o.x+s*n/4+l/2,o.y*1.3+l+et*7),t.fillText(`Fire Rate: ${it}`,o.x+s*n/4+l/2,o.y*1.3+l+et*8.5),ft>r.gemCount&&(t.fillStyle="rgba(200,200,200,0.45)",t.fillRect(o.x+s*n/4,o.y,s/4,a))}function Si(t){const n=h.width*.8-e.mapPosition.x,o=h.height*.5-e.mapPosition.y,s=new i(h.width*.1-e.mapPosition.x,h.height*.1-e.mapPosition.y);let a;const l=h.width*.05;t==null||t.clearRect(-e.mapPosition.x,-e.mapPosition.y,h.width,h.height),t.fillStyle="rgba(10,10,40,0.5)",t.fillRect(s.x,s.y,n,o),t.font="3rem ShadowOfTheDeadOver",t.fillStyle="#4caf50",t.fillText("Buy Menu: ",h.width*.1-e.mapPosition.x,h.height*.1-e.mapPosition.y),t.font="2rem Eater",t.fillStyle="#4caf50",t.fillText(`Gems Count: ${r.gemCount}`,h.width*.8-e.mapPosition.x,h.height*.1-e.mapPosition.y),t.fillStyle="rgba(200,200,200,0.8)",t.strokeStyle="green",a=0,st(t,a,s,n,o,l,g.pistol.image,B.positionRight[0],B.width,B.height,"Pistol",g.pistol.cost,g.pistol.damage,g.pistol.fireRate,g.pistol.cost),a=1,st(t,a,s,n,o,l,g.smg.image,V.positionRight[0],V.width,V.height,"SMG",g.smg.cost,g.smg.damage,g.smg.fireRate,g.smg.cost),a=2,st(t,a,s,n,o,l,g.vandal.image,q.positionRight[0],q.width,q.height,"vandal",g.vandal.cost,g.vandal.damage,g.vandal.fireRate,g.vandal.cost),a=3,st(t,a,s,n,o,l,g.hunter.image,N.positionRight[0],N.width,N.height,"hunter",g.hunter.cost,g.hunter.damage,g.vandal.fireRate,g.hunter.cost),pi(t),t.strokeStyle="gold",t.strokeRect(-e.mapPosition.x+h.width*(.2+.1*P+.025),-e.mapPosition.y+h.height*(.8+.03),h.width*.05,h.width*.05),G(t,new i(h.width*.1-e.mapPosition.x,h.height*.7-e.mapPosition.y),ei(),e.buyTime,h.width*.8,h.height*.01,"Buy Time:"),ei()>=e.buyTime&&(e.weaponArray.forEach((w,v)=>{w&&(w.position=r.weaponPositions[v])}),p.buyScreenFlag=!1,bt(t)),p.ingame||requestAnimationFrame(()=>{Si(t)})}function Ae(t){t.translate(-e.mapPosition.x,-e.mapPosition.y),e.mapPosition=new i(0,0),p.ingame=!1,p.buyScreenFlag=!0,fi=new Date,P=0;for(let n=0;n<e.weaponArray.length&&(P=n,!!e.weaponArray[n]);n++);Si(t)}let pt,ct;function Re(t,n){t=new i(-e.mapPosition.x+t.x,-e.mapPosition.y+t.y),ct&&R(t,pt,ct)&&(p.firstPageFlag=!1,U(n))}function Oe(t){t.clearRect(-e.mapPosition.x,-e.mapPosition.y,h.width,h.height),t.drawImage(E.backGroundImage,-e.mapPosition.x,-e.mapPosition.y,h.width,h.height);const n="DUNGEON DREAD";t.font="3rem ShadowOfTheDeadOver",t.fillStyle="white";const o=t.measureText(n);t.fillText(n,h.width*.5-o.width/2,h.height*.3+o.actualBoundingBoxAscent+o.actualBoundingBoxDescent);let s="red";window.addEventListener("mousemove",a=>{s=R(new i(a.offsetX,a.offsetY),pt,ct)?"blue":"red"}),window.addEventListener("keypress",()=>{p.firstPageFlag=!1,U(t)}),t.font="3rem Eater",pt=new i(h.width*.5-t.measureText("Press any button").width/2,-e.mapPosition.y+h.height*.8),ct=$(t,"Press any button",pt,"4rem bold Eater",s)}function vi(t){t.clearRect(0,0,h.width,h.height),Oe(t),p.homeScreenFlag&&requestAnimationFrame(()=>{vi(t)})}function Le(t){p.firstPageFlag=!0,e.homeSound&&(e.homeSound.pause(),e.homeSound.currentTime=0),vi(t)}function Me(){p.ismute=!p.ismute,p.ismute?(e.homeSound.pause(),e.homeSound.currentTime=0,e.windSound.pause(),e.windSound.currentTime=0,E.prevSoundHolder&&(E.prevSoundHolder.pause(),e.windSound.currentTime=0)):(p.homeScreenFlag&&e.homeSound.play(),p.ingame&&e.windSound.play())}function Fe(){p.btnPressed.a&&p.btnPressed.w||p.btnPressed.a&&p.btnPressed.s||p.btnPressed.d&&p.btnPressed.w||p.btnPressed.d&&p.btnPressed.s?(r.velocity.x=.7*u.velocity.x,r.velocity.y=.7*u.velocity.y):p.btnPressed.c&&(p.btnPressed.w||p.btnPressed.a||p.btnPressed.s||p.btnPressed.d)?r.run():(r.velocity.x=u.velocity.x,r.velocity.y=u.velocity.y),p.btnPressed.a&&(r.isMoving=!0,r.moveLeft(!0,L)),p.btnPressed.d&&(r.isMoving=!0,r.moveLeft(!1,L)),p.btnPressed.w&&(r.moveUp(!0,L),r.isMoving=!0),p.btnPressed.s&&(r.moveUp(!1,L),r.isMoving=!0),p.btnPressed[" "]&&r.ability()}function He(){window.addEventListener("keydown",t=>{p.btnPressed[t.key.toLowerCase()]=!0,p.buyScreenFlag&&p.btnPressed.u&&De(),t.key.toLowerCase()==="m"&&Me()}),window.addEventListener("keyup",t=>{p.btnPressed[t.key.toLowerCase()]=!1,r.isMoving=!1}),window.addEventListener("click",t=>{p.firstPageFlag&&Re(new i(t.offsetX,t.offsetY),L),p.homeScreenFlag&&ye(new i(t.offsetX,t.offsetY),L),p.buyScreenFlag&&Te(new i(t.offsetX,t.offsetY)),p.infoScreenFlag&&pe(new i(t.offsetX,t.offsetY),L),p.controlScreenFlag&&me(new i(t.offsetX,t.offsetY),L)})}function Ce(t){t.clearRect(-e.mapPosition.x,-e.mapPosition.y,h.width,h.height),t.fillStyle="rgba(40,40,240,1)",t.fillRect(-e.mapPosition.x,-e.mapPosition.y,h.width,h.height),t.fillStyle="rgba(40,40,40,0.1)",t.fillRect(-e.mapPosition.x,-e.mapPosition.y,h.width,h.height);const n="DUNGEON DREAD";t.font="3rem ShadowOfTheDeadOver",t.fillStyle="white";const o=t.measureText(n);t.fillText(n,-e.mapPosition.x+h.width*.01,-e.mapPosition.y+h.height*.01+o.actualBoundingBoxAscent+o.actualBoundingBoxDescent),G(t,new i(h.width*.3,h.height*.5),p.assetsLoaded,18,h.width*.4,10,"Loading... ","4rem Arial","white"),p.assetsLoaded>=18&&(p.loadingScreen=!1,Le(t))}function Pi(t){t.clearRect(0,0,h.width,h.height),Ce(t),p.loadingScreen&&requestAnimationFrame(()=>{Pi(t)})}function Be(t){p.loadingScreen=!0,p.ismute||(e.homeSound&&(e.homeSound.pause(),e.homeSound.currentTime=0),e.homeSound.play()),Pi(t)}const h=document.getElementById("canvas"),L=h.getContext("2d");He();h&&(h.width=window.innerWidth,h.height=window.innerHeight,h.style.background="linear-gradient(172.33deg, #30303A -1.75%, #20202E 83.53%, #050519 104.9%)",Be(L));
