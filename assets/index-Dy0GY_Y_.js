var gi=Object.defineProperty;var mi=(i,t,e)=>t in i?gi(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var p=(i,t,e)=>mi(i,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))h(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const g of l.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&h(g)}).observe(document,{childList:!0,subtree:!0});function e(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function h(a){if(a.ep)return;a.ep=!0;const l=e(a);fetch(a.href,l)}})();const j="/LF-SE-Minor-Project_Dungeon-Dread/assets/background-fPH3rH_v.webp";class n{constructor(t,e){p(this,"x");p(this,"y");this.x=t,this.y=e}distanceBetween(t){return Math.sqrt((this.x-t.x)**2+(this.y-t.y)**2)}angle(t){const e=this.x-t.x,h=this.y-t.y;return Math.atan(h/e)}add(t){return new n(this.x+t.x,this.y+t.y)}pointDifference(t){return new n(this.x-t.x,this.y-t.y)}}let ci=[];const B=50,fi=Math.floor(window.innerWidth*10/B),yi=Math.floor(window.innerHeight*10/B),ui="#radial-gradient(#a9c0a6,#000)",d={tileSize:B,mapWidth:fi,mapHeight:yi,mapColor:ui,mapTileArray:ci,displayPosition:new n(0,0),mapSizeMultiplier:5},s={collideableObjs:[],heroTotalHealth:120,waveIntervalTime:30*1e3,maxEnemies:500*d.mapSizeMultiplier,mapPosition:new n(0,0),dropdownInterval:null,weaponArray:[null,null,null,null,null,null]};function q(i,t,e){return i.fillStyle="white",i.font="3rem Eater",i.fillText(t,e.x,e.y),i.measureText(t)}const m={ingame:!1,btnPressed:{},wave:1,buyScreenFlag:!1},O={width:115,height:62,position:new n(27,18)},Pi="/LF-SE-Minor-Project_Dungeon-Dread/assets/bush-fjx7lCik.png",f={drum:{width:738,height:226,position:new n(590,2280)},stone:{width:1663,height:1487,position:new n(577,773)}},vi="/LF-SE-Minor-Project_Dungeon-Dread/assets/stoneandDrum-BzVPJaqp.svg",U=new Image;U.src=Pi;const L=new Image;L.src=vi;class E{constructor(t,e,h,a){p(this,"position");p(this,"tileType");p(this,"isObstacle");p(this,"tileSize");this.position=t,this.tileType=e,this.isObstacle=h,this.tileSize=a}draw(t){switch(this.tileType){case"bush":t.drawImage(U,O.position.x,O.position.y,O.width,O.height,this.position.x,this.position.y,this.tileSize,this.tileSize);break;case"empty":break;case"stone":t.drawImage(L,f.stone.position.x,f.stone.position.y,f.stone.width,f.stone.height,this.position.x,this.position.y,f.stone.width/30,f.stone.height/30);break;case"drum":t.drawImage(L,f.drum.position.x,f.drum.position.y,f.drum.width,f.drum.height,this.position.x,this.position.y,this.tileSize,this.tileSize);break}}}function k(i,t){const e=Math.ceil(i),h=Math.floor(t);return Math.floor(Math.random()*(h-e+1)+e)}class Si{constructor(t){p(this,"tileSize");p(this,"mapHeight");p(this,"mapWidth");this.tileSize=t,this.mapHeight=Math.floor(window.innerHeight*d.mapSizeMultiplier/t),this.mapWidth=Math.floor(window.innerWidth*d.mapSizeMultiplier/t),this.initialize(),this.collectCollideableobj()}collectCollideableobj(){d.mapTileArray.forEach(t=>{t.forEach(e=>{e.isObstacle&&s.collideableObjs.push(e)})})}initialize(){for(let t=0;t<this.mapHeight;t++){d.mapTileArray[t]=[];for(let e=0;e<this.mapWidth;e++)if(e===0||t===0||t===this.mapHeight-1||e===this.mapWidth-1)d.mapTileArray[t][e]=new E(new n(e*this.tileSize,t*this.tileSize),"bush",!0,this.tileSize);else{const h=k(1,100);h%2==0&&h<10?h>5?d.mapTileArray[t][e]=new E(new n(e*this.tileSize,t*this.tileSize),"drum",!0,this.tileSize):d.mapTileArray[t][e]=new E(new n(e*this.tileSize,t*this.tileSize),"stone",!0,this.tileSize):d.mapTileArray[t][e]=new E(new n(e*this.tileSize,t*this.tileSize),"empty",!1,this.tileSize)}}}draw(t){d.mapTileArray.forEach(e=>{e.forEach(h=>{h.draw(t)})})}}class Y{constructor(t,e,h,a,l,g){p(this,"position");p(this,"team");p(this,"lookingLeft");p(this,"healthpoint");p(this,"width");p(this,"height");p(this,"spritePosition",0);p(this,"velocity",new n(5,5));this.position=t,this.team=e,this.lookingLeft=h,this.healthpoint=a,this.width=l,this.height=g}}const Ii="/LF-SE-Minor-Project_Dungeon-Dread/assets/hero-CXBE-ivq.png",P={width:35,height:44,positionRight:[new n(6,6),new n(6,71),new n(6,124),new n(6,172),new n(6,124),new n(6,71)],positionLeft:[new n(64,6),new n(67,71),new n(64,124),new n(67,172),new n(64,124),new n(67,71)]},A=new Image;A.src=Ii;class bi extends Y{constructor(){super(...arguments);p(this,"isMoving",!1);p(this,"speedLimit",3);p(this,"weaponOffset",10);p(this,"weaponPositions",[new n(this.position.x+this.weaponOffset+this.width,this.position.y),new n(this.position.x-this.weaponOffset,this.position.y),new n(this.position.x+this.weaponOffset+this.width,this.position.y+this.height/2),new n(this.position.x-this.weaponOffset,this.position.y+this.height/2),new n(this.position.x+this.weaponOffset+this.width,this.position.y),new n(this.position.x+this.weaponOffset+this.width,this.position.y)])}ability(){console.log("using ability")}reheal(){setInterval(()=>{this.healthpoint<50&&(this.healthpoint+=3)},5e3)}checkCollision(){let e=!1,h=s.collideableObjs[0];return s.collideableObjs.forEach(a=>{a.position.y+a.tileSize>=this.position.y&&a.position.y<=this.position.y+this.height&&a.position.x+a.tileSize>=this.position.x&&a.position.x+a.tileSize<=this.position.x+a.tileSize+this.width&&(e=!0,h=a)}),{collided:e,collidedObj:h}}updateWeaponPosition(){this.weaponPositions=[new n(this.position.x+this.weaponOffset+this.width,this.position.y),new n(this.position.x-this.weaponOffset,this.position.y),new n(this.position.x+this.weaponOffset+this.width,this.position.y+this.height/2),new n(this.position.x-this.weaponOffset,this.position.y+this.height/2),new n(this.position.x+this.weaponOffset+this.width,this.position.y+this.height),new n(this.position.x-this.weaponOffset,this.position.y+this.height)]}moveLeft(e,h){const a=e?this.velocity.x:-1*this.velocity.x;this.lookingLeft=e;const l=this.checkCollision();if(!l.collided)s.mapPosition.x+=a,h.translate(a,0);else{const g=l.collidedObj.position.y<this.position.y?-1:1,c=l.collidedObj.position.x<this.position.x?-1:1;s.mapPosition.x+=c,s.mapPosition.y+=g,h.translate(c,g)}this.updateWeaponPosition()}moveUp(e,h){const a=e?this.velocity.y:-1*this.velocity.y,l=this.checkCollision();if(!l.collided)s.mapPosition.y+=a,h.translate(0,a);else{const g=l.collidedObj.position.y<this.position.y?-1:1,c=l.collidedObj.position.x<this.position.x?-1:1;s.mapPosition.x+=c,s.mapPosition.y+=g,h.translate(c,g)}this.updateWeaponPosition()}draw(e){this.position.x=o.width/2-s.mapPosition.x,this.position.y=o.height/2-s.mapPosition.y;const h=this.lookingLeft?P.positionLeft:P.positionRight;if(this.isMoving){let l=Math.floor(this.spritePosition/5)%6;e.drawImage(A,h[l].x,h[l].y,P.width,P.height,this.position.x,this.position.y,this.width,this.height),this.spritePosition++}else e.drawImage(A,h[0].x,h[0].y,P.width,P.height,this.position.x,this.position.y,this.width,this.height)}}const ki="/LF-SE-Minor-Project_Dungeon-Dread/assets/spwan-6_Ug9n4C.png",xi="/LF-SE-Minor-Project_Dungeon-Dread/assets/type1-CCCx1Bt1.png",T={width:31,height:17,position:[new n(76,17),new n(224,17),new n(410,17),new n(576,17),new n(742,17),new n(76,118),new n(224,118),new n(410,118),new n(576,118),new n(742,118),new n(48,217)]},M={width:24,height:34,positionLeft:[new n(10,3),new n(118,3),new n(226,3),new n(335,3),new n(443,3),new n(6,114),new n(443,3),new n(335,3),new n(226,3),new n(118,3)],positionRight:[new n(479,2),new n(587,2),new n(696,3),new n(804,5),new n(914,5),new n(482,112),new n(914,5),new n(804,5),new n(696,3),new n(587,2)]},J=new Image,K=new Image;J.src=ki;K.src=xi;class Oi extends Y{constructor(){super(...arguments);p(this,"isSpwaned",!1);p(this,"attackInterval",null)}checkCollision(){let e=!1,h=!1,a=s.collideableObjs[0];return s.collideableObjs.forEach(l=>{l.position.y+l.tileSize>=this.position.y&&l.position.y<=this.position.y+this.height&&l.position.x+l.tileSize>=this.position.x&&l.position.x+l.tileSize<=this.position.x+l.tileSize+this.width&&(e=!0,a=l)}),r.position.y+r.height/2>=this.position.y&&r.position.y<=this.position.y+this.height&&r.position.x+r.width>=this.position.x&&r.position.x+r.width<=this.position.x+r.width+this.width?(h=!0,a=r,this.attackInterval||(this.attackInterval=setInterval(()=>{r.healthpoint>0&&(r.healthpoint-=2)},1200))):(clearInterval(this.attackInterval),this.attackInterval=null),{collided:e,collidedObj:a,collidedHero:h}}update(){const e=this.checkCollision();this.lookingLeft=this.position.x>r.position.x;const h=Math.sqrt((this.position.x-r.position.x)**2+(this.position.y-r.position.y)**2);h>50&&(clearInterval(this.attackInterval),this.attackInterval=null);const a=new n((this.position.x-r.position.x)/h,(this.position.y-r.position.y)/h),l=Math.sqrt(2);if(this.velocity=new n(-a.x*l,-a.y*l),e.collidedHero&&(this.velocity.x=0,this.velocity.y=0),!e.collided)this.position.x+=this.velocity.x,this.position.y+=this.velocity.y;else{const g=e.collidedObj.position.x<this.position.x?1:-1,c=e.collidedObj.position.y<this.position.y?1:-1;this.position.x+=g,this.position.y+=c}}draw(e){const h=this.lookingLeft?M.positionLeft:M.positionRight;this.update();let l=Math.floor(this.spritePosition/5)%10;e.drawImage(K,h[l].x,h[l].y,M.width,M.height,this.position.x,this.position.y,this.width,this.height),this.spritePosition++}spwan(e){let a=Math.floor(this.spritePosition/10)%10;e.drawImage(J,T.position[a].x,T.position[a].y,T.width,T.height,this.position.x,this.position.y,this.width,this.height),this.spritePosition++,a>=9&&(this.isSpwaned=!0,this.spritePosition=0,this.velocity=new n(k(1,3),k(1,3)),this.healthpoint=10)}}const Ei="/LF-SE-Minor-Project_Dungeon-Dread/assets/map-BCq2fiXg.png";function z(i,t,e,h,a,l,g=""){i.font="2rem ShadowOfTheDead",i.fillStyle="#4caf50",i.fillText(g,t.x,t.y-l/5);const c=Math.floor(e/h*a);i.strokeRect(t.x,t.y,a,l),i.fillStyle="rgba(200,200,200,0.5)",i.fillRect(t.x,t.y,a,l),i.fillStyle="rgba(76, 175, 80,0.5)",i.fillRect(t.x,t.y,c,l)}function Q(i,t){i.font="5rem ShadowOfTheDeadOver",i.fillStyle="#4caf50",i.translate(-(i.measureText(t).width/2+s.mapPosition.x),o.height/2-s.mapPosition.y),i.fillText(t,o.width/2,0),i.translate(i.measureText(t).width/2+s.mapPosition.x,-(o.height/2-s.mapPosition.y))}class Ti{constructor(t,e,h,a,l,g=1,c=500,wi){p(this,"position");p(this,"lookingLeft");p(this,"damage");p(this,"width");p(this,"height");p(this,"spritePosition",0);p(this,"fireRate");p(this,"cost");p(this,"gunImage");this.position=t,this.lookingLeft=e,this.damage=h,this.width=a,this.height=l,this.gunImage=wi,this.fireRate=g,this.cost=c}}const Z="/LF-SE-Minor-Project_Dungeon-Dread/assets/pestol-2UG2JAP-.svg",y={width:66,height:38,positionRight:[new n(5,31),new n(67,40),new n(19,46)],positionLeft:[new n(90,31),new n(94,40),new n(143,46)]},b={bulletSize:2,bulletVelocity:20,pestol:200,pestolFireRate:1,pestolDamage:5};class Mi{constructor(t,e,h,a,l){p(this,"startPoint");p(this,"endPoint");p(this,"damage");p(this,"isHit",!1);p(this,"velocity");p(this,"gunPosition");this.startPoint=t,this.endPoint=e,this.damage=h,this.velocity=a,this.gunPosition=l}checkOnhit(t){t.forEach(e=>{this.endPoint.x>e.position.x&&this.endPoint.x<e.position.x+e.width&&this.endPoint.y>e.position.y&&this.endPoint.y<e.position.y+e.height&&(this.isHit=!0,e.healthpoint-=this.damage)})}draw(t){this.startPoint=this.startPoint.add(this.velocity),this.endPoint=this.endPoint.add(this.velocity),t.beginPath(),t.strokeStyle="gold",t.moveTo(this.startPoint.x,this.startPoint.y),t.lineTo(this.endPoint.x,this.endPoint.y),t.lineWidth=2,t.stroke()}}const Li=new Image;Li.src=Z;class D extends Ti{constructor(){super(...arguments);p(this,"detectedEnemy",!1);p(this,"trackingEnemyObj",null);p(this,"lookingAngle",0);p(this,"shootingPoint",y.positionRight[1]);p(this,"fireInterval",null)}detectEnemy(e){const h=this.position;h.distanceBetween(e.position)<b.pestol&&!this.detectedEnemy&&(this.detectedEnemy=!0,this.trackingEnemyObj=e),this.detectedEnemy&&this.trackingEnemyObj&&(this.lookingAngle=h.angle(new n(this.trackingEnemyObj.position.x,this.trackingEnemyObj.position.y)),this.shoot(),this.position.distanceBetween(this.trackingEnemyObj.position)>b.pestol&&(this.detectedEnemy=!1,clearInterval(this.fireInterval),this.fireInterval=null)),this.trackingEnemyObj&&this.trackingEnemyObj.healthpoint<0&&(this.detectedEnemy=!1,clearInterval(this.fireInterval),this.fireInterval=null)}shoot(){this.lookingLeft?this.shootingPoint=new n(this.position.x,this.position.y+this.height/4):this.shootingPoint=new n(this.position.x+this.width,this.position.y+this.height/4),this.trackingEnemyObj&&this.position.x>this.trackingEnemyObj.position.x&&(this.shootingPoint.x=this.position.x),this.shootingPoint.x=this.position.x+(this.shootingPoint.x-this.position.x)*Math.cos(this.lookingAngle)-(this.shootingPoint.y-this.position.y)*Math.sin(this.lookingAngle),this.shootingPoint.y=this.position.y+(this.shootingPoint.x-this.position.x)*Math.sin(this.lookingAngle)+(this.shootingPoint.y-this.position.y)*Math.cos(this.lookingAngle),this.fireInterval||(this.fireInterval=setInterval(()=>{if(this.trackingEnemyObj){const e=new n(this.trackingEnemyObj.position.x+this.width/2,this.trackingEnemyObj.position.y+this.height/2),h=this.shootingPoint.pointDifference(e),a=this.shootingPoint.distanceBetween(e),l=new n(h.x/a,h.y/a),g=new n(this.shootingPoint.x+l.x*10,this.shootingPoint.y+l.y*10),c=new Mi(this.shootingPoint,g,b.pestolDamage,new n(-l.x*b.bulletVelocity,-l.y*b.bulletVelocity),this.position);x.push(c)}},1e3/this.fireRate))}draw(e){e.translate(this.position.x,this.position.y),e.rotate(this.lookingAngle);let h;this.lookingLeft?(h=y.positionLeft[0],this.shootingPoint=new n(0,this.height/4)):(h=y.positionRight[0],this.shootingPoint=new n(this.width,this.height/4)),this.trackingEnemyObj&&this.position.x>this.trackingEnemyObj.position.x&&(h=h===y.positionLeft[0]?y.positionRight[0]:y.positionLeft[0],this.shootingPoint.x=0),e.fillStyle="red",e.drawImage(this.gunImage,h.x,h.y,y.width,y.height,0,0,this.width,this.height),e.rotate(-this.lookingAngle),e.translate(-this.position.x,-this.position.y)}}function Ai(i){i.strokeStyle="white",i.fillStyle="rgba(40,200,40,0.1)",i.fillRect(-s.mapPosition.x+o.width*.2,-s.mapPosition.y+o.height*.8,o.width*.6,o.width*.08),i.strokeRect(-s.mapPosition.x+o.width*.2,-s.mapPosition.y+o.height*.8,o.width*.6,o.width*.08),i.fillStyle="rgba(200,200,200,0.8)";for(let e=0;e<6;e++)i.fillRect(-s.mapPosition.x+o.width*(.2+.1*e+.025),-s.mapPosition.y+o.height*(.8+.03),o.width*.05,o.width*.05),s.weaponArray[e]&&i.drawImage(s.weaponArray[e].gunImage,-s.mapPosition.x+o.width*(.2+.1*e+.025),-s.mapPosition.y+o.height*(.8+.03),o.width*.05,o.width*.05)}const S={heroTotalHealth:120,width:P.width*window.innerHeight/600,height:P.height*window.innerHeight/600},_={width:66,height:38,positionLeft:[new n(5,31),new n(67,40),new n(19,46)],positionRight:[new n(90,31),new n(94,40),new n(143,46)]},zi="/LF-SE-Minor-Project_Dungeon-Dread/assets/smg-9gzp5Pqq.svg",ii=new Image;ii.src=Z;const ti=new Image;ti.src=zi;const w={pistol:{damage:5,width:y.width*S.width*.01,height:y.height*S.width*.01,image:ii,fireRate:1,cost:500},smg:{damage:.5,width:_.width*S.width*.01,height:_.height*S.width*.01,image:ti,fireRate:10,cost:5e3}};let ei;const $=5*1e3;let v=0;function G(){return new Date().getTime()-ei.getTime()}function N(i,t,e){const h=e.x,a=e.y;return i=new n(i.x-s.mapPosition.x,i.y-s.mapPosition.y),i.x>t.x&&i.x<t.x+h&&i.y>t.y&&i.y<t.y+a}let Di=i=>{for(let t=0;t<6;t++)if(N(i,new n(-s.mapPosition.x+o.width*(.2+.1*t+.025),-s.mapPosition.y+o.height*.8300000000000001),new n(o.width*.05,o.width*.05))){v=t;break}for(let t=0;t<3;t++)if(N(i,new n(-s.mapPosition.x+o.width*(.2+.1*t+.025),-s.mapPosition.y+o.height*.13),new n(o.width*.05,o.width*.05))){switch(t){case 0:s.weaponArray[v]=new D(r.weaponPositions[v],!1,w.pistol.damage,w.pistol.width,w.pistol.height,w.pistol.fireRate,w.pistol.cost,w.pistol.image);break;case 1:s.weaponArray[v]=new D(r.weaponPositions[v],!1,w.smg.damage,w.smg.width,w.smg.height,w.smg.fireRate,w.smg.cost,w.smg.image);break}break}};function oi(i){i==null||i.clearRect(-s.mapPosition.x,-s.mapPosition.y,o.width,o.height),i.fillStyle="rgba(10,10,40,0.5)",i.fillRect(o.width*.1-s.mapPosition.x,o.height*.1-s.mapPosition.y,o.width*.8,o.height*.5),i.font="3rem ShadowOfTheDeadOver",i.fillStyle="#4caf50",i.fillText("Buy Menu: ",o.width*.1-s.mapPosition.x,o.height*.1-s.mapPosition.y),i.fillStyle="rgba(200,200,200,0.8)";for(let t=0;t<3;t++)i.fillRect(-s.mapPosition.x+o.width*(.2+.1*t+.025),-s.mapPosition.y+o.height*(.1+.03),o.width*.05,o.width*.05);i.drawImage(w.pistol.image,-s.mapPosition.x+o.width*(.2+.025),-s.mapPosition.y+o.height*(.1+.03),o.width*.05,o.width*.05),i.drawImage(w.smg.image,-s.mapPosition.x+o.width*(.3+.025),-s.mapPosition.y+o.height*(.1+.03),o.width*.05,o.width*.05),z(i,new n(o.width*.1-s.mapPosition.x,o.height*.7-s.mapPosition.y),G(),$,o.width*.8,o.height*.01,"Buy Time:"),Ai(i),G()>=$&&(s.weaponArray.forEach((t,e)=>{t&&(t.position=r.weaponPositions[e])}),m.buyScreenFlag=!1,ai(i)),i.strokeStyle="gold",i.strokeRect(-s.mapPosition.x+o.width*(.2+.1*v+.025),-s.mapPosition.y+o.height*(.8+.03),o.width*.05,o.width*.05),m.ingame||requestAnimationFrame(()=>{oi(i)})}function Ri(i){m.ingame=!1,m.buyScreenFlag=!0,ei=new Date,v=0,oi(i)}function Ci(){m.btnPressed.a&&(r.isMoving=!0,r.moveLeft(!0,I)),m.btnPressed.d&&(r.isMoving=!0,r.moveLeft(!1,I)),m.btnPressed.w&&(r.moveUp(!0,I),r.isMoving=!0),m.btnPressed.s&&(r.moveUp(!1,I),r.isMoving=!0),m.btnPressed[" "]&&r.ability(),m.btnPressed[`
`]&&console.log("enter")}function Fi(){window.addEventListener("keydown",i=>{m.btnPressed[i.key.toLowerCase()]=!0}),window.addEventListener("keyup",i=>{m.btnPressed[i.key.toLowerCase()]=!1,r.isMoving=!1}),window.addEventListener("click",i=>{ji(new n(i.offsetX,i.offsetY),I),m.buyScreenFlag&&Di(new n(i.offsetX,i.offsetY))})}const ni=new Image;ni.src=Ei;let si,u=[],x=[],r,R;function V(){return new Date().getTime()-si.getTime()}const Hi=new Si(d.tileSize);function Wi(){r=new bi(new n(window.innerWidth/2,window.innerHeight/2),"blue",!0,s.heroTotalHealth,S.width,S.height),r.reheal()}function Bi(){u=u.filter(i=>{if(i.healthpoint<0)clearInterval(i.attackInterval);else return!0})}function qi(){x=x.filter(i=>(i.checkOnhit(u),!(i.endPoint.x>=window.innerHeight*d.mapSizeMultiplier||i.startPoint.x<=0||i.isHit)))}function _i(){R=setInterval(()=>{if(u.length<s.maxEnemies){const i=new Oi(new n(k(d.tileSize+d.displayPosition.x,window.innerWidth*5-d.tileSize),k(d.tileSize+d.displayPosition.y,window.innerHeight*5-d.tileSize*2)),"red",!0,100,24*o.height/700,34*o.height/700);u.push(i)}},500)}function $i(i){i.strokeStyle="white",i.fillStyle="rgba(40,200,40,0.1)",i.fillRect(-s.mapPosition.x+o.width*.2,-s.mapPosition.y+o.height*.8,o.width*.6,o.width*.08),i.strokeRect(-s.mapPosition.x+o.width*.2,-s.mapPosition.y+o.height*.8,o.width*.6,o.width*.08),i.fillStyle="rgba(200,200,200,0.8)";for(let e=0;e<6;e++)i.fillRect(-s.mapPosition.x+o.width*(.2+.1*e+.025),-s.mapPosition.y+o.height*(.8+.03),o.width*.05,o.width*.05),s.weaponArray[e]&&i.drawImage(s.weaponArray[e].gunImage,-s.mapPosition.x+o.width*(.2+.1*e+.025),-s.mapPosition.y+o.height*(.8+.03),o.width*.05,o.width*.05)}function Gi(i){i.drawImage(ni,d.displayPosition.x,d.displayPosition.y,window.innerWidth*d.mapSizeMultiplier,window.innerHeight*d.mapSizeMultiplier),Hi.draw(i),r.draw(i),u.forEach(e=>{e.isSpwaned?e.draw(i):e.spwan(i)}),s.dropdownInterval&&Q(i,`wave : ${m.wave}`);const t=i.createRadialGradient(r.position.x+r.width/2,r.position.y+r.height/2,r.width,r.position.x+r.width/2,r.position.y+r.height/2,1e3);r.healthpoint>30?(t.addColorStop(0,"rgba(10,10,10,0)"),t.addColorStop(1,"rgba(0,0,0,0.99)")):(t.addColorStop(0,"rgba(10,10,10,0)"),t.addColorStop(1,"rgba(200,0,0,0.99)")),i.fillStyle=t,i.fillRect(-s.mapPosition.x,-s.mapPosition.y,o.width,o.height),z(i,new n(o.width*.05-s.mapPosition.x,o.height*.05-s.mapPosition.y),r.healthpoint,s.heroTotalHealth,o.width*.4,o.height*.03,"Life line"),z(i,new n(o.width*.95-o.width*.4-s.mapPosition.x,o.height*.05-s.mapPosition.y),s.waveIntervalTime-V(),s.waveIntervalTime,o.width*.4,o.height*.03,"Time remaining"),V()>=s.waveIntervalTime&&(m.wave++,Ri(i)),x.forEach(e=>{e.draw(i)}),s.weaponArray.forEach((e,h)=>{e&&(e.draw(i),e.position=r.weaponPositions[h])}),$i(i)}function hi(i){i==null||i.clearRect(-s.mapPosition.x,-s.mapPosition.y,o.width,o.height),Ci(),Gi(i),Bi(),qi(),u.forEach(t=>{s.weaponArray.forEach(e=>{e&&e.detectEnemy(t)})}),m.ingame&&requestAnimationFrame(()=>{hi(i)})}function Ni(){u.forEach(i=>{clearInterval(i.attackInterval)}),r.healthpoint=s.heroTotalHealth,x=[],u=[],clearInterval(R),R=null,si=new Date,s.weaponArray[0]||(s.weaponArray[0]=new D(r.weaponPositions[0],!1,w.pistol.damage,w.pistol.width,w.pistol.height,w.pistol.fireRate,w.pistol.cost,w.pistol.image)),s.weaponArray.forEach(i=>{i&&clearInterval(i.fireInterval)})}function ai(i){m.ingame=!0,Wi(),Ni(),_i(),s.dropdownInterval=!0,setTimeout(()=>{s.dropdownInterval=!1},5e3),s.dropdownInterval&&Q(i,`wave : ${m.wave}`),hi(i)}const li=new Image;li.src=j;function Vi(i){i.drawImage(li,0,0,o.width,o.height),i.fillRect(o.width*.1,o.height*.1,o.width*.8,o.height*.8)}function ri(i){i.clearRect(0,0,o.width,o.height),Vi(i),requestAnimationFrame(()=>{ri(i)})}function Xi(i){i.translate(-s.mapPosition.x,-s.mapPosition.y),ri(i)}const pi=new Image;pi.src=j;let C,F,H,W;function X(i,t,e){const h=e.width,a=e.actualBoundingBoxAscent+e.actualBoundingBoxDescent;return i.x>t.x&&i.x<t.x+h&&i.y>t.y-a&&i.y<t.y}function ji(i,t){F&&X(i,C,F)&&ai(t),W&&X(i,H,W)&&Xi(t)}function Ui(i){i.drawImage(pi,0,0,o.width,o.height),C=new n(o.width*.01,o.height*.2),H=new n(o.width*.01,o.height*.3),F=q(i,"Start Game",C),W=q(i,"About",H)}function di(i){i.clearRect(0,0,o.width,o.height),Ui(i),requestAnimationFrame(()=>{di(i)})}function Yi(i){i.translate(-s.mapPosition.x,-s.mapPosition.y),di(i)}const o=document.getElementById("canvas"),I=o.getContext("2d");Fi();o&&(o.width=window.innerWidth,o.height=window.innerHeight,o.style.background="linear-gradient(172.33deg, #30303A -1.75%, #20202E 83.53%, #050519 104.9%)",Yi(I));
